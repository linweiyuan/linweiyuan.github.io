<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ—ä¼Ÿæºçš„æŠ€æœ¯åšå®¢</title>
  
  
  <link href="https://linweiyuan.github.io/atom.xml" rel="self"/>
  
  <link href="https://linweiyuan.github.io/"/>
  <updated>2022-10-04T11:01:19.593Z</updated>
  <id>https://linweiyuan.github.io/</id>
  
  <author>
    <name>æ—ä¼Ÿæº</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>IntelliJ IDEA Conf 2022</title>
    <link href="https://linweiyuan.github.io/2022/10/01/IntelliJ-IDEA-Conf-2022.html"/>
    <id>https://linweiyuan.github.io/2022/10/01/IntelliJ-IDEA-Conf-2022.html</id>
    <published>2022-10-01T05:09:00.000Z</published>
    <updated>2022-10-04T11:01:19.593Z</updated>
    
    <content type="html"><![CDATA[<p>çœ‹å®Œäº†çš„ <code>IntelliJ IDEA Conf 2022 (day 1)</code> å’Œ <code>IntelliJ IDEA Conf 2022 (day 2)</code><br>å†™ä¸€ä¸‹å°è±¡æ¯”è¾ƒæ·±çš„å’Œè§‚åæ„Ÿ</p><h1 id="day1"><a href="#day1" class="headerlink" title="day1"></a>day1</h1><h2 id="Surviving-Open-Source-by-Donald-Raab"><a href="#Surviving-Open-Source-by-Donald-Raab" class="headerlink" title="Surviving Open Source, by Donald Raab"></a>Surviving Open Source, by Donald Raab</h2><p>ä»‹ç»äº†è¿™ä½è€å“¥å‚ä¸å¼€æºé¡¹ç›®çš„å¿ƒè·¯å†ç¨‹</p><h2 id="Letâ€™s-Set-Sail-With-Fleet-by-Vitaly-Bragilevsky"><a href="#Letâ€™s-Set-Sail-With-Fleet-by-Vitaly-Bragilevsky" class="headerlink" title="Letâ€™s Set Sail With Fleet!, by Vitaly Bragilevsky"></a>Letâ€™s Set Sail With Fleet!, by Vitaly Bragilevsky</h2><p>ï¼ˆç”¨äº†è‹±æ–‡å•å¼•å·ï¼Œä½†æ˜¯ä¼šè‡ªåŠ¨å˜æˆäº†ä¸­æ–‡çš„ï¼Œå¯èƒ½å’Œé…ç½®æœ‰å…³ï¼‰</p><p>è¿™ä½è€å“¥éå¸¸é£è¶£å¹½é»˜</p><p>åœ¨æ¼”ç¤ºåˆ†å¸ƒå¼è®¡ç®—å™¨åº”ç”¨çš„åŠ æ³•åŠŸèƒ½æ—¶ï¼Œ<code>2 + 3 = -1</code>ï¼Œ<code>5 + 6 = -1</code>ï¼Œè¯„è®ºåŒºç‚¸äº†é”…ï¼Œçº·çº·æå‡ºè‡ªå·±çš„è§£å†³æ–¹æ¡ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â€‹Add is disabled</span><br><span class="line">...</span><br><span class="line">â€‹addition uses subtract microservice</span><br><span class="line">...</span><br><span class="line">â€‹you&#x27;re subtracting</span><br><span class="line">...</span><br><span class="line">â€‹Looks like &#x27;+&#x27; is mapped to &#x27;-&#x27; button</span><br><span class="line">...</span><br><span class="line">â€‹you have minus in your java implementation</span><br></pre></td></tr></table></figure><p>ä½†å…¶å®æ˜¯æ•…æ„è£…ä½œç¿»è½¦çš„æ ·å­ï¼ŒèŠ‚ç›®æ•ˆæœç½¢äº†ï¼Œå®åˆ™æ˜¯ä¸ºäº†å±•ç¤º Fleet çš„è¿œç¨‹ååŠ©åŠŸèƒ½ï¼ˆç±»ä¼¼ IDEA çš„ Code With Meï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">give them both an Oscar already</span><br></pre></td></tr></table></figure><p>æœ€å QA ç¯èŠ‚ï¼Œå½“é—®åˆ° Fleet æ˜¯ä¸æ˜¯ä¸ºäº†æ›¿æ¢ IDEA è€Œå¼„å‡ºæ¥çš„æ—¶å€™ï¼Œä¸»æŒäººæŒ‘äº†æŒ‘çœ‰ï¼Œç„¶åè€å“¥åäº†ä¸‹å£æ°´ï¼Œä¹Ÿæ¯”è¾ƒæç¬‘ï¼Œæ„Ÿè§‰æœ‰ç‚¹åƒé€å‘½é¢˜</p><p>ä»¥ä¸‹æ˜¯ä»–çš„åŸè¯ï¼ˆè‡ªåŠ¨ç”Ÿæˆçš„å­—å¹•æœ‰éƒ¨åˆ†é”™è¯¯ï¼Œè¿™é‡Œåšäº†è°ƒæ•´å’Œåˆ äº†éƒ¨åˆ† uh è¯­æ°”è¯ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">I think Fleet is not designed to replace IntelliJ IDEA.</span><br><span class="line"></span><br><span class="line">So what I&#x27;ve showed you here is an IDE for working with polyglot projects with stuff like that, but I don&#x27;t think that when you have a project in Java or in Kotlin or in one language that Fleet will be enough for your experience.</span><br><span class="line"></span><br><span class="line">So I believe from my point of view, it&#x27;s not official statement from JetBrains by the way by no means.</span><br><span class="line"></span><br><span class="line">So what I feel, for me like when I have this dedicated project in one language, it&#x27;s great to use IDEA or maybe CLI with all that stuff and that very powerful IDE, but if you want to do something quickly, to edit something, to check something, then Fleet is great.</span><br><span class="line"></span><br><span class="line">So it&#x27;s not a replacement as I see, it&#x27;s a very nice addition.</span><br><span class="line"></span><br><span class="line">So that&#x27;s what I think.</span><br></pre></td></tr></table></figure><p>æ€»çš„æ¥è¯´ï¼ŒFleet ä¸æ˜¯ä¸ºäº†æ›¿æ¢ IDEA è€Œå¼„å‡ºæ¥çš„ï¼ˆæ±‚ç”Ÿæ¬²æ‹‰æ»¡ï¼‰ï¼Œåªæ˜¯ä½œä¸ºä¸€ä¸ªè¡¥å……ï¼Œæˆ–è€…è¾…åŠ©å·¥å…·</p><p>ä½†æ˜¯æ”¯æŒå¤šè¯­ç§ï¼Œè½»é‡çº§çš„ç‰¹æ€§ï¼Œæ˜çœ¼äººéƒ½çœ‹å‡ºæ¥æ˜¯å¯¹æ ‡ VSCodeã€‚ã€‚ã€‚</p><h2 id="Should-I-Upgrade-to-Java-17-by-Nikhil-Nanivadekar"><a href="#Should-I-Upgrade-to-Java-17-by-Nikhil-Nanivadekar" class="headerlink" title="Should I Upgrade to Java 17?, by Nikhil Nanivadekar"></a>Should I Upgrade to Java 17?, by Nikhil Nanivadekar</h2><p>ä¸»è¦æ˜¯åšäº†ä¸€äº› Benchmarkï¼ŒJDK 8ï¼ŒJDK 11ï¼ŒJDK 17ï¼ŒJDK 17 çš„æ•°æ®æ€»ä½“æ¥è¯´æ¯”ä½ç‰ˆæœ¬çš„å¥½çœ‹ï¼Œæ€§èƒ½æ›´å¼ºï¼Œå†…å­˜å ç”¨æ›´ä½</p><p>ç„¶åä»‹ç»äº† JDK8 ä»¥åçš„æ–°ç‰¹æ€§</p><p>æ¯”å¦‚ var ç±»å‹æ¨æ–­ï¼Œswitch æ”¯æŒæšä¸¾å’Œè¡¨è¾¾å¼ï¼Œç©ºæŒ‡é’ˆå¼‚å¸¸æ‰“å°ï¼ˆä¸€ä¸ªå¯¹è±¡æ¯”å¦‚ <code>a.b().c().d()</code> æŠ¥ NPEï¼Œä¹‹å‰å¾ˆéš¾çœ‹å‡ºæ˜¯ a è¿˜æ˜¯ b() è¿˜æ˜¯ c() è¿”å› nullï¼Œè¿™é‡Œä¼šç›´æ¥æ‰“å°å‡ºæ¥å‡ºç° null çš„åœ°æ–¹ï¼Œæ–¹ä¾¿ debugï¼‰ï¼Œæ–‡æœ¬å—ï¼ŒInstanceof å¢å¼ºï¼ŒRecordï¼Œå¯†å°ç±»</p><p>ä½†æˆ‘æ„Ÿè§‰ä»–çš„ PPT é‡Œæåˆ°çš„ JDK ç‰ˆæœ¬æ˜¯é”™çš„ã€‚ã€‚ã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒJDK 17 å·²ç» GA ä¸€å¹´å¤šäº†ï¼ŒJDK19 ä¹Ÿ GA äº†ï¼Œæ˜å¹´ JDK 21 LTS ä¹Ÿä¼š GAï¼Œè¿˜æ²¡å‡çº§çš„èµ¶å¿«å‡çº§</p><p>è¯æ˜¯è¿™ä¹ˆè¯´ï¼Œé™ˆå¹´è€ç è°å‡è°çŸ¥é“ï¼Œåªè¦ Spring Boot ä¸å‡ºä¸ª log4j çº§åˆ«çš„æ¼æ´ï¼Œé‚£å¤§ç¯å¢ƒä¸‹ JDK 8 è¿˜ä¼šå­˜åœ¨å¾ˆä¹…ï¼Œè¿™ä¸ªæ˜¯æˆ‘æ„Ÿè§‰çš„ï¼Œå¦‚æœæœ‰ä¸åŒçš„æƒ³æ³•æˆ–æ„è§ï¼Œä»¥ä½ çš„ä¸ºå‡†</p><p>æ–°é¡¹ç›®æ˜¯å¯ä»¥ç”¨çš„ï¼Œå¦‚æœæ²¡ç”¨ JDK 11ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¸Š JDK 17</p><p>Spring 6ï¼ŒSpring Boot 3ï¼Œä¹Ÿè¦ JDK 17 èµ·æ­¥</p><p>è¯´å¥é¢˜å¤–è¯ï¼Œå¦‚æœä½ ç”¨è¿‡ Kotlinï¼Œä¼šå‘ç°è¿™äº›æ‰€è°“æ–°ç‰¹æ€§ï¼Œåœ¨ Kotlin åˆšå‡ºé“çš„æ—¶å€™ï¼ŒåŸºæœ¬ä¸Šæ˜¯è‡ªå¸¦çš„ï¼ŒJava ç°åœ¨å·²ç»æ…¢æ…¢å˜æˆ Kotlin çš„æ¨¡æ · ğŸ¶</p><p>æ­¤å¤–ï¼Œç”¨æ¥å¯¹æ ‡ Go åç¨‹çš„ Java è™šæ‹Ÿçº¿ç¨‹ï¼Œå…¶å®äººå®¶ Kotlin ä¹Ÿæ—©å°±æœ‰åç¨‹å’Œ Channel çš„å®ç°äº†ï¼Œåœ¨ Dockerã€äº‘åŸç”Ÿç­‰çš„ buff åŠ æŒä¸‹ï¼ŒJava é€æ¸å¤±å»äº†è·¨å¹³å°çš„ä¼˜åŠ¿ï¼Œæ‰€ä»¥æäº†ä¸ª Spring Native</p><p>æ„Ÿè§‰ä½œä¸º 20 å¤šå¹´çš„è€å¤§å“¥ï¼ŒJava èµ·äº†ä¸ªå¤§æ—©ï¼Œèµ¶äº†ä¸ªæ™šé›†ï¼Œåœ¨é¢å¯¹åè¾ˆå¼‚å†›çªèµ·çš„æ—¶å€™ï¼Œå±æœºæ„Ÿä¹ŸæŒºå¼ºçš„ï¼Œè¿˜æ˜¯ä¸ªäººè§‚ç‚¹ï¼Œæœ‰ä¸åŒçš„ä»¥ä½ çš„ä¸ºå‡†</p><h2 id="Event-Streaming-and-Processing-Using-Apache-Pulsar-by-Mary-Grygleski"><a href="#Event-Streaming-and-Processing-Using-Apache-Pulsar-by-Mary-Grygleski" class="headerlink" title="Event Streaming and Processing Using Apache Pulsar, by Mary Grygleski"></a>Event Streaming and Processing Using Apache Pulsar, by Mary Grygleski</h2><p>æ²¡æ€ä¹ˆäº†è§£è¿‡è¿™ä¸ªäº§å“ï¼Œæ²¡æœ‰å¯¹åº”çš„çŸ¥è¯†å‚¨å¤‡ï¼Œè®²å¾—å¾ˆæ¸…æ¥šï¼Œå¬èµ·æ¥ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œåé¢ç”¨åˆ°äº†å†å›å¤´é‡çœ‹ä¸€é</p><p>å£éŸ³éå¸¸ç†Ÿæ‚‰å’Œäº²åˆ‡ï¼Œä¸å¼€å­—å¹•å¯ä»¥ç»ƒä¸‹å¬åŠ›</p><h2 id="Kubernetes-Native-Java-by-Josh-Long"><a href="#Kubernetes-Native-Java-by-Josh-Long" class="headerlink" title="Kubernetes Native Java, by Josh Long"></a>Kubernetes Native Java, by Josh Long</h2><p>è¯­é€Ÿä¸€å¦‚æ—¢å¾€åœ°å¿«ï¼Œä¸å¼€å­—å¹•å¥½å¤šæ—¶å€™éƒ½è·Ÿä¸ä¸Š</p><p>ä¸ºä»€ä¹ˆè¦å‡çº§ JDK 17ï¼Œä»–æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„æ¯”å–»ï¼ˆä¿®å¤ bug å’Œå»æ‰ä¸€äº›è¯­æ°”è¯ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">You know, for Spring Framework 6 as we mentioned, you can&#x27;t use Java 8 and Java 11 now, this is for good reason, they are terrible versions to use in production today, there is no situation which using Java 8 or 11, even ironically, is appropriate.</span><br><span class="line"></span><br><span class="line">Java 17 is technically superior to Java 8 in every conceivable way, it&#x27;s faster, more memory efficient, more observable, more secure, more robust, more syntax switch, more performant, more operations, friendly etc.</span><br><span class="line"></span><br><span class="line">It&#x27;s just a better piece of software in every conceivable way.</span><br><span class="line"></span><br><span class="line">It&#x27;s also morally superior to Java 8 in every conceivable way.</span><br><span class="line"></span><br><span class="line">You won&#x27;t like the look of despair and chagrin in your children&#x27;s faces when they find out that you&#x27;re using Java 8 in production.</span><br><span class="line"></span><br><span class="line">Don&#x27;t do it, be the change you want to see in the world, do the right thing.</span><br><span class="line"></span><br><span class="line">Java 17 is the right thing to do in 2022.</span><br><span class="line"></span><br><span class="line">My friends, I don&#x27;t think I need to go on about why Java 17 is an appropriate choice, or Java 17 or later is an appropriate choice, but just, if nothing else, just judging by the version number alone, I think it&#x27;s fair to say that Java 17 is more than twice as good as Java 8.</span><br></pre></td></tr></table></figure><p>é‡ç‚¹åœ¨æœ€åä¸€å¥è¯ï¼Œå¥½åƒæ²¡æ¯›ç—…</p><p>æ¥ç€è®²äº†è‡ªå®šä¹‰ banner çš„æ”¹åŠ¨ï¼ŒSpring Boot 3 ä¸æ”¯æŒå›¾ç‰‡æ ¼å¼çš„è‡ªåŠ¨è½¬æ¢äº†ï¼Œä½†æ˜¯çº¯æ–‡å­—ä¸å½±å“ï¼Œä¸»è¦æ˜¯ç”¨çš„äººå°‘ï¼Œä¹Ÿå‡ºäºæ€§èƒ½è€ƒè™‘</p><p>åé¢ä¸»è¦æ˜¯ Spring Native ç›¸å…³ï¼Œå¦‚ä½•é€šè¿‡è‡ªå®šä¹‰ actuator æ¥å£è®© K8s çš„ Liveness å’Œ Readiness æ„ŸçŸ¥ï¼Œä»è€Œä½¿åº”ç”¨ä¿æŒå¥åº·çŠ¶æ€</p><p>Spring Native æˆ‘ä¹Ÿå°è¯•è¿‡ï¼Œbuild çš„æ—¶å€™ CPU å’Œå†…å­˜å…¨éƒ¨è·‘æ»¡ï¼ŒèŠ±è´¹ä¸€åˆ†å¤šé’Ÿæ‰“åŒ… Docker é•œåƒï¼Œä»…ä»…æ˜¯ä¸€ä¸ª Hello Worldï¼Œä½†æ˜¯å¯åŠ¨ç¡®å®å¾ˆå¿«ï¼Œå†…å­˜å ç”¨ä¹Ÿå¾ˆä½ï¼ˆå’Œ Spring Boot Jar ç›¸æ¯”ï¼‰ï¼Œä½†æ˜¯è¦åœ¨äº‘åŸç”Ÿè¿™å—æ‰“å¾—è¿‡ Goï¼Œè¿˜è¦å†ä¸‹ç‚¹åŠŸå¤«ï¼ŒGo WEB åº”ç”¨çš„å†…å­˜å ç”¨ + é™æ€ç¼–è¯‘ + Docker æ‰“åŒ…ä¸€å¥—ç»„åˆæ‹³ç¡®å®å¾ˆèˆ’æœï¼Œæœ‰ä¸åŒæ„è§ä»¥ä½ çš„ä¸ºå‡†</p><p>æœ€åä»‹ç»äº†ä¸‹ Graphqlï¼Œè¿™ä¸ªå¾ˆæ—©å°±å¬è¿‡ä½†å…¶å®æ²¡å®é™…ç”¨è¿‡ï¼Œå¿ƒè¡€æ¥æ½®æ—¶å†æ¥ç ”ç©¶ä¸€ç•ªï¼Œåªæ˜¯ç¬¬ä¸€æ„Ÿè§‰å°±æ˜¯æ•°æ®çš„æƒé™ç²’åº¦é—®é¢˜ï¼Œåˆ«çš„ç”¨æˆ·ä¼šä¸ä¼šè®¿é—®åˆ°ä¸åº”è¯¥çœ‹åˆ°çš„æ•°æ®ï¼Œåé¢ç”¨åˆ°å†è¯¦ç»†å­¦ä¹ </p><hr><h1 id="day-2"><a href="#day-2" class="headerlink" title="day 2"></a>day 2</h1><h2 id="Idiomatic-Kotlin-by-Anton-Arhipov"><a href="#Idiomatic-Kotlin-by-Anton-Arhipov" class="headerlink" title="Idiomatic Kotlin, by Anton Arhipov"></a>Idiomatic Kotlin, by Anton Arhipov</h2><p>ä¸»è¦æ˜¯ä»‹ç»äº†ä¸€äº›å¸¸è§çš„ç”¨é”™çš„ Kotlin å†™æ³•ï¼Œä¹Ÿä¸èƒ½è¯´é”™ï¼Œåªæ˜¯è¦æ€æ ·å†™æ‰ä¼šæ›´åœ°é“æ˜¾å¾—ä¸“ä¸šï¼Œå¥½æ¯”è‹±è¯­æ¯è¯­è€…è¯´ä¸œè¥¿å–œæ¬¢ä¸­é—´åŠ ä¸ª you knowï¼Œéæ¯è¯­è€…ä¸€èˆ¬ä¸ä¼šè¿™æ ·è¯´ï¼Œä½†æ˜¯å¯èƒ½åœ¨å£è¯­ä¸­åŠ ä¸Šå°±ä¼šæ˜¾å¾—åœ°é“</p><p>ä½œä¸ºæœ‰è¿‡å¤šé—¨ç¼–ç¨‹ç»éªŒçš„å¼€å‘è€…ï¼Œæœ‰æ—¶ç¡®å®ä¼šå…ˆå…¥ä¸ºä¸»ï¼ŒæŠŠä¹‹å‰ç”¨è¿‡çš„è¯­è¨€çš„å†™æ³•ç”¨åˆ°æ–°å­¦è¯­è¨€ä¸Šï¼Œèƒ½è·‘ï¼Œä½†æ˜¯å°±æ˜¯æ˜¾å¾—ä¸ä¸“ä¸š</p><p>å¥½å¤šç¼–ç¨‹è¯­è¨€è¦è§£å†³çš„é—®é¢˜ä¸€æ ·ï¼Œåªæ˜¯å®ç°çš„è¿‡ç¨‹ä¸åŒï¼Œæˆ–è€…æœ‰è‡ªå·±çš„ä¸“æœ‰åè¯ï¼Œæ¯”å¦‚åš WEB å¼€å‘ï¼ŒSpring é‡Œçš„ AOPï¼Œåœ¨ Python é‡Œé¢å«è£…é¥°å™¨ï¼Œåœ¨ Go é‡Œå«ä¸­é—´ä»¶ï¼Œä¸èƒ½è¯´å®Œå…¨ä¸€è‡´ï¼Œåªèƒ½è¯´å¤§éƒ¨åˆ†è¦å®ç°çš„åŠŸèƒ½éƒ½æ˜¯ç›¸åŒçš„</p><p>åš Go å¼€å‘çš„æ—¶å€™ï¼Œå¾ˆå®¹æ˜“å°† Java çš„é¢å‘å¯¹è±¡çš„æ€ç»´å»åšï¼Œé‡åˆ°é—®é¢˜ï¼Œä»€ä¹ˆéƒ½ä¸è¯´å…ˆåˆ›å»ºä¸€ä¸ªç±»ï¼Œä½†æ˜¯ Go ä¸æ˜¯å®Œå…¨é¢å‘å¯¹è±¡ï¼Œè™½ç„¶å¯ä»¥å®ç°é¢å‘å¯¹è±¡ï¼Œæ‰€ä»¥æœ‰æ—¶å€™å¼€å‘å‰æœ‰å¿…è¦å¥½å¥½è¿‡ä¸€éå®˜æ–¹æ–‡æ¡£ï¼Œè¦æ€ä¹ˆå†™æ‰èƒ½æ›´åŠ  <code>&quot;Gopher&quot;</code></p><h2 id="Stories-of-Building-a-Remote-Development-IDE-by-Matt-Ellis"><a href="#Stories-of-Building-a-Remote-Development-IDE-by-Matt-Ellis" class="headerlink" title="Stories of Building a Remote Development IDE, by Matt Ellis"></a>Stories of Building a Remote Development IDE, by Matt Ellis</h2><p>ä¸»è¦ä»‹ç»äº†è¿œç¨‹å¼€å‘å’Œå®ç°è¿™ä¸ªåŠŸèƒ½çš„å¿ƒè·¯å†ç¨‹</p><p>è¿™ä¸ªè¿œç¨‹å¼€å‘æ˜¯ä»£ç ã€ç³»ç»Ÿèµ„æºç­‰ç­‰å…¨åœ¨äº‘ç«¯ï¼Œæ¼”ç¤ºé‡Œæ˜¯ç”¨ AWSï¼Œå›½å¤–ä¼ä¸šç”¨ AWS è¾ƒå¤šï¼Œç›®å‰æˆ‘ä¹Ÿè¿˜æ²¡å°è¯•è¿‡ï¼Œå›½å†…ä¸€å…†å°æ°´ç®¡èƒ½å¹²å•¥ï¼Ÿ</p><p>è¿œç¨‹å¼€å‘ä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼Œè°ƒè¯•çš„æ—¶å€™å¦‚ä½•è®¿é—® localhostï¼Ÿè§£å†³æ–¹æ³•æ˜¯åœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œç«¯å£è½¬å‘ï¼Œé€šè¿‡è®¿é—®æœåŠ¡å™¨çš„ç›¸å…³ç«¯å£</p><p>è¿˜æœ‰ä»‹ç» Code With Me çš„åŠŸèƒ½</p><p>è¿™ä¸ªå®ç°è¿œç¨‹å¼€å‘çš„åŠŸèƒ½çš„æ¶æ„ï¼Œæœ‰ç‚¹åƒ MMORPG</p><h2 id="Evolving-JUnit-5-by-Marc-Philipp"><a href="#Evolving-JUnit-5-by-Marc-Philipp" class="headerlink" title="Evolving JUnit 5, by Marc Philipp"></a>Evolving JUnit 5, by Marc Philipp</h2><p>è€å®è¯´ï¼Œå¯¹ JUnit çš„ç ”ç©¶ä¸å¤šï¼Œæ‰€ä»¥å¯¹äºè§†é¢‘çš„ä¸œè¥¿å¥½å¤šéƒ½æ˜¯éå¸¸é™Œç”Ÿï¼Œç•™ä¸‹çš„å°è±¡ä¹Ÿä¸æ·±ï¼ˆæ˜¯æˆ‘ä¸ªäººé—®é¢˜ï¼Œè§†é¢‘æ¼”ç¤ºå¾ˆå¥½ï¼‰</p><h2 id="Project-Loom-Revolution-in-Concurrency-or-Obscure-Implementation-Detail-by-Tomasz-Nurkiewicz"><a href="#Project-Loom-Revolution-in-Concurrency-or-Obscure-Implementation-Detail-by-Tomasz-Nurkiewicz" class="headerlink" title="Project Loom: Revolution in Concurrency or Obscure Implementation Detail?, by Tomasz Nurkiewicz"></a>Project Loom: Revolution in Concurrency or Obscure Implementation Detail?, by Tomasz Nurkiewicz</h2><p>å…¶å®å¾ˆå¤šæ¦‚å¿µéƒ½å’Œå…¶ä»–è¯­è¨€çš„åç¨‹ç›¸ä¼¼ï¼ŒJava é‡Œå«è™šæ‹Ÿçº¿ç¨‹ï¼Œæ˜¯ä¸€ä¸ªå¼€å‘ä¸­çš„åŠŸèƒ½ï¼Œéœ€è¦åŠ å‚æ•°æ‰èƒ½å°è¯•ï¼ŒJDK 19</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java --enable-preview</span><br></pre></td></tr></table></figure><p>ä»ç”¨æˆ·çº¿ç¨‹è®²åˆ°å†…æ ¸çº¿ç¨‹ï¼Œåœ¨ Java çš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼ŒJVM è‡ªå·±å®ç°äº†ä¸€å¥—è°ƒåº¦å™¨ï¼Œé‚£æ—¶è®¡ç®—æœºè¿˜ä¸æ˜¯éå¸¸æ™®åŠï¼Œä¸€èˆ¬æ˜¯å•æ ¸ CPUï¼Œä½† Java ä¹Ÿèƒ½å®ç°å¤šçº¿ç¨‹çš„æ•ˆæœï¼Œè¿™ç§æ˜¯å¤šå¯¹ä¸€çš„æ¨¡å‹ï¼Œä¹Ÿå«ç»¿è‰²çº¿ç¨‹ï¼Œç»¿è‰²çº¿ç¨‹å¹¶ä¸ä¾èµ–åº•å±‚çš„æ“ä½œç³»ç»Ÿï¼Œçº¿ç¨‹çš„è°ƒåº¦éƒ½å‘ç”Ÿåœ¨ç”¨æˆ·ç©ºé—´</p><p>åœ¨å¤šæ ¸çš„ç¯å¢ƒä¸‹ï¼Œè¿™ç§å¤šå¯¹ä¸€çš„æ¨¡å‹å°±ä¸èƒ½å‘æŒ¥ä¼˜åŠ¿äº†ï¼Œä»å®ç°çš„æ•ˆæœæ¥è¯´ï¼Œç»¿è‰²çº¿ç¨‹å®ç°çš„æ˜¯å¹¶å‘ä¸æ˜¯å¹¶è¡Œï¼Œå› æ­¤å‡ºç°ç¬¬äºŒç§æ¨¡å‹</p><p>å¤šå¯¹å¤šæ¨¡å‹ï¼Œä¸€å †ç”¨æˆ·çº¿ç¨‹å¯¹åº”ä¸€å †å†…æ ¸çº¿ç¨‹ï¼Œä¹Ÿæ˜¯ç”± JVM è¿›è¡Œè°ƒåº¦ï¼Œç”¨å¾—ä¸å¤š</p><p>éšç€ JVM å’Œæ“ä½œç³»ç»Ÿçš„æ—¥æ¸æˆç†Ÿä»¥åŠè®¡ç®—æœºçš„å‘å±•ï¼Œæœ€åå‡ºç°çš„æ˜¯ä¸€å¯¹ä¸€æ¨¡å‹ï¼Œä¸€ä¸ªç”¨æˆ·çº¿ç¨‹å¯¹åº”ä¸€ä¸ªå†…æ ¸çº¿ç¨‹ï¼Œè€Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒLinux ç³»ç»Ÿä¼šå°†çº¿ç¨‹çœ‹ä½œè¿›ç¨‹ï¼ˆå…¶ä»–ç³»ç»Ÿä¸æ˜¯ï¼‰ï¼Œæ‰€ä»¥çº¿ç¨‹çš„åˆ›å»ºæ˜¯æ¯”è¾ƒè€—è´¹ç³»ç»Ÿèµ„æºçš„ï¼ˆé»˜è®¤ 1Mï¼‰</p><p>Java é‡Œçš„è™šæ‹Ÿçº¿ç¨‹ï¼Œä¸»è¦ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p><ul><li>Virtual threadï¼šéå¸¸è½»é‡çš„ç”¨æˆ·çº¿ç¨‹ï¼ˆç›¸å½“äºå…¶ä»–è¯­è¨€çš„åç¨‹ã€æˆ–è€… Taskï¼‰</li><li>Carrier threadï¼šJDK 19 å‰çš„ Java çº¿ç¨‹ï¼Œå¯¹åº”ç€ä¸€æ¡å†…æ ¸çº¿ç¨‹ï¼Œè™šæ‹Ÿçº¿ç¨‹ pin åœ¨è¿™é‡Œè¿›è¡Œå¤„ç†</li><li>Continuationï¼šä¸€å †å¯ä»¥è¢«æš‚åœçš„ä»£ç ï¼Œå½“åœ¨æ–¹æ³•ä¸­æš‚åœï¼Œå†æ‰§è¡Œï¼Œä¸ä¼šä»å¤´æ‰§è¡Œæ–¹æ³•ï¼Œè€Œæ˜¯åœ¨æš‚åœå¤„æ¥ç€æ‰§è¡Œï¼ˆPPT åŸæ–‡ï¼šA piece of code that can be paused, at almost no costï¼‰</li></ul><p>æœ‰ç§ IO å¤šè·¯å¤ç”¨çš„æ„Ÿè§‰</p><p>è™šæ‹Ÿçº¿ç¨‹å’Œæ™®é€šçº¿ç¨‹çš„ç”¨æ³•åŸºæœ¬ä¸€æ ·ï¼Œä½†æ˜¯çº¿ç¨‹æ± å¯ä»¥å…äº†ï¼Œå› ä¸ºå¯ä»¥åˆ›å»ºéå¸¸å¤šçš„è™šæ‹Ÿçº¿ç¨‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> Thread.startVirtualThread(() -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Hello World&quot;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> Thread</span><br><span class="line">    .ofVirtual()</span><br><span class="line">    .name(<span class="string">&quot;MyThread&quot;</span>)</span><br><span class="line">    .unstarted(() -&gt; task());</span><br><span class="line"></span><br><span class="line"><span class="type">ExecutorService</span> <span class="variable">es</span> <span class="operator">=</span> Executors.newVirtualThreadPerTaskExecutor();</span><br><span class="line"></span><br><span class="line"><span class="type">ThreadFactory</span> <span class="variable">factory</span> <span class="operator">=</span> Thread</span><br><span class="line">    .ofVirtual()</span><br><span class="line">    .factory();</span><br></pre></td></tr></table></figure><h2 id="JavaFX-for-Mobile-Development-by-Gail-Anderson"><a href="#JavaFX-for-Mobile-Development-by-Gail-Anderson" class="headerlink" title="JavaFX for Mobile Development, by Gail Anderson"></a>JavaFX for Mobile Development, by Gail Anderson</h2><p>ä¸»è¦ä»‹ç» JavaFX å’Œ Gluonï¼Œä½†æ˜¯å·²ç»åäº† WEB è¿™æ¡è·¯äº†ï¼Œæ‰€ä»¥æ²¡æœ‰å¤ªè®¤çœŸå¬</p><p>åˆšå­¦ Java æ—¶å€’æ˜¯åšè¿‡ä¸€äº› GUI åº”ç”¨ï¼Œä¹Ÿå†™è¿‡ Androidï¼Œæœ€åè¿˜æ˜¯å›åˆ°äº† WEB</p><p>æ‰¾æœºä¼šé‡æ–°çœ‹ä¸€é</p><hr><p>æœ€åé™„ä¸ŠåŸè§†é¢‘ï¼ˆç§‘å­¦ï¼‰ï¼š</p><h1 id="day-1"><a href="#day-1" class="headerlink" title="day 1"></a>day 1</h1><p>Agenda:</p><p>0:00 â€“ Countdown<br>0:53 â€“ Introduction<br>4:35 â€“ Keynote: Surviving Open Source, by Donald Raab<br>1:01:27 â€“ Letâ€™s Set Sail With Fleet!, by Vitaly Bragilevsky<br>1:59:46 â€“ Should I Upgrade to Java 17?, by Nikhil Nanivadekar<br>3:01:06 â€“ Event Streaming and Processing Using Apache Pulsar, by Mary Grygleski<br>4:00:19 â€“ Kubernetes Native Java, by Josh Long</p><div class="video"><iframe width="560" height="315" src="https://www.youtube.com/embed/vmS9vNbta-w" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div><h1 id="day-2-1"><a href="#day-2-1" class="headerlink" title="day 2"></a>day 2</h1><p>Agenda:</p><p>0:00 â€“ Countdown<br>0:53 â€“ Introduction<br>5:49 â€“ Idiomatic Kotlin, by Anton Arhipov<br>1:03:12 â€“ Wish You Were Here: Stories of Building a Remote Development IDE, by Matt Ellis<br>2:01:22 â€“ Evolving JUnit 5, by Marc Philipp<br>3:01:18 â€“ Project Loom: Revolution in Concurrency or Obscure Implementation Detail?, by Tomasz Nurkiewicz<br>4:02:37 â€“ JavaFX for Mobile Development, by Gail Anderson</p><div class="video"><iframe width="560" height="315" src="https://www.youtube.com/embed/-8epeIFdKWo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;çœ‹å®Œäº†çš„ &lt;code&gt;IntelliJ IDEA Conf 2022 (day 1)&lt;/code&gt; å’Œ &lt;code&gt;IntelliJ IDEA Conf 2022 (day 2)&lt;/code&gt;&lt;br&gt;å†™ä¸€ä¸‹å°è±¡æ¯”è¾ƒæ·±çš„å’Œè§‚åæ„Ÿ&lt;/p&gt;
&lt;h1 id=&quot;day1&quot;&gt;&lt;a hr</summary>
      
    
    
    
    <category term="ç¤¾åŒºæ´»åŠ¨" scheme="https://linweiyuan.github.io/categories/%E7%A4%BE%E5%8C%BA%E6%B4%BB%E5%8A%A8/"/>
    
    
    <category term="Java" scheme="https://linweiyuan.github.io/tags/Java/"/>
    
    <category term="Kotlin" scheme="https://linweiyuan.github.io/tags/Kotlin/"/>
    
    <category term="IntelliJ IDEA Conf" scheme="https://linweiyuan.github.io/tags/IntelliJ-IDEA-Conf/"/>
    
  </entry>
  
  <entry>
    <title>Goå®ç°Podåå°ç«¯å£è½¬å‘</title>
    <link href="https://linweiyuan.github.io/2022/09/27/Go%E5%AE%9E%E7%8E%B0Pod%E5%90%8E%E5%8F%B0%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91.html"/>
    <id>https://linweiyuan.github.io/2022/09/27/Go%E5%AE%9E%E7%8E%B0Pod%E5%90%8E%E5%8F%B0%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91.html</id>
    <published>2022-09-27T18:39:50.000Z</published>
    <updated>2022-10-04T11:01:19.593Z</updated>
    
    <content type="html"><![CDATA[<p>GitHub: <a href="https://github.com/linweiyuan/goportforwarder">https://github.com/linweiyuan/goportforwarder</a></p><p>åœ¨Kubernetes in docker (kind) çš„ç¯å¢ƒä¸‹ï¼Œæ²¡æœ‰æ‰¾åˆ°å¥½ç”¨çš„æ”¯æŒåå°è¿è¡Œçš„ç«¯å£è½¬å‘æ–¹æ¡ˆï¼Œè‡ªå·±å®ç°äº†ä¸ªç®€å•çš„</p><div class="video"><iframe src="//player.bilibili.com/player.html?aid=303421894&bvid=BV1PP411n7qN&cid=845282247&page=1&high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;GitHub: &lt;a href=&quot;https://github.com/linweiyuan/goportforwarder&quot;&gt;https://github.com/linweiyuan/goportforwarder&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨Kubernetes in d</summary>
      
    
    
    
    <category term="æ“ä½œç³»ç»Ÿ" scheme="https://linweiyuan.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
    <category term="Kubernetes" scheme="https://linweiyuan.github.io/tags/Kubernetes/"/>
    
    <category term="Golang" scheme="https://linweiyuan.github.io/tags/Golang/"/>
    
    <category term="Pod" scheme="https://linweiyuan.github.io/tags/Pod/"/>
    
  </entry>
  
  <entry>
    <title>Ingressé…ç½®pgAdminéœ€è¦æ³¨æ„çš„é—®é¢˜</title>
    <link href="https://linweiyuan.github.io/2022/09/23/Ingress%E9%85%8D%E7%BD%AEpgAdmin%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E9%97%AE%E9%A2%98.html"/>
    <id>https://linweiyuan.github.io/2022/09/23/Ingress%E9%85%8D%E7%BD%AEpgAdmin%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E9%97%AE%E9%A2%98.html</id>
    <published>2022-09-23T17:32:34.000Z</published>
    <updated>2022-10-04T11:01:19.593Z</updated>
    
    <content type="html"><![CDATA[<p>å½“ä½¿ç”¨ Docker æˆ–è€… Docker Compose éƒ¨ç½² pgAdmin æ¥æ–¹ä¾¿æœ¬åœ°å¼€å‘è®¿é—®ä½¿ç”¨çš„æ—¶å€™ï¼Œæ˜¯ä¸éœ€è¦é¢å¤–æ³¨æ„çš„ï¼Œå› ä¸ºé€šå¸¸éƒ½æ˜¯ç›´æ¥æš´éœ²ç«¯å£å‡ºå»</p><p>ä½†æ˜¯åŸºäº K8s ç¯å¢ƒä¸‹éƒ¨ç½²çš„æ—¶å€™ï¼Œéœ€è¦ç¨å¾®æ³¨æ„ä¸€ç‚¹åœ°æ–¹</p><h1 id="K8s-é›†ç¾¤å‡†å¤‡"><a href="#K8s-é›†ç¾¤å‡†å¤‡" class="headerlink" title="K8s é›†ç¾¤å‡†å¤‡"></a>K8s é›†ç¾¤å‡†å¤‡</h1><p>K8s çš„æ­å»ºæ–¹å¼å¤šç§å¤šæ ·ï¼Œæ¯”å¦‚ k3dã€kubeadmã€kind ç­‰ï¼Œç”±äºå¤šå¹´ä¹‹å‰æœ‰è£¸è£… Oracle æŠŠç³»ç»Ÿæçƒ‚çš„ç»å†ï¼Œå¯¹äºä¸€äº›è½¯ä»¶çš„å®‰è£…ï¼Œæˆ‘è¿™è¾¹æ˜¯æ¯”è¾ƒè°¨æ…çš„ã€‚å†µä¸”åé¢æ¥è§¦äº†å®¹å™¨ï¼Œèƒ½åœ¨é‡Œé¢è·‘å°±é‡Œé¢è·‘ï¼Œä»€ä¹ˆä¸¤å€è¯»å†™çš„é—®é¢˜ä¸è€ƒè™‘ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨çš„æ˜¯ <code>kind</code> æ¥æ­å»ºé›†ç¾¤</p><p>ä¸ºäº†æœåŠ¡åœ¨å®¹å™¨å¤–èƒ½è®¿é—®ï¼Œkind åˆ›å»º K8s é›†ç¾¤çš„æ—¶å€™è¿˜éœ€è¦ä¸€äº›é¢å¤–çš„é…ç½®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">kind:</span> <span class="string">Cluster</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">kind.x-k8s.io/v1alpha4</span></span><br><span class="line"><span class="attr">networking:</span></span><br><span class="line">  <span class="attr">apiServerAddress:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">  <span class="attr">apiServerPort:</span> <span class="number">6443</span></span><br><span class="line"><span class="attr">nodes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">control-plane</span></span><br><span class="line">    <span class="attr">kubeadmConfigPatches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">|</span></span><br><span class="line"><span class="string">        kind: InitConfiguration</span></span><br><span class="line"><span class="string">        nodeRegistration:</span></span><br><span class="line"><span class="string">          kubeletExtraArgs:</span></span><br><span class="line"><span class="string">            node-labels: &quot;ingress-ready=true&quot;</span></span><br><span class="line"><span class="string"></span>    <span class="attr">extraPortMappings:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">        <span class="attr">hostPort:</span> <span class="number">80</span></span><br><span class="line">        <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">443</span></span><br><span class="line">        <span class="attr">hostPort:</span> <span class="number">443</span></span><br><span class="line">        <span class="attr">protocol:</span> <span class="string">TCP</span></span><br></pre></td></tr></table></figure><h1 id="Ingress-Controller-å‡†å¤‡"><a href="#Ingress-Controller-å‡†å¤‡" class="headerlink" title="Ingress Controller å‡†å¤‡"></a>Ingress Controller å‡†å¤‡</h1><p>K8s æš´éœ²æœåŠ¡çš„æ–¹å¼ä¹Ÿå¤šç§å¤šæ ·ï¼Œæ¯”å¦‚ NodePortã€LoadBalancerã€Ingressã€‚ç”±äº kind çš„ç‰¹æ®Šæ€§ï¼Œæ•´ä¸ª K8s é›†ç¾¤éƒ½è·‘åœ¨å®¹å™¨ä¸­ï¼Œæ‰€ä»¥å°±ç®— NodePort ä¹Ÿæ˜¯å®¹å™¨é‡Œçš„ç«¯å£ï¼Œæ‰€ä»¥è¿™æ¬¡ä¸»è¦è®¨è®º Ingressï¼Œä½¿ç”¨çš„æ˜¯ <code>Nginx</code></p><p>ä½¿ç”¨ Ingressï¼Œé¦–å…ˆéœ€è¦åœ¨é›†ç¾¤ä¸­å®‰è£…ä¸€ä¸ª Ingress Controllerï¼Œç„¶åé€šè¿‡ Ingress æ¥è¿›è¡Œä¸€äº›é…ç½®ï¼Œå½“ apply çš„æ—¶å€™ï¼ŒIngress Controller ä¼šè‡ªåŠ¨æ›´æ–° nginx.conf å¹¶è¿›è¡Œ reload</p><p>å¦‚æœä¹‹å‰é…ç½®è¿‡ Nginxï¼Œå…¶å®ç±»æ¯”èµ·æ¥æ˜¯å¾ˆåƒçš„ï¼Œä¸€ä¸ª Ingress Controller ç›¸å½“äºä¸€ä¸ª Nginxï¼Œä¸€ä¸ª Ingress åˆ™å¥½æ¯” Nginx çš„é…ç½®æ–‡ä»¶</p><p>å½“ Ingress Controller å‡†å¤‡å¥½åï¼Œä¼šä»¥ NodePort çš„æ–¹å¼æš´éœ² 80 å’Œ 443 ç«¯å£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NAME                                 TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)                      AGE</span><br><span class="line">ingress-nginx-controller             NodePort    10.96.30.54    &lt;none&gt;        80:30860/TCPï¼Œ443:31875/TCP   3d</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="pgAdmin-å‡†å¤‡"><a href="#pgAdmin-å‡†å¤‡" class="headerlink" title="pgAdmin å‡†å¤‡"></a>pgAdmin å‡†å¤‡</h1><p>ä¸ºäº†ç®€å•èµ·è§ï¼Œä½¿ç”¨ <code>helm</code> æ¥å®‰è£… pgAdmin</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">helm install pgadmin runix/pgadmin4 --<span class="built_in">set</span> env.email=root@linweiyuan.com --<span class="built_in">set</span> env.password=toor</span><br></pre></td></tr></table></figure><h1 id="Ingress-å‡†å¤‡"><a href="#Ingress-å‡†å¤‡" class="headerlink" title="Ingress å‡†å¤‡"></a>Ingress å‡†å¤‡</h1><p>é…ç½®å¥½ Ingress è§„åˆ™ï¼Œå› ä¸ºæƒ³åšåˆ°è®¿é—®ä¸åŒçš„ path è·¯ç”±åˆ°ä¸åŒçš„æœåŠ¡ï¼Œæ‰€ä»¥è¿™é‡Œç”¨ &#x2F;pgAdmin æ¥è®¾ç½®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pgadmin-ingress</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">http:</span></span><br><span class="line">        <span class="attr">paths:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">&quot;/pgAdmin&quot;</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">pgadmin-pgadmin4</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æ­¤æ—¶è®¿é—® <a href="http://localhost/pgAdmin">http://localhost/pgAdmin</a> çš„æ—¶å€™ï¼Œä¼šè¿”å› 404</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Not Found The requested URL was not found on the server. If you entered the URL</span><br><span class="line">manually please check your spelling and try again.</span><br></pre></td></tr></table></figure><h1 id="pgAdmin-è®¿é—®è§£å†³"><a href="#pgAdmin-è®¿é—®è§£å†³" class="headerlink" title="pgAdmin è®¿é—®è§£å†³"></a>pgAdmin è®¿é—®è§£å†³</h1><p>æŸ¥çœ‹<a href="https://www.pgadmin.org/docs/pgadmin4/latest/container_deployment.html#http-via-nginx">å®˜æ–¹æ–‡æ¡£</a>ï¼Œä¼šå‘ç°è¿™ä¹ˆä¸€å¥è¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">If you wish to host pgAdmin under a subdirectory rather than on the root of the server, you must specify the location and set the X-Script-Name header which tells the pgAdmin container how to rewrite paths</span><br></pre></td></tr></table></figure><p>å°±æ˜¯è¯´ Nginx çš„é…ç½®é‡Œè¦åŠ  <code>X-Script-Name</code>ï¼Œä½†æ˜¯åœ¨ K8s é‡Œè¦æ€ä¹ˆåŠ ï¼Ÿ</p><p>å‰é¢æè¿‡ï¼Œå…¶å®æ— éæ˜¯ä¿®æ”¹ Ingress çš„é…ç½®ï¼Œæ­¤æ—¶å¦‚æœè¿›å…¥ Ingress Controller çš„ pod ä¸­æŸ¥çœ‹é…ç½®æ–‡ä»¶ï¼Œä¼šå‘ç°å½“å‰é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bash-5.1$ hostname</span><br><span class="line">ingress-nginx-controller-65b4b4df7d-rhd2k</span><br><span class="line">bash-5.1$ <span class="built_in">cat</span> -n nginx.conf | grep pgAdmin</span><br><span class="line">   297location /pgAdmin/ &#123;</span><br><span class="line">   303<span class="built_in">set</span> <span class="variable">$location_path</span>  <span class="string">&quot;/pgAdmin&quot;</span>;</span><br><span class="line">   415location = /pgAdmin &#123;</span><br><span class="line">   421<span class="built_in">set</span> <span class="variable">$location_path</span>  <span class="string">&quot;/pgAdmin&quot;</span>;</span><br></pre></td></tr></table></figure><p>è€Œæ ¹æ® pgAdmin å®˜æ–¹æ–‡æ¡£çš„æŒ‡å¼•ï¼Œéœ€è¦æŠŠé…ç½®åŠ åˆ° location ä¸‹ï¼Œå›å¤´æŸ¥çœ‹ <a href="https://github.com/kubernetes/ingress-nginx/blob/main/docs/user-guide/nginx-configuration/annotations.md#configuration-snippet">K8s å®˜æ–¹æ–‡æ¡£</a>ï¼Œå‘ç°å…¶å®æ˜¯é…ç½® <code>nginx.ingress.kubernetes.io/configuration-snippet</code></p><p>å› æ­¤é…ç½®æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œå®Œæ•´é…ç½®æ–‡ä»¶å¦‚ä¸‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pgadmin-ingress</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">nginx.ingress.kubernetes.io/configuration-snippet:</span> <span class="string">|</span></span><br><span class="line"><span class="string">      proxy_set_header X-Script-Name /pgAdmin;</span></span><br><span class="line"><span class="string"></span><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">http:</span></span><br><span class="line">        <span class="attr">paths:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">&quot;/pgAdmin&quot;</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">pgadmin-pgadmin4</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><p>å† apply</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kaf pgadmin-ingress.yaml</span><br><span class="line">ingress.networking.k8s.io/pgadmin-ingress configured</span><br></pre></td></tr></table></figure><p>å†æŸ¥çœ‹ nginx.confï¼Œå·²ç»ç”Ÿæ•ˆäº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bash-5.1$ <span class="built_in">cat</span> -n nginx.conf | grep pgAdmin</span><br><span class="line">   297location /pgAdmin/ &#123;</span><br><span class="line">   303<span class="built_in">set</span> <span class="variable">$location_path</span>  <span class="string">&quot;/pgAdmin&quot;</span>;</span><br><span class="line">   409proxy_set_header X-Script-Name /pgAdmin;</span><br><span class="line">   417location = /pgAdmin &#123;</span><br><span class="line">   423<span class="built_in">set</span> <span class="variable">$location_path</span>  <span class="string">&quot;/pgAdmin&quot;</span>;</span><br><span class="line">   529proxy_set_header X-Script-Name /pgAdmin;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å†è®¿é—® <a href="http://localhost/pgAdmin">http://localhost/pgAdmin</a></p><p>ä¼šè‡ªåŠ¨è·³è½¬ <a href="http://localhost/pgAdmin/login?next=/pgAdmin/">http://localhost/pgAdmin/login?next=%2FpgAdmin%2F</a></p><p>ç”¨ä¸Šé¢ helm è®¾ç½®çš„ç”¨æˆ·åå’Œå¯†ç å³å¯ç™»å½•è¿›å»ï¼Œé—®é¢˜è§£å†³</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å½“ä½¿ç”¨ Docker æˆ–è€… Docker Compose éƒ¨ç½² pgAdmin æ¥æ–¹ä¾¿æœ¬åœ°å¼€å‘è®¿é—®ä½¿ç”¨çš„æ—¶å€™ï¼Œæ˜¯ä¸éœ€è¦é¢å¤–æ³¨æ„çš„ï¼Œå› ä¸ºé€šå¸¸éƒ½æ˜¯ç›´æ¥æš´éœ²ç«¯å£å‡ºå»&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åŸºäº K8s ç¯å¢ƒä¸‹éƒ¨ç½²çš„æ—¶å€™ï¼Œéœ€è¦ç¨å¾®æ³¨æ„ä¸€ç‚¹åœ°æ–¹&lt;/p&gt;
&lt;h1 id=&quot;K8s-é›†ç¾¤å‡†å¤‡&quot;</summary>
      
    
    
    
    <category term="å®¹å™¨æŠ€æœ¯" scheme="https://linweiyuan.github.io/categories/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/"/>
    
    <category term="Kubernetes" scheme="https://linweiyuan.github.io/categories/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/Kubernetes/"/>
    
    
    <category term="Kubernetes" scheme="https://linweiyuan.github.io/tags/Kubernetes/"/>
    
    <category term="pgAdmin" scheme="https://linweiyuan.github.io/tags/pgAdmin/"/>
    
    <category term="Ingress" scheme="https://linweiyuan.github.io/tags/Ingress/"/>
    
  </entry>
  
  <entry>
    <title>åˆ©ç”¨ Github Actions å®ç°ä»£ç æäº¤è‡ªåŠ¨éƒ¨ç½²æ›´æ–° Kubernetes</title>
    <link href="https://linweiyuan.github.io/2022/09/13/%E5%88%A9%E7%94%A8GithubActions%E5%AE%9E%E7%8E%B0%E4%BB%A3%E7%A0%81%E6%8F%90%E4%BA%A4%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2%E6%9B%B4%E6%96%B0Kubernetes.html"/>
    <id>https://linweiyuan.github.io/2022/09/13/%E5%88%A9%E7%94%A8GithubActions%E5%AE%9E%E7%8E%B0%E4%BB%A3%E7%A0%81%E6%8F%90%E4%BA%A4%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2%E6%9B%B4%E6%96%B0Kubernetes.html</id>
    <published>2022-09-13T04:31:35.000Z</published>
    <updated>2022-10-04T11:01:19.601Z</updated>
    
    <content type="html"><![CDATA[<p>GitHub: <a href="https://github.com/linweiyuan/github-actions-tests">https://github.com/linweiyuan/github-actions-tests</a></p><p>å¯ä»¥æ¢æ‰å¤§éƒ¨åˆ† Jenkins + webhooks çš„åœºæ™¯</p><div class="video"><iframe src="//player.bilibili.com/player.html?aid=515899777&bvid=BV1Ag411e7DG&cid=842773470&page=1&high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;GitHub: &lt;a href=&quot;https://github.com/linweiyuan/github-actions-tests&quot;&gt;https://github.com/linweiyuan/github-actions-tests&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥æ¢æ‰å¤§éƒ¨</summary>
      
    
    
    
    <category term="Github Actions" scheme="https://linweiyuan.github.io/categories/Github-Actions/"/>
    
    
    <category term="Kubernetes" scheme="https://linweiyuan.github.io/tags/Kubernetes/"/>
    
    <category term="Golang" scheme="https://linweiyuan.github.io/tags/Golang/"/>
    
    <category term="Github Actions" scheme="https://linweiyuan.github.io/tags/Github-Actions/"/>
    
  </entry>
  
  <entry>
    <title>Go å®ç° i3bar æ˜¾ç¤ºæ­Œè¯</title>
    <link href="https://linweiyuan.github.io/2022/09/06/Go%E5%AE%9E%E7%8E%B0i3bar%E6%98%BE%E7%A4%BA%E6%AD%8C%E8%AF%8D.html"/>
    <id>https://linweiyuan.github.io/2022/09/06/Go%E5%AE%9E%E7%8E%B0i3bar%E6%98%BE%E7%A4%BA%E6%AD%8C%E8%AF%8D.html</id>
    <published>2022-09-06T04:31:35.000Z</published>
    <updated>2022-10-04T11:01:19.593Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸºäº-Go-å®ç°çš„-i3bar-æ­Œè¯æ˜¾ç¤ºç¨‹åº"><a href="#åŸºäº-Go-å®ç°çš„-i3bar-æ­Œè¯æ˜¾ç¤ºç¨‹åº" class="headerlink" title="åŸºäº Go å®ç°çš„ i3bar æ­Œè¯æ˜¾ç¤ºç¨‹åº"></a>åŸºäº Go å®ç°çš„ i3bar æ­Œè¯æ˜¾ç¤ºç¨‹åº</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/linweiyuan/goi3barlyric.git</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> build</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bar &#123;</span><br><span class="line">    status_command goi3barlyric</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™åˆ¶è¾ƒå¤šï¼Œå®éªŒæ€§è´¨</p><div class="video"><iframe src="//player.bilibili.com/player.html?aid=473404363&bvid=BV1PT411M7H5&cid=842777138&page=1&high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åŸºäº-Go-å®ç°çš„-i3bar-æ­Œè¯æ˜¾ç¤ºç¨‹åº&quot;&gt;&lt;a href=&quot;#åŸºäº-Go-å®ç°çš„-i3bar-æ­Œè¯æ˜¾ç¤ºç¨‹åº&quot; class=&quot;headerlink&quot; title=&quot;åŸºäº Go å®ç°çš„ i3bar æ­Œè¯æ˜¾ç¤ºç¨‹åº&quot;&gt;&lt;/a&gt;åŸºäº Go å®ç°çš„ i3bar æ­Œè¯æ˜¾ç¤º</summary>
      
    
    
    
    <category term="æ“ä½œç³»ç»Ÿ" scheme="https://linweiyuan.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
    <category term="Golang" scheme="https://linweiyuan.github.io/tags/Golang/"/>
    
    <category term="i3" scheme="https://linweiyuan.github.io/tags/i3/"/>
    
    <category term="i3bar" scheme="https://linweiyuan.github.io/tags/i3bar/"/>
    
  </entry>
  
  <entry>
    <title>Docker å¸¸ç”¨æœåŠ¡</title>
    <link href="https://linweiyuan.github.io/2022/07/26/Docker-%E5%B8%B8%E7%94%A8%E6%9C%8D%E5%8A%A1.html"/>
    <id>https://linweiyuan.github.io/2022/07/26/Docker-%E5%B8%B8%E7%94%A8%E6%9C%8D%E5%8A%A1.html</id>
    <published>2022-07-26T18:42:48.000Z</published>
    <updated>2022-10-04T11:01:19.593Z</updated>
    
    <content type="html"><![CDATA[<p>æ•´ç†äº†ä¸‹å¸¸ç”¨çš„ <code>Docker</code> æœåŠ¡ï¼š <a href="https://github.com/linweiyuan/docker-services">https://github.com/linweiyuan/docker-services</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æ•´ç†äº†ä¸‹å¸¸ç”¨çš„ &lt;code&gt;Docker&lt;/code&gt; æœåŠ¡ï¼š &lt;a href=&quot;https://github.com/linweiyuan/docker-services&quot;&gt;https://github.com/linweiyuan/docker-services&lt;/a&gt;</summary>
      
    
    
    
    <category term="å®¹å™¨æŠ€æœ¯" scheme="https://linweiyuan.github.io/categories/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="Docker" scheme="https://linweiyuan.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Docker ä½¿ç”¨å›½å†…é•œåƒæºæ—¶é‡åˆ°çš„å‘</title>
    <link href="https://linweiyuan.github.io/2022/07/25/Docker-%E4%BD%BF%E7%94%A8%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F%E6%BA%90%E6%97%B6%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91.html"/>
    <id>https://linweiyuan.github.io/2022/07/25/Docker-%E4%BD%BF%E7%94%A8%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F%E6%BA%90%E6%97%B6%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91.html</id>
    <published>2022-07-25T02:50:47.000Z</published>
    <updated>2022-10-04T11:01:19.593Z</updated>
    
    <content type="html"><![CDATA[<p>è¯¦è§ï¼š<a href="https://github.com/ustclug/discussions/issues/396">https://github.com/ustclug/discussions/issues/396</a></p><p>â€œæ•…ä» 2020 å¹´ 4 æœˆèµ·ï¼Œä»ç§‘å¤§æ ¡å¤–å¯¹ Docker Hub é•œåƒç¼“å­˜çš„è®¿é—®ä¼šè¢« 302 é‡å®šå‘è‡³å…¶ä»–å›½å†… Docker Hub é•œåƒæºâ€</p><p>å¯ä»¥çœ‹åˆ°æ˜¯é‡å®šå‘åˆ°é˜¿é‡Œäº‘</p><p><a href="https://docker.mirrors.ustc.edu.cn/">https://docker.mirrors.ustc.edu.cn</a> -&gt; <a href="https://ustc-edu-cn.mirror.aliyuncs.com/">https://ustc-edu-cn.mirror.aliyuncs.com</a></p><p>ä½†æ˜¯æ ¡å¤–è®¿é—®è¿™ä¸ªä»“åº“å·²ç»æ˜¯æ—§çš„äº†</p><p>æ›¿ä»£å“</p><ul><li>ç›´è¿</li><li>é˜¿é‡Œäº‘ï¼ˆå¹¿å·æˆ–æ­å·ï¼Œæˆ–è‡ªå·±è´¦å·ï¼‰ï¼š<a href="https://registry.cn-guangzhou.aliyuncs.com/">https://registry.cn-guangzhou.aliyuncs.com</a></li><li>ç½‘æ˜“ï¼ˆå®¹æ˜“è¿ç€è¿ç€è‡ªåŠ¨æ–­å¼€ï¼‰ï¼š<a href="https://hub-mirror.c.163.com/">https://hub-mirror.c.163.com</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¯¦è§ï¼š&lt;a href=&quot;https://github.com/ustclug/discussions/issues/396&quot;&gt;https://github.com/ustclug/discussions/issues/396&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;â€œæ•…ä» 2020 å¹´ 4 </summary>
      
    
    
    
    <category term="å®¹å™¨æŠ€æœ¯" scheme="https://linweiyuan.github.io/categories/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="Docker" scheme="https://linweiyuan.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>30åˆ†é’Ÿä»0åˆ°1æ­å»ºä¸€ä¸ªæœ€åŸºç¡€çš„Rancher</title>
    <link href="https://linweiyuan.github.io/2022/06/04/30%E5%88%86%E9%92%9F%E4%BB%8E0%E5%88%B01%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%9C%80%E5%9F%BA%E7%A1%80%E7%9A%84Rancher.html"/>
    <id>https://linweiyuan.github.io/2022/06/04/30%E5%88%86%E9%92%9F%E4%BB%8E0%E5%88%B01%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%9C%80%E5%9F%BA%E7%A1%80%E7%9A%84Rancher.html</id>
    <published>2022-06-04T04:31:35.000Z</published>
    <updated>2022-10-04T11:01:19.593Z</updated>
    
    <content type="html"><![CDATA[<p>å®¿ä¸»æœº Arch Linuxï¼Œcgroup v2, å®‰è£…ä¼šæŠ¥é”™ï¼Œè§£å†³æ–¹æ¡ˆ -&gt; systemd.unified_cgroup_hierarchy&#x3D;0</p><p>ç®€å•èµ·è§ï¼ŒåŸºäºè™šæ‹Ÿæœº CentOS 7.9ï¼Œä¸€ä¸»ä¸¤ä»<br>rancher ç®¡ç†æœºï¼š192.168.31.240<br>k8s ä¸€ä¸»èŠ‚ç‚¹ï¼š192.168.31.250<br>k8s ä¸¤ä»èŠ‚ç‚¹ï¼š192.168.31.251, 192.168.31.252</p><p>docker ç§æœ‰ä»“åº“ï¼š distribution&#x2F;registry</p><p>å†…ç½‘ dnsï¼šdnsmasq</p><div class="video"><iframe src="//player.bilibili.com/player.html?aid=560999944&bvid=BV1Fe4y1B7Bf&cid=842560164&page=1&high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å®¿ä¸»æœº Arch Linuxï¼Œcgroup v2, å®‰è£…ä¼šæŠ¥é”™ï¼Œè§£å†³æ–¹æ¡ˆ -&amp;gt; systemd.unified_cgroup_hierarchy&amp;#x3D;0&lt;/p&gt;
&lt;p&gt;ç®€å•èµ·è§ï¼ŒåŸºäºè™šæ‹Ÿæœº CentOS 7.9ï¼Œä¸€ä¸»ä¸¤ä»&lt;br&gt;rancher ç®¡ç†æœºï¼š192.1</summary>
      
    
    
    
    <category term="æ“ä½œç³»ç»Ÿ" scheme="https://linweiyuan.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
    <category term="Arch Linux" scheme="https://linweiyuan.github.io/tags/Arch-Linux/"/>
    
    <category term="Rancher" scheme="https://linweiyuan.github.io/tags/Rancher/"/>
    
    <category term="Kubernetes" scheme="https://linweiyuan.github.io/tags/Kubernetes/"/>
    
    <category term="CentOS" scheme="https://linweiyuan.github.io/tags/CentOS/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†å¸ƒå¼ç›¸å…³ç†è®º</title>
    <link href="https://linweiyuan.github.io/2022/05/22/%E5%88%86%E5%B8%83%E5%BC%8F%E7%9B%B8%E5%85%B3%E7%90%86%E8%AE%BA.html"/>
    <id>https://linweiyuan.github.io/2022/05/22/%E5%88%86%E5%B8%83%E5%BC%8F%E7%9B%B8%E5%85%B3%E7%90%86%E8%AE%BA.html</id>
    <published>2022-05-22T09:42:15.000Z</published>
    <updated>2022-10-04T11:01:19.597Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CAP"><a href="#CAP" class="headerlink" title="CAP"></a>CAP</h1><ul><li>Cï¼šConsistencyï¼ˆä¸€è‡´æ€§ï¼‰<br>è®¿é—®åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¾—åˆ°çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ï¼ˆéœ€è¦è¿›è¡Œæ•°æ®åŒæ­¥ï¼‰</li><li>Aï¼šAvailabilityï¼ˆå¯ç”¨æ€§ï¼‰<br>è®¿é—®åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä»»ä½•ä¸€ä¸ªå¥åº·èŠ‚ç‚¹ï¼Œå¿…é¡»èƒ½å¾—åˆ°å“åº”ï¼Œè€Œä¸æ˜¯è¶…æ—¶æˆ–æ‹’ç»ï¼ˆéœ€è¦ç¡®ä¿ç½‘ç»œç•…é€šï¼‰</li><li>Pï¼šPartition toleranceï¼ˆåˆ†åŒºå®¹é”™æ€§ï¼‰<ul><li>åˆ†åŒºï¼šåˆ†å¸ƒå¼ç³»ç»Ÿä¸­éƒ¨åˆ†èŠ‚ç‚¹ç”±äºå‘ç”Ÿç½‘ç»œæ•…éšœæˆ–å…¶ä»–åŸå› å¯¼è‡´å’Œå…¶ä»–èŠ‚ç‚¹å¤±å»è¿æ¥ï¼Œå½¢æˆç‹¬ç«‹åˆ†åŒº</li><li>å®¹é”™ï¼šå‡ºç°ç‹¬ç«‹åˆ†åŒºæ—¶ï¼Œæ•´ä¸ªç³»ç»Ÿä¹Ÿè¦æŒç»­å¯¹å¤–æä¾›æœåŠ¡</li></ul></li></ul><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç½‘ç»œæ˜¯ä¸€ä¸ªä¸ç¡®å®šçš„å› ç´ ï¼Œä½†æ˜¯å‘ç”Ÿç½‘ç»œæ•…éšœçš„æ—¶å€™ï¼ŒæœåŠ¡è¿˜è¦æŒç»­å¯¹å¤–æä¾›æœåŠ¡ï¼Œæ‰€ä»¥åˆ†åŒºå®¹é”™æ€§ä¸å¯é¿å…</p><p>å‡å¦‚ç½‘ç»œä¸ä½³ï¼Œå¯¼è‡´æœ‰èŠ‚ç‚¹æ•…éšœæ‰çº¿ï¼Œæ­¤æ—¶æ¥æ”¶åˆ°æ–°çš„æ•°æ®å˜æ›´æ—¶ï¼š</p><ul><li>å¦‚æœè¦ä¿è¯å¯ç”¨æ€§ï¼Œå°±ä¸èƒ½ç­‰å¾…ç½‘ç»œæ¢å¤ï¼Œé‚£èŠ‚ç‚¹ä¹‹é—´å°±ä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µï¼Œå› ä¸ºæ•°æ®åŒæ­¥éœ€è¦æ—¶é—´</li><li>å¦‚æœè¦ä¿è¯ä¸€è‡´æ€§ï¼Œå°±å¿…é¡»ç­‰å¾…ç½‘ç»œæ¢å¤ï¼Œå®Œæˆæ•°æ®åŒæ­¥åï¼Œæ•´ä¸ªé›†ç¾¤æ‰å¯¹å¤–æä¾›æœåŠ¡ï¼Œåœ¨è¿™ä¸ªæ•°æ®åŒæ­¥çš„è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡æš‚æ—¶ä¸å¯ç”¨</li></ul><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ P ä¸€å®šå‡ºç°çš„æƒ…å†µä¸‹ï¼ŒA å’Œ C ä¹‹é—´åªèƒ½å®ç°ä¸€ä¸ªï¼Œè¦ä¹ˆ APï¼Œè¦ä¹ˆ CP</p><h1 id="BASE"><a href="#BASE" class="headerlink" title="BASE"></a>BASE</h1><p>BASE æ˜¯å¯¹ CAP çš„ä¸€ç§æ‰©å±•</p><ul><li>Basically Availableï¼ˆåŸºæœ¬å¯ç”¨ï¼‰ï¼šå½“åˆ†å¸ƒå¼ç³»ç»Ÿå‡ºç°æ•…éšœæ—¶ï¼Œå…è®¸ä¸¢å¤±éƒ¨åˆ†å¯ç”¨æ€§ï¼Œä¿è¯æ ¸å¿ƒä¸šåŠ¡å¯ç”¨</li><li>Soft Stateï¼ˆè½¯çŠ¶æ€ï¼‰ï¼šåœ¨ä¸€å®šçš„æ—¶é—´å†…ï¼Œå…è®¸å‡ºç°æ•°æ®ä¸ä¸€è‡´çš„çŠ¶æ€</li><li>Eventually Consistentï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰ï¼šå½“è½¯çŠ¶æ€ç»“æŸåï¼Œç¡®ä¿æ•°æ®æœ€ç»ˆæ˜¯ä¸€è‡´çš„</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;CAP&quot;&gt;&lt;a href=&quot;#CAP&quot; class=&quot;headerlink&quot; title=&quot;CAP&quot;&gt;&lt;/a&gt;CAP&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;Cï¼šConsistencyï¼ˆä¸€è‡´æ€§ï¼‰&lt;br&gt;è®¿é—®åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¾—åˆ°çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ï¼ˆéœ€è¦è¿›è¡Œæ•°æ®åŒæ­¥ï¼‰&lt;/l</summary>
      
    
    
    
    <category term="æ¶æ„è®¾è®¡" scheme="https://linweiyuan.github.io/categories/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/"/>
    
    
    <category term="CAP" scheme="https://linweiyuan.github.io/tags/CAP/"/>
    
    <category term="BASE" scheme="https://linweiyuan.github.io/tags/BASE/"/>
    
  </entry>
  
  <entry>
    <title>Javaé«˜å¹¶å‘æ ¸å¿ƒç¼–ç¨‹å·1è¯»ä¹¦ç¬”è®°</title>
    <link href="https://linweiyuan.github.io/2022/05/01/Java%E9%AB%98%E5%B9%B6%E5%8F%91%E6%A0%B8%E5%BF%83%E7%BC%96%E7%A8%8B%E5%8D%B71%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html"/>
    <id>https://linweiyuan.github.io/2022/05/01/Java%E9%AB%98%E5%B9%B6%E5%8F%91%E6%A0%B8%E5%BF%83%E7%BC%96%E7%A8%8B%E5%8D%B71%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html</id>
    <published>2022-05-01T04:13:20.000Z</published>
    <updated>2022-10-04T11:01:19.597Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Netty"><a href="#Netty" class="headerlink" title="Netty"></a>Netty</h1><h2 id="åŸºæœ¬ç»„ä»¶"><a href="#åŸºæœ¬ç»„ä»¶" class="headerlink" title="åŸºæœ¬ç»„ä»¶"></a>åŸºæœ¬ç»„ä»¶</h2><ul><li>Channel</li><li>Reactor</li><li>Handler</li><li>Pipelineï¼ˆåŒå‘é“¾è¡¨ï¼‰</li><li>EventLoopGroup</li><li>parentGroup: è´Ÿè´£æ–°è¿æ¥çš„ç›‘å¬å’Œæ¥æ”¶</li><li>childGroupï¼šè´Ÿè´£ IO äº‹ä»¶çš„è½®è¯¢å’Œåˆ†å‘<br>å¦‚æœä¸åˆ†å¼€ parent å’Œ child,åˆ™ä¼šå¸¦æ¥ä¸€ä¸ªé£é™©ï¼šæ–°è¿æ¥çš„æ¥æ”¶è¢«æ›´åŠ è€—æ—¶çš„æ•°æ®ä¼ è¾“æˆ–ä¸šåŠ¡å¤„ç†æ‰€é˜»å¡</li><li>ChannelOption</li></ul><h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><ul><li>API ä½¿ç”¨èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œé™ä½äº†å¼€å‘é—¨æ§›</li><li>å¯¹å¤šç§ä¸»æµåè®®éƒ½æœ‰å¾ˆå¥½çš„æ”¯æŒï¼ˆç¼–è§£ç åŠŸèƒ½ï¼‰</li><li>æ”¯æŒè‡ªå®šä¹‰é…ç½®ï¼Œé€šè¿‡ ChannelHandler å¯ä»¥çµæ´»åœ°æ‰©å±•é€šä¿¡æ¡†æ¶</li><li>å…¶ä»–ä¸šç•Œä¸»æµçš„ NIO æ¡†æ¶ç›¸æ¯”ï¼ŒNetty çš„ç»¼åˆæ€§èƒ½æœ€ä¼˜ï¼ˆè°å‡ºä¹¦éƒ½ä¼šè¯´è‡ªå·±çš„å¥½ï¼‰</li><li>æˆç†Ÿç¨³å®šï¼ŒNetty ä¿®å¤äº†åœ¨ JDK NIO ä¸­æ‰€æœ‰å·²å‘ç°çš„ bugï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“æœ‰ä»€ä¹ˆ bugï¼‰</li><li>æœ‰æ´»è·ƒçš„ç¤¾åŒºï¼Œç‰ˆæœ¬è¿­ä»£å‘¨æœŸçŸ­ï¼Œbug ä¿®å¤åŠæ—¶</li></ul><h1 id="ZooKeeper"><a href="#ZooKeeper" class="headerlink" title="ZooKeeper"></a>ZooKeeper</h1><p>æ ¸å¿ƒä¼˜åŠ¿å°±æ˜¯è§£å†³äº†åˆ†å¸ƒå¼ç¯å¢ƒçš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼Œæ¯æ—¶æ¯åˆ»è®¿é—® ZooKeeper çš„æ ‘ç»“æ„æ—¶ï¼Œè¿”å›çš„æ•°æ®éƒ½æ˜¯ä¸€è‡´çš„ï¼Œä¸ä¼šå¼•èµ·è„è¯»ã€å¹»è¯»ã€ä¸å¯é‡å¤è¯»</p><h1 id="è„è¯»ã€å¹»è¯»ã€ä¸å¯é‡å¤è¯»"><a href="#è„è¯»ã€å¹»è¯»ã€ä¸å¯é‡å¤è¯»" class="headerlink" title="è„è¯»ã€å¹»è¯»ã€ä¸å¯é‡å¤è¯»"></a>è„è¯»ã€å¹»è¯»ã€ä¸å¯é‡å¤è¯»</h1><ul><li>è„è¯»ï¼šä¸€ä¸ªäº‹åŠ¡ä¸­è®¿é—®åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ®</li><li>å¹»è¯»ï¼šå½“ä¸¤ä¸ªå®Œå…¨ç›¸åŒçš„æŸ¥è¯¢æ‰§è¡Œæ—¶ï¼Œä¸¤æ¬¡è¿”å›çš„ç»“æœé›†ä¸ä¸€æ ·ï¼ŒåŸå› å¦ä¸€ä¸ªäº‹åŠ¡æ–°å¢æˆ–åˆ é™¤äº†ç¬¬ä¸€ä¸ªäº‹åŠ¡çš„ç»“æœé›†ä¸­çš„æ•°æ®</li><li>ä¸å¯é‡å¤è¯»ï¼šåœ¨ä¸€ä¸ªäº‹åŠ¡å†…æ ¹æ®åŒä¸€ä¸ªæ¡ä»¶å¯¹æ•°æ®è¿›è¡Œå¤šæ¬¡æŸ¥è¯¢ï¼Œè¿”å›çš„ç»“æœä¸ä¸€è‡´ï¼ŒåŸå› æ˜¯å…¶ä»–äº‹åŠ¡å¯¹æ•°æ®è¿›è¡Œäº†ä¿®æ”¹</li></ul><p>ä¸å¯é‡å¤è¯»å’Œå¹»è¯»çš„åŒºåˆ«ï¼š</p><p>ä¸å¯é‡å¤è¯»å…³å¿ƒçš„æ˜¯è®°å½•çš„æ›´æ–°æ“ä½œï¼Œå¯¹åŒæ ·çš„è®°å½•ï¼Œå†æ¬¡è¯»å–æ•°æ®å‘ç”Ÿå˜åŒ–</p><p>å¹»è¯»å…³æ³¨çš„æ˜¯è®°å½•çš„å¢åˆ æ“ä½œï¼Œæ¡æ•°å‘ç”Ÿäº†å˜åŒ–</p><h1 id="é«˜å¹¶å‘ç¯å¢ƒä¸‹çš„æ¥å…¥å±‚"><a href="#é«˜å¹¶å‘ç¯å¢ƒä¸‹çš„æ¥å…¥å±‚" class="headerlink" title="é«˜å¹¶å‘ç¯å¢ƒä¸‹çš„æ¥å…¥å±‚"></a>é«˜å¹¶å‘ç¯å¢ƒä¸‹çš„æ¥å…¥å±‚</h1><p>ç½‘å…³ä¸å¤–ä¹å®Œæˆä»¥ä¸‹å·¥ä½œï¼š</p><ul><li>é‰´æƒ</li><li>é™æµ</li><li>åå‘ä»£ç†</li><li>è´Ÿè½½å‡è¡¡</li></ul><h1 id="æ“ä½œç³»ç»Ÿ"><a href="#æ“ä½œç³»ç»Ÿ" class="headerlink" title="æ“ä½œç³»ç»Ÿ"></a>æ“ä½œç³»ç»Ÿ</h1><p>å°†å†…å­˜åˆ’åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå†…æ ¸æ¨¡å—è¿è¡Œåœ¨å†…æ ¸ç©ºé—´ï¼Œå¯¹åº”çš„è¿›ç¨‹å¤„äºå†…æ ¸æ€ï¼›ç”¨æˆ·ç¨‹åºè¿è¡Œåœ¨ç”¨æˆ·ç©ºé—´ï¼Œå¯¹åº”çš„è¿›ç¨‹å¤„äºç”¨æˆ·æ€</p><p>IO è¯»å†™ï¼š</p><p>ä¸Šå±‚åº”ç”¨é€šè¿‡æ“ä½œç³»ç»Ÿçš„ read ç³»ç»Ÿè°ƒç”¨ï¼ŒæŠŠæ•°æ®ä»å†…æ ¸ç¼“å†²åŒºå¤åˆ¶åˆ°åº”ç”¨ç¨‹åºçš„è¿›ç¨‹ç¼“å†²åŒºï¼Œé€šè¿‡æ“ä½œç³»ç»Ÿçš„ write ç³»ç»Ÿè°ƒç”¨ï¼ŒæŠŠæ•°æ®ä»åº”ç”¨ç¨‹åºçš„è¿›ç¨‹ç¼“å†²åŒºå¤åˆ¶åˆ°æ“ä½œç³»ç»Ÿçš„å†…æ ¸ç¼“å†²åŒº</p><p>é‚£ä¹ˆä¸ºä»€ä¹ˆè¦è®¾ç½®ç¼“å†²åŒºå‘¢ï¼Ÿ</p><p>æ˜¯ä¸ºäº†å‡å°‘è®¾å¤‡ä¹‹é—´çš„é¢‘ç¹ç‰©ç†äº¤æ¢ï¼Œå› ä¸ºå¤–éƒ¨ç‰©ç†è®¾å¤‡ä¸å†…å­˜å’Œ CPU ç›¸æ¯”ï¼Œæœ‰ç€éå¸¸å¤§çš„å·®è·</p><h1 id="å››ç§ä¸»è¦çš„-IO-æ¨¡å‹"><a href="#å››ç§ä¸»è¦çš„-IO-æ¨¡å‹" class="headerlink" title="å››ç§ä¸»è¦çš„ IO æ¨¡å‹"></a>å››ç§ä¸»è¦çš„ IO æ¨¡å‹</h1><p>é˜»å¡ IO æŒ‡çš„æ˜¯ï¼Œéœ€è¦å†…æ ¸ IO æ“ä½œå½»åº•å®Œæˆåï¼Œæ‰è¿”å›ç”¨æˆ·ç©ºé—´æ‰§è¡Œç”¨æˆ·ç¨‹åºçš„æ“ä½œæŒ‡ä»¤ï¼Œéé˜»å¡åˆ™æ— éœ€ç­‰å¾…</p><p>åŒæ­¥æŒ‡çš„æ˜¯ç”¨æˆ·ç©ºé—´ï¼ˆè¿›ç¨‹æˆ–çº¿ç¨‹ï¼‰æ˜¯ä¸»åŠ¨å‘èµ· IO è¯·æ±‚çš„ä¸€æ–¹ï¼Œç³»ç»Ÿå†…æ ¸æ˜¯è¢«åŠ¨æ¥æ”¶æ–¹ï¼›å¼‚æ­¥ IO åˆ™åè¿‡æ¥</p><ul><li>åŒæ­¥é˜»å¡ IOï¼šç”¨æˆ·ç©ºé—´ä¸»åŠ¨å‘èµ·ï¼Œéœ€è¦ç­‰å¾…å†…æ ¸ IO æ“ä½œå½»åº•å®Œæˆåï¼Œæ‰è¿”å›åˆ°ç”¨æˆ·ç©ºé—´çš„ IO æ“ä½œ<ul><li>ä¼˜ç‚¹ï¼šåº”ç”¨ç¨‹åºå¼€å‘éå¸¸ç®€å•ï¼Œåœ¨é˜»å¡ç­‰å¾…æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·çº¿ç¨‹æŒ‚èµ·ï¼ŒåŸºæœ¬ä¸ä¼šå ç”¨ CPU èµ„æº</li><li>ç¼ºç‚¹ï¼šä¸€èˆ¬æƒ…å†µä¸‹ä¼šä¸ºæ¯ä¸ªè¿æ¥é…å¤‡ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ï¼Œé«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œéœ€è¦å¤§é‡çº¿ç¨‹ï¼Œå†…å­˜å’Œçº¿ç¨‹åˆ‡æ¢å¼€é”€ä¼šéå¸¸å¤§</li></ul></li><li>åŒæ­¥éé˜»å¡ IOï¼šç”¨æˆ·ç©ºé—´å‘èµ·ï¼Œä¸éœ€è¦ç­‰å¾…å†…æ ¸ IO æ“ä½œå½»åº•å®Œæˆï¼Œå°±å¯ä»¥ç«‹å³è¿”å›ç”¨æˆ·ç©ºé—´å»æ‰§è¡Œåç»­çš„æŒ‡ä»¤ï¼ˆè¿™ä¸ªä¹Ÿå« NIOï¼Œä½†æ˜¯å’Œ Java é‡Œé¢çš„ NIO æœ‰åŒºåˆ«ï¼ŒJava é‡Œçš„ NIO æŒ‡çš„æ˜¯ NewIOï¼Œç”¨çš„æ˜¯ IO å¤šè·¯å¤ç”¨æ¨¡å‹ï¼‰ï¼Œç‰¹ç‚¹æ˜¯éœ€è¦ä¸æ–­è¿›è¡Œè½®è¯¢<ul><li>ä¼˜ç‚¹ï¼šçº¿ç¨‹ä¸ä¼šé˜»å¡ï¼Œå®æ—¶æ€§è¾ƒå¥½</li><li>ç¼ºç‚¹ï¼šéœ€è¦ä¸æ–­è½®è¯¢ï¼Œå ç”¨ CPU èµ„æºï¼Œæ•ˆç‡ä½ä¸‹</li></ul></li><li>IO å¤šè·¯å¤ç”¨ï¼šåœ¨ Linux ç³»ç»Ÿä¸­ï¼ŒIO å¤šè·¯å¤ç”¨çš„ç³»ç»Ÿè°ƒç”¨ä¸º select&#x2F;epollï¼Œé€šè¿‡è¯¥ç³»ç»Ÿè°ƒç”¨ï¼Œä¸€ä¸ªç”¨æˆ·è¿›ç¨‹ï¼ˆæˆ–çº¿ç¨‹ï¼‰å¯ä»¥ç›‘è§†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œä¸€æ—¦æŸä¸ªæ–‡ä»¶æè¿°ç¬¦å°±ç»ªï¼ˆä¸€èˆ¬æ˜¯æŒ‡å†…æ ¸ç¼“å†²åŒºå¯è¯»&#x2F;å¯å†™ï¼‰ï¼Œå†…æ ¸å°±èƒ½å¤Ÿå°†æ–‡ä»¶æè¿°ç¬¦çš„å°±ç»ªçŠ¶æ€è¿”å›ç»™ç”¨æˆ·è¿›ç¨‹ï¼ˆæˆ–çº¿ç¨‹ï¼‰ï¼Œç”¨æˆ·ç©ºé—´å°±å¯ä»¥æ ¹æ®æ–‡ä»¶æè¿°ç¬¦çš„å°±ç»ªçŠ¶æ€è¿›è¡Œå¯¹åº”çš„ IO ç³»ç»Ÿè°ƒç”¨ï¼ˆReactorï¼‰<ul><li>ä¼˜ç‚¹ï¼šä¸€ä¸ªé€‰æ‹©å™¨æŸ¥è¯¢çº¿ç¨‹å¯ä»¥åŒæ—¶å¤„ç†æˆåƒä¸Šä¸‡çš„ç½‘ç»œè¿æ¥ï¼Œä¸å¿…åˆ›å»ºå¤§é‡çš„çº¿ç¨‹</li><li>ç¼ºç‚¹ï¼šselect&#x2F;epoll ç³»ç»Ÿè°ƒç”¨æ˜¯é˜»å¡çš„ï¼Œå±äºåŒæ­¥ IO</li></ul></li><li>å¼‚æ­¥ IOï¼šæŒ‡çš„æ˜¯ç”¨æˆ·ç©ºé—´çš„çº¿ç¨‹å˜æˆè¢«åŠ¨æ¥æ”¶è€…ï¼Œè€Œå†…æ ¸ç©ºé—´æˆä¸ºä¸»åŠ¨è°ƒç”¨è€…ï¼›ç”¨æˆ·çº¿ç¨‹é€šè¿‡ç³»ç»Ÿè°ƒç”¨å‘å†…æ ¸æ³¨å†ŒæŸä¸ª IO æ“ä½œï¼Œå†…æ ¸åœ¨è¿™ä¸ª IO æ“ä½œå®Œæˆåé€šçŸ¥ç”¨æˆ·ç¨‹åºï¼Œç”¨æˆ·ç¨‹åºæ‰§è¡Œåç»­çš„ä¸šåŠ¡æ“ä½œï¼ˆå›è°ƒï¼‰<ul><li>ä¼˜ç‚¹ï¼šéé˜»å¡</li><li>ç¼ºç‚¹ï¼šåº”ç”¨ç¨‹åºä»…éœ€è¦è¿›è¡Œäº‹ä»¶çš„æ³¨å†Œå’Œæ¥æ”¶ï¼Œå…¶ä½™çš„å·¥ä½œéƒ½ç•™ç»™äº†æ“ä½œç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯éœ€è¦åº•å±‚å†…æ ¸æä¾›æ”¯æŒ</li></ul></li></ul><h1 id="è¿æ¥æé™å€¼"><a href="#è¿æ¥æé™å€¼" class="headerlink" title="è¿æ¥æé™å€¼"></a>è¿æ¥æé™å€¼</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ulimit</span> -n 1000000ï¼ˆé»˜è®¤ 1024ï¼‰</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ulimit</span> -SHnï¼ˆS è½¯æ€§æé™å€¼ï¼Œè¶…è¿‡è­¦å‘Šï¼›H ç¡¬æ€§æé™å€¼ï¼Œè¶…è¿‡æŠ¥é”™ï¼‰</span><br></pre></td></tr></table></figure><p>å¦‚ä½•å½»åº•è§£é™¤é™åˆ¶ï¼Ÿ</p><p>ç¼–è¾‘æ–‡ä»¶ <code>/etc/security/limits.conf</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">soft nofile 1000000</span><br><span class="line">hard nofile 1000000</span><br></pre></td></tr></table></figure><h1 id="Java-NIO"><a href="#Java-NIO" class="headerlink" title="Java NIO"></a>Java NIO</h1><h2 id="åŸºæœ¬ç»„ä»¶-1"><a href="#åŸºæœ¬ç»„ä»¶-1" class="headerlink" title="åŸºæœ¬ç»„ä»¶"></a>åŸºæœ¬ç»„ä»¶</h2><ul><li>Channel</li><li>Buffer</li><li>Selector</li></ul><h2 id="OIO-å’Œ-NIO-çš„åŒºåˆ«"><a href="#OIO-å’Œ-NIO-çš„åŒºåˆ«" class="headerlink" title="OIO å’Œ NIO çš„åŒºåˆ«"></a>OIO å’Œ NIO çš„åŒºåˆ«</h2><ul><li>OIOï¼ˆOld IOï¼‰ é¢å‘æµï¼ŒNIOï¼ˆNew IOï¼‰é¢å‘ç¼“å­˜åŒº</li><li>OIO æ˜¯é˜»å¡çš„ï¼ŒNIO éé˜»å¡</li><li>OIO æ²¡æœ‰ Selector æ¦‚å¿µï¼ŒNIO æœ‰</li></ul><h1 id="NIO-Buffer"><a href="#NIO-Buffer" class="headerlink" title="NIO Buffer"></a>NIO Buffer</h1><h2 id="å¸¸ç”¨æ–¹æ³•"><a href="#å¸¸ç”¨æ–¹æ³•" class="headerlink" title="å¸¸ç”¨æ–¹æ³•"></a>å¸¸ç”¨æ–¹æ³•</h2><ul><li><p>allocate(int capacity)ï¼š é»˜è®¤æ˜¯å†™æ¨¡å¼ï¼Œä»æ•°ç»„ä¸‹æ ‡ 0 å¼€å§‹ï¼Œé•¿åº¦é™åˆ¶æ˜¯ capacity</p></li><li><p>put(int i)ï¼šå†™ i è¿›æ•°ç»„é‡Œï¼Œå¦‚æœè¶…è¿‡é•¿åº¦ï¼Œåˆ™æŠ›å‡º BufferOverflowExceptionï¼ˆå¯ä½¿ç”¨ remaining() æ¥åˆ¤æ–­å‰©ä½™å¯å†™é•¿åº¦ï¼›å¦‚æœæ˜¯è¯»æ¨¡å¼ï¼Œåˆ™æŠ›å‡º ReadOnlyBufferExceptionï¼ˆå¯ä½¿ç”¨ isReadOnly() æ¥åˆ¤æ–­æ˜¯å¦å¯å†™ï¼‰</p></li><li><p>filp()ï¼šè¯»å†™æ¨¡å¼è½¬æ¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Buffer <span class="title function_">flip</span><span class="params">()</span> &#123;</span><br><span class="line">    limit = position;</span><br><span class="line">    position = <span class="number">0</span>;</span><br><span class="line">    mark = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>get()</p></li><li><p>rewind()ï¼šå€’å¸¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Buffer <span class="title function_">rewind</span><span class="params">()</span> &#123;</span><br><span class="line">    position = <span class="number">0</span>;</span><br><span class="line">    mark = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>flip() å’Œ rewind() çš„åŒºåˆ«å°±æ˜¯ limit å‚æ•°</p></li><li><p>mark() å’Œ reset(): mark() æ ‡è®°å½“å‰ä½ç½®ï¼Œå½“è°ƒç”¨ reset() çš„æ—¶å€™ï¼Œå›åˆ°æ ‡è®°çš„ä½ç½®</p></li><li><p>clear()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Buffer <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">    position = <span class="number">0</span>;</span><br><span class="line">    limit = capacity;</span><br><span class="line">    mark = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>ä½¿ç”¨ clear() æˆ–è€… compact() å¯ä»¥å°†è¯»æ¨¡å¼æ”¹ä¸ºå†™æ¨¡å¼</p><h2 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h2><p>allocate() -&gt; put() -&gt; flip() -&gt; get() -&gt; clear() &#x2F; compoact() -&gt; put()</p><h2 id="ç”³è¯·å†…å­˜çš„ä¸¤ç§æ–¹å¼"><a href="#ç”³è¯·å†…å­˜çš„ä¸¤ç§æ–¹å¼" class="headerlink" title="ç”³è¯·å†…å­˜çš„ä¸¤ç§æ–¹å¼"></a>ç”³è¯·å†…å­˜çš„ä¸¤ç§æ–¹å¼</h2><p>ç”³è¯·å †å†…å­˜ï¼Œè¯»å†™æ•ˆç‡è¾ƒä½ï¼Œå—åˆ° GC å½±å“</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ByteBuffer.allocate() -&gt; java.nio.HeapByteBuffer</span><br></pre></td></tr></table></figure><p>ç”³è¯·ç›´æ¥å†…å­˜ï¼Œè¯»å†™æ•ˆç‡é«˜ï¼ˆå°‘ä¸€æ¬¡æ‹·è´ï¼‰ï¼Œä¸ä¼šå—åˆ° GC å½±å“ï¼Œåˆ†é…å†…å­˜çš„æ—¶å€™æ•ˆç‡ä½ï¼Œä½¿ç”¨ä¸å½“å¯èƒ½é€ æˆå†…å­˜æ³„æ¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ByteBuffer.allocateDirect() -&gt; java.nio.DirectByteBuffer</span><br></pre></td></tr></table></figure><h1 id="NIO-Channels"><a href="#NIO-Channels" class="headerlink" title="NIO Channels"></a>NIO Channels</h1><h2 id="å¸¸ç”¨-Channel"><a href="#å¸¸ç”¨-Channel" class="headerlink" title="å¸¸ç”¨ Channel"></a>å¸¸ç”¨ Channel</h2><ul><li>FileChannel</li><li>(FileInputStream() &#x2F; FileOutputStream()).geChannel(), ByteBuffer.flip(), channel.force(true), channel.close()</li><li>transferTo(position, length, target)ï¼šé›¶æ‹·è´, æ¯æ¬¡ 2G ä¸Šé™</li><li>ServerSocketChannel</li><li>SocketChannel</li><li>socketChannel.configureBlocking(true &#x2F; false)ï¼Œé»˜è®¤æ˜¯ blocking, å› ä¸ºæœ‰ä¸ªå±æ€§è®¾ç½® nonBlocking ä¸º false</li><li>DatagramChannael</li></ul><h1 id="NIO-Selector"><a href="#NIO-Selector" class="headerlink" title="NIO Selector"></a>NIO Selector</h1><p>é€‰æ‹©å™¨çš„ä½¿å‘½æ˜¯å¤„ç† IO çš„å¤šè·¯å¤ç”¨ï¼Œå®Œæˆé€šé“çš„æ³¨å†Œï¼Œç›‘å¬ï¼Œäº‹ä»¶æŸ¥è¯¢</p><p>é€‰æ‹©å™¨å’Œé€šé“çš„å…³ç³»æ˜¯ç›‘æ§å’Œè¢«ç›‘æ§çš„å…³ç³»</p><h2 id="IO-äº‹ä»¶ç±»å‹"><a href="#IO-äº‹ä»¶ç±»å‹" class="headerlink" title="IO äº‹ä»¶ç±»å‹"></a>IO äº‹ä»¶ç±»å‹</h2><ul><li>SelectionKey.OP_READ</li><li>SelectionKey.OP_WRITE</li><li>SelectionKey.OP_CONNECT</li><li>SelectionKey.OP_ACCEPT</li></ul><h2 id="SelectionKey"><a href="#SelectionKey" class="headerlink" title="SelectionKey"></a>SelectionKey</h2><p>å¦‚ä½•çŸ¥é“ä¸€ä¸ª Channel æ˜¯å¦èƒ½è¢«ç›‘æµ‹ï¼Ÿ</p><p>çœ‹è¿™ä¸ª Channel æ˜¯å¦ç›´æ¥æˆ–é—´æ¥ç»§æ‰¿ SelectableChannelï¼Œæ¯”å¦‚ FileChannel å°±ä¸æ˜¯ï¼Œè€Œ SocketChannel å°±æ˜¯</p><p>æ³¨å†Œåˆ° Selector çš„ Channel å¿…é¡»æ˜¯å¤„äºéé˜»å¡æ¨¡å¼ä¸‹ï¼Œå› ä¸º FileChannel åªæœ‰é˜»å¡æ¨¡å¼ï¼Œä¸èƒ½åˆ‡æ¢åˆ°éé˜»å¡æ¨¡å¼ï¼Œæ‰€ä»¥ FileChannel ä¸èƒ½å’Œé€‰æ‹©å™¨ä¸€èµ·ä½¿ç”¨</p><p>Selector.select() æœ¬èº«æ˜¯é˜»å¡çš„ï¼Œæ‰€ä»¥æ”¾åœ¨ while true é‡Œä¸ç”¨æ‹…å¿ƒ CPU ç©ºè½¬</p><h1 id="Reactor-æ¨¡å¼"><a href="#Reactor-æ¨¡å¼" class="headerlink" title="Reactor æ¨¡å¼"></a>Reactor æ¨¡å¼</h1><p>Reactor æ¨¡å¼ç”± Reactor çº¿ç¨‹ï¼ŒHandlers å¤„ç†å™¨ä¸¤å¤§è§’è‰²ç»„æˆ</p><ul><li>Reactor çº¿ç¨‹ï¼šè´Ÿè´£å“åº” IO äº‹ä»¶ï¼Œå¹¶ä¸”åˆ†å‘åˆ° Handlers å¤„ç†å™¨</li><li>Handlers å¤„ç†å™¨ï¼šéé˜»å¡åœ°æ‰§è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†</li></ul><h2 id="æ‰§è¡Œæµç¨‹"><a href="#æ‰§è¡Œæµç¨‹" class="headerlink" title="æ‰§è¡Œæµç¨‹"></a>æ‰§è¡Œæµç¨‹</h2><p>channel -&gt; selector -&gt; reactor -&gt; handler</p><h2 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><ul><li>å“åº”é€Ÿåº¦å¿«ï¼Œè™½ç„¶åŒä¸€ Reactor çº¿ç¨‹æœ¬èº«æ˜¯åŒæ­¥çš„ï¼Œä½†æ˜¯ä¸ä¼šè¢«å•ä¸ªè¿æ¥çš„ IO æ“ä½œæ‰€é˜»å¡</li><li>é¿å…äº†å¤šçº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹ä¹‹å‰é¢‘ç¹åˆ‡æ¢çš„å¼€é”€</li><li>é€šè¿‡å¢åŠ  Reactor çº¿ç¨‹çš„ä¸ªæ•°ï¼Œå¯ä»¥è¿›è¡Œçµæ´»æ‰©å±•ï¼Œå……åˆ†åˆ©ç”¨ CPU èµ„æº</li></ul><h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h2><ul><li>æ¯æ¬¡å¼•å…¥æ–°ä¸œè¥¿è‚¯å®šæ˜¯å¢åŠ äº†åŸç³»ç»Ÿçš„å¤æ‚æ€§</li><li>éœ€è¦æ“ä½œç³»ç»Ÿåº•å±‚æ”¯æŒ IO å¤šè·¯å¤ç”¨ç³»ç»Ÿè°ƒç”¨æ‰å¯ä»¥</li></ul><h1 id="ä¸ºä»€ä¹ˆåœ¨æµ·é‡è¿æ¥çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æ± çš„æ–¹å¼ä¸å¥½ä½¿"><a href="#ä¸ºä»€ä¹ˆåœ¨æµ·é‡è¿æ¥çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æ± çš„æ–¹å¼ä¸å¥½ä½¿" class="headerlink" title="ä¸ºä»€ä¹ˆåœ¨æµ·é‡è¿æ¥çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æ± çš„æ–¹å¼ä¸å¥½ä½¿"></a>ä¸ºä»€ä¹ˆåœ¨æµ·é‡è¿æ¥çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æ± çš„æ–¹å¼ä¸å¥½ä½¿</h1><ul><li>çº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯æˆæœ¬å¾ˆé«˜</li><li>çº¿ç¨‹æœ¬èº«å ç”¨è¾ƒå¤§å†…å­˜ï¼ŒJava çº¿ç¨‹æ ˆå†…å­˜åˆ†é… <code>512K - 1M</code></li><li>çº¿ç¨‹åˆ‡æ¢çš„æˆæœ¬å¾ˆé«˜ï¼Œå› ä¸ºéœ€è¦ä¿å­˜ä¸Šä¸‹æ–‡ï¼Œå¦‚æœçº¿ç¨‹åˆ‡æ¢çš„æ—¶é—´æ¯”çº¿ç¨‹æœ¬èº«æ‰§è¡Œæ‰€éœ€è¦çš„æ—¶é—´è¿˜å¤šï¼Œå°±æ˜¯è´Ÿä¼˜åŒ–</li></ul><h1 id="åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#åºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h1><ul><li>æ•°æ®ç»“æ„å¤§å°ï¼šåŸåˆ™ä¸Šï¼Œè¶Šå°ï¼Œæ•ˆç‡è¶Šé«˜</li><li>ç»“æ„å¤æ‚åº¦ï¼šè¶Šå¤æ‚ï¼Œæ•ˆç‡è¶Šä½</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Netty&quot;&gt;&lt;a href=&quot;#Netty&quot; class=&quot;headerlink&quot; title=&quot;Netty&quot;&gt;&lt;/a&gt;Netty&lt;/h1&gt;&lt;h2 id=&quot;åŸºæœ¬ç»„ä»¶&quot;&gt;&lt;a href=&quot;#åŸºæœ¬ç»„ä»¶&quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬ç»„ä»¶&quot;</summary>
      
    
    
    
    <category term="ç¨‹åºè®¾è®¡" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    
    
    <category term="Java" scheme="https://linweiyuan.github.io/tags/Java/"/>
    
    <category term="Netty" scheme="https://linweiyuan.github.io/tags/Netty/"/>
    
    <category term="NIO" scheme="https://linweiyuan.github.io/tags/NIO/"/>
    
  </entry>
  
  <entry>
    <title>Arch Linuxç®€æ˜“å®‰è£…è„šæœ¬ï¼ˆi3, kde, deepinï¼‰</title>
    <link href="https://linweiyuan.github.io/2022/04/08/Arch-Linux%E7%AE%80%E6%98%93%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC%EF%BC%88i3-kde-deepin%EF%BC%89.html"/>
    <id>https://linweiyuan.github.io/2022/04/08/Arch-Linux%E7%AE%80%E6%98%93%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC%EF%BC%88i3-kde-deepin%EF%BC%89.html</id>
    <published>2022-04-08T04:19:56.000Z</published>
    <updated>2022-10-04T11:01:19.593Z</updated>
    
    <content type="html"><![CDATA[<p>è„šæœ¬ï¼š<a href="https://github.com/linweiyuan/archlinux-install-script">https://github.com/linweiyuan/archlinux-install-script</a><br>todo: å¼‚å¸¸åˆ¤æ–­ï¼Œé€‰é¡¹æ”¹ whiptail</p><p>åŒ…ç¼“å­˜ï¼šflexo</p><p>å†…ç½‘ dnsï¼šdnsmasq</p><div class="video"><iframe src="//player.bilibili.com/player.html?aid=603487924&bvid=BV1VB4y177EU&cid=842532702&page=1&high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è„šæœ¬ï¼š&lt;a href=&quot;https://github.com/linweiyuan/archlinux-install-script&quot;&gt;https://github.com/linweiyuan/archlinux-install-script&lt;/a&gt;&lt;br&gt;todo: å¼‚</summary>
      
    
    
    
    <category term="æ“ä½œç³»ç»Ÿ" scheme="https://linweiyuan.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
    <category term="Arch Linux" scheme="https://linweiyuan.github.io/tags/Arch-Linux/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºJDK18çš„UTF-8</title>
    <link href="https://linweiyuan.github.io/2022/03/24/%E5%85%B3%E4%BA%8EJDK18%E7%9A%84UTF-8.html"/>
    <id>https://linweiyuan.github.io/2022/03/24/%E5%85%B3%E4%BA%8EJDK18%E7%9A%84UTF-8.html</id>
    <published>2022-03-24T07:07:34.000Z</published>
    <updated>2022-10-04T11:01:19.597Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JEP-400-UTF-8-by-Default"><a href="#JEP-400-UTF-8-by-Default" class="headerlink" title="JEP 400: UTF-8 by Default"></a>JEP 400: UTF-8 by Default</h1><p>JDK18 é‡Œæœ‰ä¸€é¡¹æ”¹è¿›å«ï¼š<a href="https://openjdk.org/jeps/400">JEP 400: UTF-8 by Default</a></p><p>å…¶å®æ˜¯å°†é»˜è®¤å­—ç¬¦é›†æ”¹ä¸º UTF-8ï¼Œåªæ˜¯ Charset.defaultCharset() è¿”å› UTF-8ï¼Œåœ¨è¿™ä¹‹å‰çš„ JDK ç‰ˆæœ¬ä¸­ï¼Œè¿”å›çš„å­—ç¬¦é›†æ ¹æ®æ“ä½œç³»ç»Ÿçš„ä¸åŒä¼šä¸ä¸€æ ·ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´ä¹±ç ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–¹æ³•çš„æ³¨é‡Š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Returns the <span class="keyword">default</span> charset of <span class="built_in">this</span> Java virtual machine.</span><br><span class="line"></span><br><span class="line">The <span class="keyword">default</span> charset is UTF-<span class="number">8</span>, unless changed in an implementation specific manner.</span><br></pre></td></tr></table></figure><p>ä¹‹å‰çš„ç‰ˆæœ¬åªæœ‰è¿™ä¸€è¡Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Returns the <span class="keyword">default</span> charset of <span class="built_in">this</span> Java virtual machine.</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å¹¶ä¸æ˜¯æ”¹äº† String çš„å®ç°</p><h1 id="JEP-254-Compact-Strings"><a href="#JEP-254-Compact-Strings" class="headerlink" title="JEP 254: Compact Strings"></a>JEP 254: Compact Strings</h1><p>Java ä¸­çš„ String é»˜è®¤é‡‡ç”¨ UTF-16 å­—ç¬¦é›†ï¼Œè¿™å…¶å®æ˜¯å†å²çš„åŒ…è¢±ï¼Œä¸ºäº†è¦æ”¯æŒæ–°ç‰ˆæœ¬çš„ Unicodeï¼Œåˆè¦ä¿è¯å‘åå…¼å®¹ï¼Œå› ä¸ºè°ä¹Ÿæƒ³ä¸åˆ°è®¡ç®—æœºçš„å‘å±•æ˜¯å¦‚æ­¤è¿…çŒ›ï¼Œå½“æ—¶æ˜¯è¶³å¤Ÿç”¨äº†</p><p>å¦‚ä»Šç”¨äº† UTF-16ï¼Œå¯ä»¥å­˜å¤§éƒ¨åˆ†è¾…åŠ©å­—ç¬¦ï¼ˆEmoji ç­‰ï¼‰äº†ï¼Œä½†æ˜¯å¯¹äºè¥¿æ–¹å›½å®¶ï¼Œæ—¥å¸¸çš„ç®€å•å­—æ¯ï¼Œæœ‰ç‚¹æµªè´¹</p><p>å› æ­¤ JDK9 è¿›è¡Œäº†æ”¹åŠ¨ï¼Œå°†åº•å±‚ char[] æ”¹ä¸º byte[]ï¼Œå¹¶ä¸”åœ¨åŸæœ‰åŸºç¡€ä¸ŠåŠ å…¥äº† Latin-1ï¼ˆISO-8859-1ï¼‰å­—ç¬¦é›†ï¼Œè¯¦ç»†å¯ä»¥çœ‹è¿™ä¸ª JEPï¼š<a href="https://openjdk.org/jeps/254">JEP 254: Compact Strings</a></p><p>String(UTF-16 + Latin-1)ï¼Œå…¶ä¸­å†…éƒ¨å¤šäº†ä¸ªå­—æ®µ coder</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="type">byte</span> coder;</span><br></pre></td></tr></table></figure><p>å½“æ— æ³•ç”¨ Latin-1 è¡¨ç¤ºçš„æ—¶å€™ï¼Œæ‰ä½¿ç”¨ UTF-16ï¼Œå‡å°‘äº†å†…å­˜çš„æµªè´¹</p><p>æ‰€ä»¥ JEP 400 å’Œ String æœ¬èº«çš„å®ç°å…³ç³»ä¸å¤§</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;JEP-400-UTF-8-by-Default&quot;&gt;&lt;a href=&quot;#JEP-400-UTF-8-by-Default&quot; class=&quot;headerlink&quot; title=&quot;JEP 400: UTF-8 by Default&quot;&gt;&lt;/a&gt;JEP 400: UTF-</summary>
      
    
    
    
    <category term="ç¨‹åºè®¾è®¡" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    
    
    <category term="Java" scheme="https://linweiyuan.github.io/tags/Java/"/>
    
    <category term="JDK18" scheme="https://linweiyuan.github.io/tags/JDK18/"/>
    
  </entry>
  
  <entry>
    <title>ELKç›¸å…³çŸ¥è¯†ç‚¹</title>
    <link href="https://linweiyuan.github.io/2022/03/04/ELK%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9.html"/>
    <id>https://linweiyuan.github.io/2022/03/04/ELK%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9.html</id>
    <published>2022-03-04T09:19:10.000Z</published>
    <updated>2022-10-04T11:01:19.593Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ELK"><a href="#ELK" class="headerlink" title="ELK"></a>ELK</h1><p>ä½•ä¸º ELKï¼ŒElasticsearch + Logstach + Kibaba</p><ul><li>Elasticsearchï¼šå­˜å‚¨ï¼Œè®¡ç®—ï¼Œæœç´¢æ•°æ®</li><li>Logstashï¼šæ•°æ®æŠ“å–</li><li>Kibabaï¼šæ•°æ®å¯è§†åŒ–</li></ul><h1 id="å€’æ’ç´¢å¼•"><a href="#å€’æ’ç´¢å¼•" class="headerlink" title="å€’æ’ç´¢å¼•"></a>å€’æ’ç´¢å¼•</h1><p>è¦è¯´å€’æ’ç´¢å¼•ï¼Œé¦–å…ˆè¦ä»æ­£å‘ç´¢å¼•è°ˆèµ·ï¼Œæ¯”å¦‚ MySQL</p><p>MySQL è¿™ç±»å…³ç³»å‹æ•°æ®åº“ï¼Œå¦‚æœæœç´¢ IDï¼Œä¼šç›´æ¥èµ°ç´¢å¼•ï¼ˆç´¢å¼•è®¾ç½®å¾—æ­£ç¡®çš„å‰æä¸‹ï¼‰ï¼Œä¸€æ—¦èµ°äº†ç´¢å¼•ï¼ŒæŸ¥è¯¢èµ·æ¥æ˜¯å¾ˆå¿«çš„ï¼Œä½†æ˜¯å¦‚æœæ˜¯æ¨¡ç³ŠæŸ¥è¯¢ï¼Œå°±ä¸ä¸€å®šäº†ï¼Œéœ€è¦é€è¡Œæ‰«æï¼Œåœ¨ç´¢å¼•è®¾ç½®å¾—ä¸å¥½çš„æƒ…å†µä¸‹ï¼Œéœ€è¦å…¨è¡¨æ‰«æï¼Œæ•°æ®é‡å¤§çš„åœºæ™¯ä¸‹æ•ˆç‡éå¸¸ä½</p><p>å€’æ’ç´¢å¼•ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼š</p><ul><li>æ–‡æ¡£ï¼ˆDocumentï¼‰ï¼šES é‡Œä¿å­˜çš„æ•°æ®ï¼Œå…¶ä¸­çš„æ¯ä¸€æ¡æ•°æ®å°±æ˜¯ä¸€ä¸ªæ–‡æ¡£ï¼Œç±»ä¼¼æ•°æ®åº“çš„ä¸€æ¡è®°å½•</li><li>è¯æ¡ï¼ˆTermï¼‰ï¼šå¯¹æ•°æ®è¿›è¡Œåˆ†è¯åå¾—åˆ°çš„æœ‰æ„ä¹‰çš„è¯è¯­</li></ul><p>å€’æ’ç´¢å¼•æ˜¯å¯¹æ­£å‘ç´¢å¼•çš„ä¸€ç§ç‰¹æ®Šå¤„ç†ï¼š</p><ul><li>å°†æ–‡æ¡£æ•°æ®åˆ©ç”¨åˆ†è¯ç®—æ³•ï¼Œå¾—åˆ°ä¸€å †çš„è¯æ¡</li><li>ES é‡Œä¿å­˜çš„æ¯è¡Œæ•°æ®åŒ…æ‹¬è¯æ¡ï¼Œè¯æ¡æ‰€åœ¨æ–‡æ¡£ ID ç­‰ä¿¡æ¯</li><li>å› ä¸ºè¯æ¡å…·æœ‰å”¯ä¸€æ€§ï¼Œå¯ä»¥ç»™è¯æ¡åˆ›å»ºç´¢å¼•</li></ul><p>æœç´¢æµç¨‹ï¼š</p><ul><li>å‘èµ·æœç´¢è¯·æ±‚</li><li>åˆ†è¯å¾—åˆ°è¯æ¡</li><li>æ ¹æ®è¯æ¡æ‹¿åˆ° ES é‡Œçš„æ–‡æ¡£ IDï¼ˆè¿™ä¸ª ID ä¼šå’Œ MySQL é‡Œçš„ ID åŒæ­¥ï¼‰</li><li>æ ¹æ® ID ï¼ˆå» MySQLï¼‰æ‹¿åˆ°å…·ä½“æ•°æ®</li></ul><p>è™½ç„¶éœ€è¦æŸ¥ä¸¤éï¼Œå…ˆæŸ¥å€’æ’ç´¢å¼•ï¼Œå†æŸ¥æ­£å‘ç´¢å¼•ï¼Œä½†å› ä¸ºéƒ½èµ°äº†ç´¢å¼•ï¼Œæ‰€ä»¥éå¸¸å¿«ï¼Œæ— éœ€å…¨è¡¨æ‰«æ</p><p>ä¸¤è€…çš„å…³ç³»å¦‚ä¸‹è¡¨</p><table><thead><tr><th align="center">MySQL</th><th align="center">Elasticsearch</th></tr></thead><tbody><tr><td align="center">table</td><td align="center">index</td></tr><tr><td align="center">row</td><td align="center">document</td></tr><tr><td align="center">column</td><td align="center">field</td></tr><tr><td align="center">schema</td><td align="center">mapping</td></tr><tr><td align="center">sql</td><td align="center">dsl</td></tr></tbody></table><p>ä¸¤è€…ä¸èƒ½æ¯”è¾ƒï¼Œå…³æ³¨çš„é¢†åŸŸä¸åŒï¼ŒMySQL æ“…é•¿äº‹åŠ¡ç±»å‹æ“ä½œï¼Œå¯ä»¥ç¡®ä¿æ•°æ®çš„å®‰å…¨å’Œä¸€è‡´æ€§ï¼ŒES åˆ™æ“…é•¿æµ·é‡æ•°æ®çš„æœç´¢ï¼Œåˆ†æï¼Œè®¡ç®—ï¼Œå®é™…ä¸Šå¾€å¾€ä¸¤è€…ç»“åˆä½¿ç”¨</p><h1 id="IK-åˆ†è¯å™¨"><a href="#IK-åˆ†è¯å™¨" class="headerlink" title="IK åˆ†è¯å™¨"></a>IK åˆ†è¯å™¨</h1><ul><li>ik_smartï¼šåªèƒ½åˆ‡åˆ†ï¼Œç²—ç²’åº¦</li><li>ik_max_wordï¼šæœ€ç»†åˆ‡åˆ†ï¼Œç»†ç²’åº¦</li></ul><h1 id="ES-æœç´¢é«˜äº®"><a href="#ES-æœç´¢é«˜äº®" class="headerlink" title="ES æœç´¢é«˜äº®"></a>ES æœç´¢é«˜äº®</h1><ul><li>ç»™æ–‡æ¡£ä¸­çš„å…³é”®å­—åŠ ä¸€ä¸ªæ ‡ç­¾</li><li>é¡µé¢ç»™è¿™ä¸ªæ ‡ç­¾è®¾ç½® é«˜äº® CSS</li></ul><h1 id="ES-é›†ç¾¤"><a href="#ES-é›†ç¾¤" class="headerlink" title="ES é›†ç¾¤"></a>ES é›†ç¾¤</h1><p>ä¸ç®¡ä»€ä¹ˆé›†ç¾¤ï¼Œé›†ç¾¤æ— éè§£å†³å‡ ä¸ªé—®é¢˜</p><ul><li>æµ·é‡æ•°æ®å­˜å‚¨</li><li>å•ç‚¹æ•…éšœ</li></ul><p>ES é€šè¿‡å¯¹æ•°æ®è¿›è¡Œåˆ†ç‰‡ï¼Œå­˜å‚¨åˆ°ä¸åŒçš„èŠ‚ç‚¹ä¸­ï¼Œå°†å¤‡ä»½æ”¾åˆ°å¯¹æ–¹èŠ‚ç‚¹ï¼Œå®Œæˆäº’ç›¸å¤‡ä»½ï¼Œå½“é›†ç¾¤ä¸­çš„æŸä¸ªèŠ‚ç‚¹æŒ‚æ‰åï¼Œä¼šç«‹å³å°†æŒ‚æ‰çš„èŠ‚ç‚¹ä¸Šçš„åˆ†ç‰‡æ•°æ®è¿ç§»åˆ°å…¶ä»–èŠ‚ç‚¹ï¼Œç¡®ä¿æ•°æ®å®‰å…¨</p><h1 id="é›†ç¾¤ç›‘æ§"><a href="#é›†ç¾¤ç›‘æ§" class="headerlink" title="é›†ç¾¤ç›‘æ§"></a>é›†ç¾¤ç›‘æ§</h1><p>å¯ä»¥ä½¿ç”¨ Kibana ç›´æ¥æ“ä½œï¼Œæˆ–è€… Cerebro</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ELK&quot;&gt;&lt;a href=&quot;#ELK&quot; class=&quot;headerlink&quot; title=&quot;ELK&quot;&gt;&lt;/a&gt;ELK&lt;/h1&gt;&lt;p&gt;ä½•ä¸º ELKï¼ŒElasticsearch + Logstach + Kibaba&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Elasticsearc</summary>
      
    
    
    
    <category term="ELK" scheme="https://linweiyuan.github.io/categories/ELK/"/>
    
    
    <category term="Elasticsearch" scheme="https://linweiyuan.github.io/tags/Elasticsearch/"/>
    
    <category term="Logstash" scheme="https://linweiyuan.github.io/tags/Logstash/"/>
    
    <category term="Kibana" scheme="https://linweiyuan.github.io/tags/Kibana/"/>
    
  </entry>
  
  <entry>
    <title>RabbitMQç›¸å…³çŸ¥è¯†ç‚¹</title>
    <link href="https://linweiyuan.github.io/2022/02/17/RabbitMQ%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9.html"/>
    <id>https://linweiyuan.github.io/2022/02/17/RabbitMQ%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9.html</id>
    <published>2022-02-17T08:54:15.000Z</published>
    <updated>2022-10-04T11:01:19.597Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h1><ul><li>publisherï¼šç”Ÿäº§è€…ï¼ˆå»ºç«‹è¿æ¥ -&gt; åˆ›å»º channel -&gt; å£°æ˜é˜Ÿåˆ— -&gt; å‘é€æ¶ˆæ¯ -&gt; å…³é—­è¿æ¥å’Œ channelï¼‰</li><li>consumerï¼šæ¶ˆè´¹è€…ï¼ˆå»ºç«‹è¿æ¥ -&gt; åˆ›å»º channel -&gt; å£°æ˜é˜Ÿåˆ— -&gt; è®¢é˜…æ¶ˆæ¯ï¼‰</li><li>exchangeï¼šäº¤æ¢æœºï¼Œè´Ÿè´£æ¶ˆæ¯è·¯ç”±<ul><li>Fanout Exchangeï¼šå¹¿æ’­ï¼ˆæ‰€æœ‰ç»‘å®šåˆ°è¯¥äº¤æ¢æœºçš„é˜Ÿåˆ—éƒ½èƒ½æ”¶åˆ°æ¶ˆæ¯ï¼‰</li><li>Direct Exchangeï¼šè·¯ç”±ï¼ˆæ ¹æ® routingKey æ¥å‘é€åˆ°æŒ‡å®šçš„é˜Ÿåˆ—ï¼‰</li><li>Topic Exchangeï¼š ä¸»é¢˜ï¼ˆé€šè¿‡ routingKey é€šé…ç¬¦æ¥å‘é€åˆ°æŒ‡å®šçš„é˜Ÿåˆ—ï¼Œ#åŒ¹é…ä¸€ä¸ªæˆ–å¯¹ä¸ªï¼Œ*åŒ¹é…ä¸€ä¸ªï¼‰</li></ul></li><li>queueï¼šé˜Ÿåˆ—ï¼Œå­˜å‚¨æ¶ˆæ¯<ul><li>åŸºæœ¬æ¶ˆæ¯é˜Ÿåˆ— BasicQueueï¼šä¸€å¯¹ä¸€</li><li>å·¥ä½œæ¶ˆæ¯é˜Ÿåˆ— WorkQueueï¼šä¸€å¯¹å¤š</li></ul></li><li>virtualHostï¼šè™šæ‹Ÿä¸»æœºï¼Œæ¶ˆæ¯éš”ç¦»</li></ul><h2 id="WorkQueueï¼ˆTaskQueueï¼‰ä»»åŠ¡æ¨¡å‹"><a href="#WorkQueueï¼ˆTaskQueueï¼‰ä»»åŠ¡æ¨¡å‹" class="headerlink" title="WorkQueueï¼ˆTaskQueueï¼‰ä»»åŠ¡æ¨¡å‹"></a>WorkQueueï¼ˆTaskQueueï¼‰ä»»åŠ¡æ¨¡å‹</h2><p>å¤šä¸ªæ¶ˆè´¹è€…ç»‘å®šåˆ°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå…±åŒæ¶ˆè´¹é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯</p><ul><li>é»˜è®¤æ˜¯å¹³å‡ç»™æ¯ä¸ªæ¶ˆè´¹è€…ï¼Œå¦‚æœè€ƒè™‘æ¶ˆè´¹è€…çš„å¤„ç†èƒ½åŠ›ï¼Œéœ€è¦è®¾ç½® prefetch å±æ€§ï¼Œæ¯æ¬¡è·å–ä¸€æ¡ï¼Œæ¶ˆè´¹ä¸€æ¡å†è·å–ï¼Œè¾¾åˆ°èƒ½è€…å¤šåŠ³çš„ç›®çš„</li><li>åŒä¸€æ¡æ¶ˆæ¯åªä¼šè¢«ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†</li></ul><h2 id="å‘å¸ƒ-x2F-è®¢é˜…æ¨¡å‹"><a href="#å‘å¸ƒ-x2F-è®¢é˜…æ¨¡å‹" class="headerlink" title="å‘å¸ƒ&#x2F;è®¢é˜…æ¨¡å‹"></a>å‘å¸ƒ&#x2F;è®¢é˜…æ¨¡å‹</h2><p>å¯¹æ¯” WorkQueueï¼Œå¤šäº†ä¸€ä¸ª exchange äº¤æ¢æœº</p><ul><li>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯ä¸æ˜¯å‘é€åˆ°é˜Ÿåˆ—ï¼Œè€Œæ˜¯å‘é€è‡³äº¤æ¢æœº</li><li>æ¶ˆè´¹è€…è®¢é˜…é˜Ÿåˆ—</li><li>exchange åªè´Ÿè´£è½¬å‘æ¶ˆæ¯ï¼Œä¸ä¼šå¯¹æ¶ˆæ¯è¿›è¡Œå­˜å‚¨ï¼Œå¦‚æœæ²¡æœ‰æ­£ç¡®é…ç½®é˜Ÿåˆ—æˆ–è·¯ç”±è§„åˆ™ï¼Œæ¶ˆæ¯å°±ä¼šä¸¢å¤±</li></ul><h1 id="å¦‚ä½•ä¿è¯æ¶ˆæ¯å¯é æ€§"><a href="#å¦‚ä½•ä¿è¯æ¶ˆæ¯å¯é æ€§" class="headerlink" title="å¦‚ä½•ä¿è¯æ¶ˆæ¯å¯é æ€§"></a>å¦‚ä½•ä¿è¯æ¶ˆæ¯å¯é æ€§</h1><p>è¦ç¡®ä¿å‘é€çš„æ¶ˆæ¯è‡³å°‘è¢«æ¶ˆè´¹ä¸€æ¬¡ï¼Œéœ€è¦ä»æºå¤´å¼€å§‹ï¼Œç”Ÿäº§è€…æ˜¯å¦æˆåŠŸå‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœºï¼Œäº¤æ¢æœºæ˜¯å¦æ­£å¸¸å‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—é‡Œçš„æ¶ˆæ¯æ˜¯å¦æˆåŠŸè¢«æ¶ˆè´¹è€…æ¶ˆè´¹</p><p>RabbitMQ æä¾›äº† publisher confirm å’Œ publish-return æœºåˆ¶æ¥é¿å…æ¶ˆæ¯åœ¨å‘é€çš„è¿‡ç¨‹ä¸­ä¸¢å¤±</p><ul><li><p>publish-confirm</p><ul><li>å¦‚æœæ¶ˆæ¯æˆåŠŸæŠ•é€’åˆ°äº¤æ¢æœºï¼Œè¿”å› ack</li><li>å¦‚æœæ¶ˆæ¯æœªæŠ•é€’åˆ°äº¤æ¢æœºï¼Œè¿”å› nack</li></ul></li><li><p>publish-return</p><ul><li>å¦‚æœæ¶ˆæ¯æŠ•é€’åˆ°äº¤æ¢æœºäº†ï¼Œä½†æ˜¯æ²¡æœ‰è·¯ç”±åˆ°é˜Ÿåˆ—ï¼Œè¿”å› ack åŠè·¯ç”±å¤±è´¥åŸå› </li></ul></li></ul><p>è€ƒè™‘åˆ° MQ æœ¬èº«çš„ç¨³å®šï¼Œå¯ä»¥åˆ†åˆ«å°†äº¤æ¢æœºï¼Œé˜Ÿåˆ—ï¼Œæ¶ˆæ¯éƒ½è®¾ç½®ä¸ºæŒä¹…åŒ–</p><h1 id="å¦‚ä½•è§£å†³æ¶ˆæ¯å †ç§¯é—®é¢˜"><a href="#å¦‚ä½•è§£å†³æ¶ˆæ¯å †ç§¯é—®é¢˜" class="headerlink" title="å¦‚ä½•è§£å†³æ¶ˆæ¯å †ç§¯é—®é¢˜"></a>å¦‚ä½•è§£å†³æ¶ˆæ¯å †ç§¯é—®é¢˜</h1><p>å½“å‘é€æ¶ˆæ¯è¶…è¿‡äº†å¤„ç†æ¶ˆæ¯çš„é€Ÿåº¦ï¼Œå°±ä¼šé€ æˆæ¶ˆæ¯å †ç§¯ï¼Œå¦‚æœé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯è¾¾åˆ°ä¸Šé™ï¼Œé‚£ä¹ˆæœ€æ—©å—åˆ°çš„æ¶ˆæ¯ï¼Œå¯èƒ½å°±ä¼šå˜æˆæ­»ä¿¡ï¼Œç„¶åè¢«ä¸¢å¼ƒ</p><p>æ¶ˆæ¯å †ç§¯çš„æœ¬è´¨æ˜¯æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯çš„é€Ÿåº¦è·Ÿä¸ä¸Šï¼Œæ‰€ä»¥å¯ä»¥ä»ä¸‹é¢å‡ ä¸ªæ–¹é¢æ¥è¿›è¡Œè€ƒè™‘</p><ul><li>å¢åŠ æ¶ˆè´¹è€…ä¸ªæ•°ï¼Œé‚£ä¹ˆé€Ÿåº¦å°±æˆå€æé«˜äº†</li><li>å¢åŠ é˜Ÿåˆ—é•¿åº¦ï¼Œå¯ä»¥æš‚å­˜æ›´å¤šçš„æ¶ˆæ¯</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åŸºæœ¬æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#åŸºæœ¬æ¦‚å¿µ&quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬æ¦‚å¿µ&quot;&gt;&lt;/a&gt;åŸºæœ¬æ¦‚å¿µ&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;publisherï¼šç”Ÿäº§è€…ï¼ˆå»ºç«‹è¿æ¥ -&amp;gt; åˆ›å»º channel -&amp;gt; å£°æ˜é˜Ÿåˆ— -&amp;gt; å‘é€æ¶ˆ</summary>
      
    
    
    
    <category term="æ¶ˆæ¯é˜Ÿåˆ—" scheme="https://linweiyuan.github.io/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/"/>
    
    
    <category term="RabbitMQ" scheme="https://linweiyuan.github.io/tags/RabbitMQ/"/>
    
  </entry>
  
  <entry>
    <title>Redisç›¸å…³çŸ¥è¯†ç‚¹</title>
    <link href="https://linweiyuan.github.io/2022/01/09/Redis%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9.html"/>
    <id>https://linweiyuan.github.io/2022/01/09/Redis%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9.html</id>
    <published>2022-01-09T06:03:16.000Z</published>
    <updated>2022-10-04T11:01:19.597Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Redisï¼šRemote-Dictionary-Server"><a href="#Redisï¼šRemote-Dictionary-Server" class="headerlink" title="Redisï¼šRemote Dictionary Server"></a>Redisï¼šRemote Dictionary Server</h1><ul><li>åŸºäºå†…å­˜ï¼Œé€Ÿåº¦éå¸¸å¿«ï¼ˆå› æ­¤å—ç‰©ç†å†…å­˜å¤§å°é™åˆ¶ï¼‰</li><li>æ•°æ®ç»“æ„éå¸¸ä¸°å¯Œï¼ˆStringï¼Œ Listï¼Œ Hashï¼Œ Setï¼Œ SortedSetï¼‰</li><li>å•çº¿ç¨‹ï¼Œé¿å…äº†çº¿ç¨‹åˆ‡æ¢å’Œé”æœºåˆ¶çš„æ€§èƒ½æ¶ˆè€—</li><li>å¯æŒä¹…åŒ–ï¼ˆRDB + AOFï¼‰</li><li>æ”¯æŒå‘å¸ƒè®¢é˜…</li><li>æ”¯æŒ Lua è„šæœ¬</li><li>æ”¯æŒåˆ†å¸ƒå¼é”</li><li>æ”¯æŒåŸå­æ“ä½œå’Œäº‹åŠ¡</li><li>æ”¯æŒä¸»ä»å¤åˆ¶ï¼ˆMaster-Slaveï¼‰å’Œé«˜å¯ç”¨ï¼ˆRedis Sentinelï¼‰ï¼ˆ3.0 ç‰ˆæœ¬ä»¥ä¸Šï¼‰</li><li>æ”¯æŒç®¡é“ï¼ˆç®¡é“åœ¨è¿™é‡Œç±»ä¼¼äº batchï¼Œä¸€æ¬¡æ€§å‘é€å¤šä¸ªå‘½ä»¤ï¼Œä¸€æ¬¡æ€§è¿”å›æ‰€æœ‰ç»“æœï¼Œå‡å°‘ç½‘ç»œå¼€é”€ï¼‰</li></ul><h1 id="ä¸»è¦çš„äº”ç§æ•°æ®ç»“æ„åŠä½¿ç”¨åœºæ™¯"><a href="#ä¸»è¦çš„äº”ç§æ•°æ®ç»“æ„åŠä½¿ç”¨åœºæ™¯" class="headerlink" title="ä¸»è¦çš„äº”ç§æ•°æ®ç»“æ„åŠä½¿ç”¨åœºæ™¯"></a>ä¸»è¦çš„äº”ç§æ•°æ®ç»“æ„åŠä½¿ç”¨åœºæ™¯</h1><p>Redis æ”¯æŒå¤šç§æ•°æ®ç»“æ„ï¼Œå¸¸ç”¨çš„æœ‰ 5 ç§</p><ul><li>Stringï¼šè®¡æ•°å™¨ï¼Œkv å­˜å‚¨ï¼Œé™æµï¼Œåˆ†å¸ƒå¼é”</li><li>Listï¼šå½“é˜Ÿåˆ—æ¥ä½¿ç”¨ï¼ˆlpush + rpop æˆ–è€… rpush + lpopï¼‰ï¼›å‘çº¢åŒ…ï¼ˆæŠ¢çº¢åŒ…æ˜¯å…¥é˜Ÿï¼Œæ‹†çº¢åŒ…åˆ™æ˜¯å‡ºé˜Ÿï¼‰ï¼›åˆ—è¡¨ï¼ˆæœ‹å‹åœˆç‚¹èµï¼Œè¯„è®ºï¼‰</li><li>Hashï¼škvï¼Œæ¯”å¦‚å­˜ä¸€äº›æ ‡ç­¾ä¿¡æ¯ï¼Œåœ¨ä¿å­˜ç”¨æˆ·ä¿¡æ¯ç­‰çš„åœºæ™¯ï¼ŒHash å’Œ String çš„ä¸åŒç‚¹åœ¨äºï¼ŒString è¦ä¿®æ”¹æŸä¸ªå­—æ®µå¿…é¡»å°†æ•´æ¡ç”¨æˆ·å®Œæ•´ä¿¡æ¯å–å‡ºæ¥ï¼Œå†è¿›è¡Œç³»åˆ—åŒ–ååºåˆ—åŒ–æ“ä½œï¼Œè€Œ Hash å¯ä»¥åªå¯¹æŸä¸ªå­—æ®µè¿›è¡Œä¿®æ”¹ï¼ŒèŠ‚çœäº†ç½‘ç»œæµé‡ï¼Œä¸è¿‡ Hash è¦æ¯” String å ç”¨å¤šä¸€ç‚¹å†…å­˜ï¼›è´­ç‰©è½¦ï¼ˆç”¨æˆ· idï¼Œå•†å“ idï¼Œå•†å“æ•°é‡ï¼‰ï¼›å­˜å‚¨å¯¹è±¡</li><li>Setï¼šå¥½å‹ã€å…³æ³¨ã€ç²‰ä¸ã€æ„Ÿå…´è¶£çš„äººçš„é›†åˆï¼ˆsinter è·å–äº¤é›†ï¼Œsismember åˆ¤æ–­æ˜¯å¦å­˜åœ¨ï¼Œscard è·å–æ•°é‡ï¼‰ï¼›é¦–é¡µéšæœºæ¨èå±•ç¤ºï¼ˆsrandmemberï¼‰ï¼›å­˜å‚¨éœ€è¦å»é‡çš„åœºæ™¯ï¼Œæ¯”å¦‚ä¸­å¥–ï¼Œä¿è¯ä¸ä¼šä¸­ä¸¤æ¬¡</li><li>SortedSetï¼šæ’è¡Œæ¦œï¼ˆå› ä¸ºæœ‰åºï¼‰</li></ul><h1 id="å•çº¿ç¨‹çš„-Redis-ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«"><a href="#å•çº¿ç¨‹çš„-Redis-ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«" class="headerlink" title="å•çº¿ç¨‹çš„ Redis ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«"></a>å•çº¿ç¨‹çš„ Redis ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«</h1><ul><li>Redis æ˜¯å®Œå…¨åŸºäºå†…å­˜çš„ï¼Œæ‰€ä»¥è¯»å†™æ•ˆç‡éå¸¸é«˜ï¼Œå½“ç„¶ Redis å­˜åœ¨æŒä¹…åŒ–æ“ä½œï¼Œä½† Redis çš„æŒä¹…åŒ–æ“ä½œæ˜¯é€šè¿‡ fork å­è¿›ç¨‹å’Œåˆ©ç”¨ Linux ç³»ç»Ÿçš„é¡µç¼“å­˜æŠ€æœ¯æ¥å®Œæˆï¼Œæ‰€ä»¥å¹¶ä¸ä¼šå½±å“ Redis çš„æ€§èƒ½</li><li>å¯¹äº Redis æ¥è¯´ï¼Œå®ƒçš„æ€§èƒ½ç“¶é¢ˆä¸»è¦åœ¨ç½‘ç»œå’Œ IO ä¸Šï¼Œè€Œä¸åœ¨ CPUï¼Œå¤šçº¿ç¨‹é¢‘ç¹è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢ä¼šå¸¦æ¥é¢å¤–çš„æ€§èƒ½æ¶ˆè€—ï¼Œå¯èƒ½ä¼šé€ æˆè´Ÿä¼˜åŒ–ï¼›Redis é«˜ç‰ˆæœ¬ä¹Ÿæ”¯æŒå¤šçº¿ç¨‹ï¼Œä½†æ˜¯ä¸»è¦æ˜¯ç”¨æ¥æ‰§è¡Œå¯¹ä¸€äº›å¤§é”®å€¼å¯¹çš„åˆ é™¤æ“ä½œï¼Œé€šè¿‡å¤šçº¿ç¨‹éé˜»å¡åœ°é‡Šæ”¾å†…å­˜ç©ºé—´ä¹Ÿèƒ½å‡å°‘å¯¹ Redis ä¸»çº¿ç¨‹çš„é˜»å¡æ—¶é—´ï¼Œæé«˜æ‰§è¡Œçš„æ•ˆç‡</li><li>æ•°æ®ç»“æ„è®¾è®¡å¾—åˆç†é«˜æ•ˆ</li><li>é‡‡ç”¨äº†éé˜»å¡ IO å¤šè·¯å¤ç”¨æœºåˆ¶ï¼šIO å¤šè·¯å¤ç”¨æ˜¯åˆ©ç”¨ selectã€pollã€epoll å¯ä»¥åŒæ—¶ç›‘æµ‹å¤šä¸ªæµçš„ IO äº‹ä»¶çš„èƒ½åŠ›ï¼Œåœ¨ç©ºé—²çš„æ—¶å€™ï¼Œä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œå½“æœ‰ IO äº‹ä»¶å‘ç”Ÿæ—¶æ‰å”¤é†’æ¥å¤„ç†å°±ç»ªçš„æµï¼Œè¿™æ ·å°±é¿å…äº†å¤§é‡çš„æ— ç”¨æ“ä½œ</li></ul><h1 id="æ•°æ®è¿‡æœŸæ·˜æ±°ç­–ç•¥"><a href="#æ•°æ®è¿‡æœŸæ·˜æ±°ç­–ç•¥" class="headerlink" title="æ•°æ®è¿‡æœŸæ·˜æ±°ç­–ç•¥"></a>æ•°æ®è¿‡æœŸæ·˜æ±°ç­–ç•¥</h1><p>Redis ä¸­æ•°æ®è¿‡æœŸæ·˜æ±°ç­–ç•¥é‡‡ç”¨çš„æ˜¯å®šæœŸåˆ é™¤ + æƒ°æ€§åˆ é™¤</p><ul><li>å®šæœŸåˆ é™¤ï¼ˆactiveExpireCycleï¼‰ï¼šRedis åå°æœ‰ä¸€ä¸ªå®šæ—¶å™¨æ¥å®šæ—¶ç›‘è§†æ‰€æœ‰çš„ keyï¼Œè¿‡æœŸå°±åˆ é™¤ã€‚é€šè¿‡å®šæœŸåˆ é™¤ç­–ç•¥ï¼Œå¯ä»¥ä¿è¯è¿‡æœŸçš„ key æœ€åéƒ½ä¼šè¢«åˆ æ‰ï¼Œç¼ºç‚¹å°±æ˜¯æ¯æ¬¡éƒ½è¦éƒ½éå† Redis ä¸­çš„æ‰€æœ‰ keyï¼Œéå¸¸æ¶ˆè€— CPU èµ„æºï¼Œå¦‚æœ key è¿‡æœŸäº†ï¼Œä½†æ˜¯å®šæ—¶å™¨è¿˜æ²¡å¼€å§‹å·¥ä½œï¼Œè¿™ä¸ªè¿‡æœŸçš„ key å°±è¿˜èƒ½ç”¨</li><li>æƒ°æ€§åˆ é™¤ï¼ˆexpireIfNeededï¼‰ï¼šåœ¨ä½¿ç”¨ key æ—¶ï¼Œå…ˆåˆ¤æ–­ key æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸåˆ™åˆ é™¤ã€‚è¿™ç§æ–¹å¼ä¹Ÿæœ‰ç¼ºç‚¹ï¼Œå°±æ˜¯è™½ç„¶è¿™ä¸ª key è¿‡æœŸäº†ï¼Œä½†æ˜¯ä¸€ç›´æ²¡äººç”¨ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šä¸€ç›´å­˜åœ¨ Redis ä¸­ï¼Œé€ æˆæµªè´¹</li></ul><p>å› æ­¤ Redis å°†è¿™ä¸¤ç§æ–¹å¼ç»“åˆèµ·æ¥ï¼Œå®šæ—¶éšæœºæŠ½å–ä¸€äº›å¹¸è¿ key è¿›è¡Œåˆ é™¤</p><p>è¿™æ ·æ²¡æœ‰ç¼ºç‚¹å—ï¼Ÿ</p><p>æœ‰ï¼Œå¦‚æœæŸä¸ª key æ˜¯å¤©é€‰ä¹‹å­ï¼Œæ¯æ¬¡éƒ½æŠ½ä¸åˆ°ï¼Œä½†æ˜¯å·²ç»è¿‡æœŸäº†ï¼Œå°±ä¼šå¸¸é©»å†…å­˜</p><p>æ‰€ä»¥ Redis è¿˜ä¼šæœ‰å¦å¤–çš„æœºåˆ¶æ¥å¤„ç†è¿™ç§æƒ…å†µï¼Œå°±æ˜¯å†…å­˜æ·˜æ±°</p><h1 id="å†…å­˜æ·˜æ±°æœºåˆ¶"><a href="#å†…å­˜æ·˜æ±°æœºåˆ¶" class="headerlink" title="å†…å­˜æ·˜æ±°æœºåˆ¶"></a>å†…å­˜æ·˜æ±°æœºåˆ¶</h1><p>volatileï¼šè®¾ç½®è¿‡æœŸæ—¶é—´çš„ key<br>allkeysï¼šå…¨éƒ¨ key<br>lruï¼šæœ€è¿‘æœ€å°‘ä½¿ç”¨<br>lfuï¼šæœ€è¿‘æœ€ä¸ç»å¸¸ä½¿ç”¨<br>randomï¼šéšæœº<br>ttlï¼šè¿‡æœŸæ—¶é—´<br>noevictionï¼šæ°¸ä¸è¿‡æœŸ</p><p>æ’åˆ—ç»„åˆï¼š</p><ul><li>volatile-lru</li><li>allkeys-lru</li><li>volatile-lfu</li><li>allkeys-lfu</li><li>volatile-random</li><li>allkeys-random</li><li>volatile-ttl</li><li>noeviction</li></ul><p>é»˜è®¤æ˜¯æ°¸ä¸è¿‡æœŸï¼Œå¦‚æœæ»¡äº†å°±ä¼šæŠ¥ OOM</p><h1 id="Redis-å’Œ-Memcached-çš„åŒºåˆ«"><a href="#Redis-å’Œ-Memcached-çš„åŒºåˆ«" class="headerlink" title="Redis å’Œ Memcached çš„åŒºåˆ«"></a>Redis å’Œ Memcached çš„åŒºåˆ«</h1><ul><li>å­˜å‚¨æ–¹å¼ä¸åŒï¼šMemcachedb æŠŠæ•°æ®å…¨éƒ¨å­˜åœ¨å†…å­˜ä¹‹ä¸­ï¼Œæ–­ç”µåä¼šæŒ‚æ‰ï¼Œæ•°æ®ä¸èƒ½è¶…è¿‡å†…å­˜å¤§å°ï¼›Redis æœ‰éƒ¨åˆ†å­˜åœ¨ç¡¬ç›˜ä¸Šï¼Œè¿™æ ·èƒ½ä¿è¯æ•°æ®çš„æŒä¹…æ€§</li><li>æ•°æ®ç±»å‹æ”¯æŒï¼šMemcached å¯¹æ•°æ®ç±»å‹æ”¯æŒç›¸å¯¹ç®€å•ï¼›Redis æœ‰å¤æ‚çš„æ•°æ®ç±»å‹</li></ul><h1 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-Redis-è€Œä¸ç”¨-map-x2F-guava-åšç¼“å­˜"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-Redis-è€Œä¸ç”¨-map-x2F-guava-åšç¼“å­˜" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Redis è€Œä¸ç”¨ map&#x2F;guava åšç¼“å­˜"></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Redis è€Œä¸ç”¨ map&#x2F;guava åšç¼“å­˜</h1><p>ç¼“å­˜åˆ†ä¸ºæœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜</p><p>map æˆ–è€… guava å®ç°çš„æ˜¯æœ¬åœ°ç¼“å­˜ï¼Œè¿™ç§ç¼“å­˜æ˜¯å­˜åœ¨å†…å­˜ä¸­çš„ï¼Œä¸€æ—¦ JVM æŒ‚äº†æˆ–æ‰‹åŠ¨åœæ‰ï¼Œæ•°æ®å°±ä¸¢å¤±äº†ï¼Œæœ¬åœ°ç¼“å­˜æ— æ³•åšåˆ°å¤šå®ä¾‹å…±äº«ï¼Œå› ä¸ºæ¯ä¸ªå®ä¾‹éƒ½æœ‰è‡ªå·±çš„ä¸€ä»½ï¼Œç”Ÿå‘½å‘¨æœŸå’Œ JVM ç»‘å®š</p><p>Redis æˆ–è€… Memcached åˆ™ç§°ä¸ºåˆ†å¸ƒå¼ç¼“å­˜ï¼Œæ”¯æŒå¤šå®ä¾‹å…±äº«ï¼ŒRedis è¿˜æ”¯æŒæ•°æ®æŒä¹…åŒ–ï¼Œå®•æœºæ•°æ®è¿˜åœ¨</p><h1 id="Redis-ä¸‰å¤§ç»å…¸é—®é¢˜"><a href="#Redis-ä¸‰å¤§ç»å…¸é—®é¢˜" class="headerlink" title="Redis ä¸‰å¤§ç»å…¸é—®é¢˜"></a>Redis ä¸‰å¤§ç»å…¸é—®é¢˜</h1><h2 id="ç¼“å­˜ç©¿é€"><a href="#ç¼“å­˜ç©¿é€" class="headerlink" title="ç¼“å­˜ç©¿é€"></a>ç¼“å­˜ç©¿é€</h2><p>æŸ¥è¯¢ä¸€ä¸ªæ•°æ®åº“ä¸å­˜åœ¨çš„æ•°æ®ï¼Œå› ä¸ºæ•°æ®åº“æ²¡æœ‰ï¼Œæ‰€ä»¥ä¸èƒ½å°†æ•°æ®åº“å€¼ç¼“å­˜èµ·æ¥ï¼Œå¯¼è‡´æ¯æ¬¡è¯·æ±‚éƒ½ç›´æ¥å»åˆ°æ•°æ®åº“ï¼ŒRedis å½¢åŒè™šè®¾</p><p>è§£å†³æ–¹æ¡ˆï¼š</p><ul><li><p>ç¼“å­˜ç©ºå€¼<br>å½“è¯·æ±‚çš„æ•°æ®åº“ä¸å­˜åœ¨äº Redis ä¸­ä¹Ÿä¸å­˜åœ¨äºæ•°æ®åº“æ—¶ï¼Œè®¾ç½®ä¸€ä¸ªé»˜è®¤ç©ºå€¼ï¼Œåç»­å†è¿›è¡ŒæŸ¥è¯¢æ—¶å°±ç›´æ¥è¿”å›ï¼Œé¿å…è¯·æ±‚å»åˆ°æ•°æ®åº“ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜éœ€è¦å¯¹è¯¥æ•°æ®è®¾ç½®ä¸€ä¸ªåˆé€‚çš„è¿‡æœŸæ—¶é—´ï¼Œä¸ç„¶åç»­è¿™ä¸ª key çš„æ•°æ®åœ¨æ•°æ®åº“æœ‰äº†ï¼Œæ°¸è¿œä¸èƒ½è¢«æŸ¥åˆ°</p></li><li><p>å¸ƒéš†è¿‡æ»¤å™¨<br>åœ¨æ•°æ®å†™å…¥æ•°æ®åº“çš„åŒæ—¶ï¼Œå°†è¿™ä¸ª ID åŒæ­¥åˆ°å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œå½“è¯·æ±‚çš„ ID ä¸å­˜åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œåˆ™è¯´æ˜è¯¥è¯·æ±‚æŸ¥è¯¢çš„æ•°æ®ä¸€å®šæ²¡æœ‰åœ¨æ•°æ®åº“ä¸­ä¿å­˜ï¼Œå°±ä¸è¦å†å»æŸ¥æ•°æ®åº“</p><ul><li>åŸç†ï¼šé¦–å…ˆåˆ†é…ä¸€å—æ•°ç»„ï¼Œé‡Œé¢çš„å€¼å…¨ä¸º 0ï¼Œå½“å­˜å…¥å…ƒç´ æ—¶ï¼Œé‡‡ç”¨ N ä¸ªå“ˆå¸Œå‡½æ•°å¯¹è¯¥å…ƒç´ è¿›è¡Œå“ˆå¸Œè®¡ç®—ï¼Œæ˜ å°„å‡ºæ¥çš„ä½ç½®å…¨éƒ¨è®¾ç½®ä¸º 1ï¼›å½“æ£€æŸ¥è¿™ä¸ª key æ˜¯å¦å­˜åœ¨æ—¶ï¼Œä¹Ÿæ˜¯åŒæ ·çš„æ–¹æ³•ï¼Œå¦‚æœå¾—åˆ°çš„å…¨ä¸º 1ï¼Œåˆ™ key å­˜åœ¨ï¼›å¸ƒéš†è¿‡è·¯å™¨å­˜çš„åªæ˜¯è¿™ä¸ª key è®¡ç®—å‡ºæ¥çš„å“ˆå¸Œå€¼ï¼Œå¹¶ä¸æ˜¯è¿™ä¸ª key æœ¬èº«ï¼Œè€Œå“ˆå¸Œå‡½æ•°æ˜¯ä¼šå‡ºç°ç¢°æ’çš„ï¼Œæ‰€ä»¥å°±ç®—è®¡ç®—å‡ºæ¥å…¨æ˜¯ 1ï¼Œä¹Ÿä¸èƒ½ä¿è¯å…¶å®è¿™ä¸ª key å­˜åœ¨ï¼Œä¹Ÿå°±æ˜¯ä¼šå‡ºç°åˆ¤æ–­ key å­˜åœ¨ï¼Œä½†å®é™…ä¸å­˜åœ¨çš„çš„æƒ…å†µï¼Œå­˜åœ¨è¯¯åˆ¤ï¼›åä¹‹ï¼Œå½“åˆ¤æ–­è¿™ä¸ª key ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œå°±ä¸€å®šä¸å­˜åœ¨</li></ul></li><li><p>å¯¹äºæ¶æ„æ„é€ çš„è¯·æ±‚</p><ul><li>å¯¹å‚æ•°è¿›è¡Œæ ¡éªŒï¼Œéæ³•åˆ™æ‹¦æˆª</li><li>æ‹‰é»‘ IPï¼ˆæ²»æ ‡ä¸æ²»æœ¬ï¼‰</li></ul></li></ul><h2 id="ç¼“å­˜å‡»ç©¿"><a href="#ç¼“å­˜å‡»ç©¿" class="headerlink" title="ç¼“å­˜å‡»ç©¿"></a>ç¼“å­˜å‡»ç©¿</h2><p>é«˜å¹¶å‘æµé‡ï¼Œè®¿é—®çš„è¿™ä¸ªæ•°æ®æ˜¯çƒ­ç‚¹æ•°æ®ï¼Œè¯·æ±‚çš„æ•°æ®åœ¨æ•°æ®åº“ä¸­å­˜åœ¨ï¼Œä½†æ˜¯ Redis å­˜çš„é‚£ä¸€ä»½å·²ç»è¿‡æœŸï¼Œåç«¯éœ€è¦ä»æ•°æ®åº“åŠ è½½æ•°æ®å¹¶å†™åˆ° Redisï¼ˆå•ä¸€çƒ­ç‚¹æ•°æ®ã€é«˜å¹¶å‘ã€æ•°æ®å¤±æ•ˆï¼‰</p><ul><li>è§£å†³æ–¹æ¡ˆï¼š<ul><li>è®¾ç½®éšå³è¿‡æœŸæ—¶é—´ï¼šè®©ç¼“å­˜æ•°æ®æ…¢æ…¢è¿‡æœŸ</li><li>ç¼“å­˜é¢„çƒ­ï¼šæå‰æŠŠçƒ­é—¨æ•°æ®å­˜å…¥ Redisï¼Œè®¾ç½®ä¸€ä¸ªè¾ƒå¤§çš„è¿‡æœŸæ—¶é—´</li><li>é”æœºåˆ¶ï¼šå½“å‘ç°ç¼“å­˜å¤±æ•ˆæ—¶ï¼Œéœ€è¦å…ˆè·å–é”ï¼ŒæˆåŠŸåæ‰æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢å’Œå†™æ•°æ®åˆ°ç¼“å­˜çš„æ“ä½œï¼Œå¤±è´¥åˆ™è¯´æ˜å½“å‰æœ‰å…¶ä»–çº¿ç¨‹åœ¨å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œï¼Œä¼‘çœ ä¸€æ®µæ—¶é—´å†é‡è¯•</li></ul></li></ul><h2 id="ç¼“å­˜é›ªå´©"><a href="#ç¼“å­˜é›ªå´©" class="headerlink" title="ç¼“å­˜é›ªå´©"></a>ç¼“å­˜é›ªå´©</h2><p>åˆ†ä¸¤ç§æƒ…å†µ</p><p>Redis ä¸­å¤§é‡æ•°æ®åŒæ—¶å¤±æ•ˆï¼Œé«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¤§é‡çš„è¯·æ±‚ç›´æ¥å»åˆ°æ•°æ®åº“ï¼Œé€ æˆæ•°æ®åº“å‹åŠ›æ¿€å¢ï¼Œä¸¥é‡çš„è¯ä¼šææŒ‚æ•°æ®åº“</p><ul><li>è§£å†³æ–¹æ¡ˆï¼š<ul><li>è®¾ç½®éšå³è¿‡æœŸæ—¶é—´ï¼Œé¿å…å¤§é‡æ•°æ®åŒæ—¶è¿‡æœŸ</li><li>å¯¹éæ ¸å¿ƒä¸šåŠ¡çš„æ¥å£è¿›è¡Œé™æµï¼Œé¿å…è¿‡å¤šè¯·æ±‚ç›´æ¥è¢«å»åˆ°æ•°æ®åº“</li><li>åå°å¼€å¯æ—¶ä»»åŠ¡ï¼Œåœ¨ç¼“å­˜å¿«è¦å¤±æ•ˆæ—¶åŠæ—¶æ›´æ–°ç¼“å­˜ï¼ˆå…·ä½“é—®é¢˜å…·ä½“åˆ†æï¼‰</li></ul></li></ul><p>Redis æŒ‚äº†ï¼Œä¹Ÿä¼šä½¿è¯·æ±‚å…¨éƒ¨å»åˆ°æ•°æ®åº“</p><ul><li>è§£å†³æ–¹æ¡ˆï¼š<ul><li>å°†çƒ­ç‚¹æ•°æ®å‡åŒ€åˆ†å¸ƒåœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Š</li><li>æœåŠ¡ç†”æ–­å’Œé™æµ</li><li>æ„å»ºé«˜å¯ç”¨é›†ç¾¤</li></ul></li></ul><p>ç¼“å­˜å‡»ç©¿å’Œç¼“å­˜é›ªå´©çš„æœ€å¤§åŒºåˆ«å°±æ˜¯å•ä¸€çƒ­ç‚¹æ•°æ®å¤±æ•ˆï¼Œè¿˜æ˜¯å¤§é‡æ•°æ®åŒæ—¶å¤±æ•ˆ</p><p>æ€»ä¹‹æŠŠæ¡å‰ä¸­åçš„åŸåˆ™å»è¿›è¡Œç³»ç»Ÿè®¾è®¡å’Œè€ƒè™‘</p><p>æ•…éšœä¹‹å‰ï¼Œå°½å¯èƒ½é›†ç¾¤éƒ¨ç½²ï¼Œæ”¾ç½®å•ç‚¹æ•…éšœ<br>å‘ç”Ÿäº†æ•…éšœï¼Œå¯¹æœåŠ¡è¿›è¡Œé™æµã€é™çº§æ“ä½œï¼Œé¿å…ææŒ‚ MySQL<br>ä¿®å¤äº†æ•…éšœåï¼Œé€šè¿‡ Redis æŒä¹…åŒ–æœºåˆ¶ RDB å’Œ AOFï¼Œæ¢å¤ç¼“å­˜æ•°æ®</p><h1 id="Redis-æŒä¹…åŒ–"><a href="#Redis-æŒä¹…åŒ–" class="headerlink" title="Redis æŒä¹…åŒ–"></a>Redis æŒä¹…åŒ–</h1><ul><li>RDBï¼ˆRedis Database Backup fileï¼‰ï¼šRedis å¿«ç…§æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯ä¸€äº›äºŒè¿›åˆ¶çš„æ•°æ®ï¼Œé€šè¿‡ saveã€bgsave ç­‰å‘½ä»¤è¿›è¡Œä¿å­˜ï¼Œå®•æœºæ¢å¤èµ·æ¥è¾ƒå¿«ï¼Œæ–‡ä»¶ä½“ç§¯ä¹Ÿå°ï¼Œæœ‰å‹ç¼©</li><li>AOFï¼ˆAppend Only Fileï¼‰ï¼šå¯¹ Redis æ“ä½œçš„æ¯ä¸€æ¡å†™å‘½ä»¤éƒ½ä¼šè®°å½•èµ·æ¥ï¼Œæ˜¯çº¯æ–‡æœ¬ï¼Œäººå¯ä»¥çœ‹ï¼Œæ•…éšœæ¢å¤æ—¶ï¼Œé‡æ–°è·‘è®°å½•çš„å‘½ä»¤ï¼Œå› ä¸ºè®°å½•æ¯ä¸€æ¡å‘½ä»¤ï¼Œæ‰€ä»¥ä½“ç§¯ä¼šè¾ƒå¤§</li></ul><p>Redis æ”¯æŒåŒæ—¶å¼€å¯ RDB å’Œ AOFï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¼šä¼˜å…ˆåˆ©ç”¨ AOF æ–‡ä»¶æ¥æ¢å¤æ•°æ®ï¼Œå› ä¸º AOF æ–‡ä»¶ä¿å­˜äº†æ¯ä¸€æ¡è®°å½•ï¼Œç›¸å¯¹æ¥è¯´æ•°æ®å®Œæ•´æ€§é«˜ä¸€ç‚¹</p><h1 id="Redis-ä¸»ä»"><a href="#Redis-ä¸»ä»" class="headerlink" title="Redis ä¸»ä»"></a>Redis ä¸»ä»</h1><p>å•èŠ‚ç‚¹ Redis çš„å¹¶å‘èƒ½åŠ›æœ‰ä¸Šé™ï¼Œæ­å»ºä¸»ä»é›†ç¾¤å¯ä»¥æé«˜å¹¶å‘èƒ½åŠ›ï¼Œå®ç°è¯»å†™åˆ†ç¦»<br>åªæœ‰ master èŠ‚ç‚¹å¯ä»¥æ‰§è¡Œå†™æ“ä½œï¼Œslave èŠ‚ç‚¹åªèƒ½æ‰§è¡Œè¯»æ“ä½œ</p><h2 id="ä¸»ä»åŒæ­¥"><a href="#ä¸»ä»åŒæ­¥" class="headerlink" title="ä¸»ä»åŒæ­¥"></a>ä¸»ä»åŒæ­¥</h2><p>ä¸»ä»åŒæ­¥åˆ†ä¸ºå…¨é‡åŒæ­¥å’Œå¢é‡åŒæ­¥</p><ul><li>å…¨é‡åŒæ­¥<br>å½“ slave ç¬¬ä¸€æ¬¡è¿æ¥åˆ° master æ—¶ï¼Œä¼šæ‰§è¡Œä¸€æ¬¡å…¨é‡åŒæ­¥ï¼Œè¿™ä¸ªæ—¶å€™ master ä¼šå°†å†…å­˜ä¸­çš„æ•°æ®ç”Ÿæˆå¿«ç…§ RDBï¼Œå¹¶å‘é€ç»™ slaveï¼Œåç»­é€šè¿‡å‘é€ä¿å­˜åœ¨ repl_backlog çš„å‘½ä»¤ç»™ slave å®Œæˆå¢é‡åŒæ­¥<br>æ€ä¹ˆçŸ¥é“æ˜¯ä¸æ˜¯ç¬¬ä¸€æ¬¡è¿æ¥ï¼Ÿ<br>master å’Œ slave éƒ½æœ‰ä¸€ä¸ª replication idï¼Œå¦‚æœä¸ä¸€è‡´ï¼Œåˆ™æ˜¯ç¬¬ä¸€æ¬¡åŒæ­¥ï¼Œé‚£ä¹ˆ slave å°±ä¼šä¿®æ”¹è‡ªå·±çš„ id ä¸º master çš„ id<br>å¦‚æœ slave æ–­å¼€å¤ªä¹…ï¼Œå¯¼è‡´ offset å·®å¤ªå¤šï¼Œä¹Ÿè¦å…¨é‡åŒæ­¥ï¼Œoffset å¯ä»¥ç®€å•ç†è§£ä¸º slave å’Œ master çš„æ•°æ®ç›¸å·®çš„é‡ï¼Œè¯¦ç»†çš„è¯è®°ä¸æ¸…äº†ï¼Œæœ‰ä¸ªåœ†ç¯ä»€ä¹ˆçš„ï¼Œå¦‚æœåœ¨åœ†ä¸Šèµ°äº†ä¸€åœˆæ•°æ®è¿˜æ²¡åŒæ­¥è¿‡å»ï¼Œé‚£åœ†ä¸Šçš„æ•°æ®å°±ä¼šè¢«è¦†ç›–ï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œå°±è¦å…¨é‡åŒæ­¥</li><li>å¢é‡åŒæ­¥<br>slave æŠŠ offset å‘ç»™ masterï¼Œmaster å» repl_backlog é‡ŒæŸ¥çœ‹ï¼Œå¹¶å‘é€ offset ä¹‹åçš„å‘½ä»¤ç»™ slave</li></ul><h1 id="Redis-Sentinel-å“¨å…µæœºåˆ¶"><a href="#Redis-Sentinel-å“¨å…µæœºåˆ¶" class="headerlink" title="Redis Sentinel å“¨å…µæœºåˆ¶"></a>Redis Sentinel å“¨å…µæœºåˆ¶</h1><p>Sentinel æ˜¯ Redis çš„é«˜å¯ç”¨è§£å†³æ–¹æ¡ˆï¼Œç”¨æ¥å¯¹ Redis ä¸»ä»èŠ‚ç‚¹è¿›è¡Œç›‘æ§ï¼Œå‘ç”Ÿæ•…éšœæ—¶é€šè¿‡æŠ•ç¥¨æœºåˆ¶é€‰ä¸¾å‡ºæ–°çš„ masterï¼Œå¹¶å°†æ‰€æœ‰ slave è¿æ¥åˆ°æ–°çš„ master ä¸Š</p><p>å“¨å…µä¹Ÿæ˜¯ä¸€ä¸ª Redis æœåŠ¡å™¨ï¼Œè¿è¡Œçš„æ˜¯ redis-sentinel å‘½ä»¤ï¼Œè€Œæ™®é€š redis æœåŠ¡è¿è¡Œçš„åˆ™æ˜¯ redis-server å‘½ä»¤</p><p>å“¨å…µä¸æä¾›æ•°æ®æœåŠ¡ï¼Œé€šå¸¸é…ç½®æˆå•æ•°ï¼Œå¯ä»¥è¿è¡Œå¤šä¸ªå®ä¾‹ç»„æˆä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿ</p><p>å¯¹äºä¸€äº›èµ·ç›‘æ§ä½œç”¨çš„ä¸­é—´ä»¶ï¼Œå®Œæˆçš„äº‹æƒ…æ— éå°±æ˜¯ä¸‹é¢å‡ ä¸ªï¼š</p><ul><li>ç›‘æ§ï¼šç¡®ä¿ä¸»ä»èŠ‚ç‚¹æ­£å¸¸è¿è¡Œ</li><li>é€šçŸ¥ï¼šå‡ºç°é—®é¢˜æ—¶å‘å‡ºé€šçŸ¥</li><li>æ•…éšœè½¬ç§»ï¼šé€‰ä¸¾æ–° masterï¼Œå°†å…¶ä»– slave è¿æ¥åˆ°æ–°çš„ master ä¸Š</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Redisï¼šRemote-Dictionary-Server&quot;&gt;&lt;a href=&quot;#Redisï¼šRemote-Dictionary-Server&quot; class=&quot;headerlink&quot; title=&quot;Redisï¼šRemote Dictionary Server&quot;&gt;</summary>
      
    
    
    
    <category term="æ•°æ®åº“" scheme="https://linweiyuan.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="Redis" scheme="https://linweiyuan.github.io/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>çº¿ç¨‹ç›¸å…³çŸ¥è¯†ç‚¹</title>
    <link href="https://linweiyuan.github.io/2021/10/24/%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9.html"/>
    <id>https://linweiyuan.github.io/2021/10/24/%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9.html</id>
    <published>2021-10-24T15:13:13.000Z</published>
    <updated>2022-10-04T11:01:19.613Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h1><ul><li>åˆå§‹çŠ¶æ€ new</li><li>å¯è¿è¡Œ&#x2F;è¿è¡ŒçŠ¶æ€ runnable</li><li>ä¼‘çœ çŠ¶æ€ blocked waiting timed_waiting</li><li>ç»ˆæ­¢çŠ¶æ€ terminated</li></ul><h1 id="çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå’ŒçŠ¶æ€"><a href="#çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå’ŒçŠ¶æ€" class="headerlink" title="çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå’ŒçŠ¶æ€"></a>çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå’ŒçŠ¶æ€</h1><ul><li>åˆ›å»ºï¼šnew</li><li>å°±ç»ªï¼šstart()ï¼Œå¯è¿è¡Œï¼Œç­‰å¾…è·å– CPU çš„ä½¿ç”¨æƒ</li><li>è¿è¡Œï¼šæ‰§è¡Œ</li><li>é˜»å¡ï¼šæ”¾å¼ƒ CPU ä½¿ç”¨æƒï¼Œsleepï¼Œwaitï¼ˆsleep æ˜¯ Thread çš„ï¼Œwait æ˜¯ Object çš„ï¼‰</li><li>æ­»äº¡ï¼šæ‰§è¡Œå®Œæˆ–å¼‚å¸¸é€€å‡º</li></ul><h1 id="çº¿ç¨‹çš„-run-å’Œ-start-çš„åŒºåˆ«"><a href="#çº¿ç¨‹çš„-run-å’Œ-start-çš„åŒºåˆ«" class="headerlink" title="çº¿ç¨‹çš„ run() å’Œ start() çš„åŒºåˆ«"></a>çº¿ç¨‹çš„ run() å’Œ start() çš„åŒºåˆ«</h1><p>start() æ–¹æ³•ç”¨äºå¯åŠ¨çº¿ç¨‹ï¼Œrun() æ–¹æ³•ç”¨äºæ‰§è¡Œçº¿ç¨‹çš„è¿è¡Œæ—¶ä»£ç ï¼Œrun() å¯ä»¥é‡å¤è°ƒç”¨ï¼Œè€Œ start() åªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œå¦‚æœç›´æ¥è°ƒç”¨çº¿ç¨‹çš„ run() æ–¹æ³•ï¼Œç›¸å½“äºæ‰§è¡Œä¸€ä¸ªæ™®é€šæ–¹æ³•ï¼Œä¸åœ¨æ•´ä¸ªçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¸­</p><h1 id="å¦‚ä½•åœæ­¢ä¸€ä¸ªçº¿ç¨‹"><a href="#å¦‚ä½•åœæ­¢ä¸€ä¸ªçº¿ç¨‹" class="headerlink" title="å¦‚ä½•åœæ­¢ä¸€ä¸ªçº¿ç¨‹"></a>å¦‚ä½•åœæ­¢ä¸€ä¸ªçº¿ç¨‹</h1><ul><li>ä½¿ç”¨ flag</li><li>stop()</li><li>interrupt()</li></ul><h1 id="sleep-wait-join-yield"><a href="#sleep-wait-join-yield" class="headerlink" title="sleep(), wait(), join(), yield()"></a>sleep(), wait(), join(), yield()</h1><ul><li>sleep: Thread ç±»çš„é™æ€æ–¹æ³•ï¼Œä¸ä¾èµ–äº synchronizedï¼Œä¸€èˆ¬ç”¨äºå½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œä¼šé‡Šæ”¾é”</li><li>wait: Object ç±»çš„æ™®é€šæ–¹æ³•ï¼Œä¾èµ–äº synchronizedï¼Œä¸€èˆ¬ç”¨äºå¤šçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œä¸ä¼šé‡Šæ”¾é”ï¼Œè¦ä½¿ç”¨ notify() æˆ–è€… notifyAll() å”¤é†’</li><li>yield: æ‰§è¡Œåçº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œé©¬ä¸Šé‡Šæ”¾äº† CPU çš„æ‰§è¡Œæƒï¼Œä½†æ˜¯ä¿ç•™äº† CPU çš„æ‰§è¡Œèµ„æ ¼ï¼Œå¯èƒ½åœ¨ä¸‹æ¬¡è°ƒåº¦çš„æ—¶å€™å†æ¬¡è·å¾—æ‰§è¡Œæƒ</li><li>join: æ‰§è¡Œåçº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè®© join çš„çº¿ç¨‹å…ˆæ‰§è¡Œå®Œæˆ–ä¸­æ–­</li></ul><h1 id="notify-å’Œ-notifyAll-çš„åŒºåˆ«"><a href="#notify-å’Œ-notifyAll-çš„åŒºåˆ«" class="headerlink" title="notify() å’Œ notifyAll() çš„åŒºåˆ«"></a>notify() å’Œ notifyAll() çš„åŒºåˆ«</h1><p>notify() éšæœºå”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼ŒnotifyAll() å”¤é†’æ‰€æœ‰çš„çº¿ç¨‹ï¼Œå½“ notifyAll() è°ƒç”¨åï¼Œä¼šå°†å…¨éƒ¨çº¿ç¨‹ç”±ç­‰å¾…æ± ç§»åˆ°é”æ± ï¼Œç„¶åå‚ä¸é”çš„ç«äº‰ï¼Œç«äº‰æˆåŠŸåˆ™ç»§ç»­æ‰§è¡Œï¼Œä¸æˆåŠŸåˆ™ç•™åœ¨é”æ± ç­‰å¾…é”é‡Šæ”¾åå†æ¬¡å‚ä¸ç«äº‰</p><h1 id="å®ç°å¤šçº¿ç¨‹çš„å‡ ç§æ–¹å¼"><a href="#å®ç°å¤šçº¿ç¨‹çš„å‡ ç§æ–¹å¼" class="headerlink" title="å®ç°å¤šçº¿ç¨‹çš„å‡ ç§æ–¹å¼"></a>å®ç°å¤šçº¿ç¨‹çš„å‡ ç§æ–¹å¼</h1><ul><li>ç»§æ‰¿ Thread ç±»ï¼ˆå®é™…ä¸Š Thread implements Runnableï¼‰</li><li>å®ç° Runnable æ¥å£</li><li>å®ç° Callable æ¥å£ï¼ˆé€šè¿‡ FutureTask åŒ…è£…å™¨æ¥åˆ›å»ºï¼‰</li><li>é€šè¿‡çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹ï¼Œä½¿ç”¨çº¿ç¨‹æ± æ¥å£ ExecutorService ç»“åˆ Callableï¼ŒFuture å®ç°æœ‰è¿”å›å€¼çš„å¤šçº¿ç¨‹</li></ul><p>runnable æœ‰ä¸¤ä¸ªå¼Šç«¯ï¼ˆCallable å’Œ Runnable çš„æœ€å¤§åŒºåˆ«å°±æ˜¯ Callable å¯ä»¥æœ‰è¿”å›å€¼ï¼‰ï¼š</p><ul><li>ä¸èƒ½è·å–è¿”å›ç»“æœ</li><li>ä¸èƒ½æŠ›å‡ºå¼‚å¸¸</li></ul><h1 id="å®ˆæŠ¤çº¿ç¨‹"><a href="#å®ˆæŠ¤çº¿ç¨‹" class="headerlink" title="å®ˆæŠ¤çº¿ç¨‹"></a>å®ˆæŠ¤çº¿ç¨‹</h1><p>å®ˆæŠ¤çº¿ç¨‹æ˜¯è¿è¡Œåœ¨åå°çš„ä¸€ç§ç‰¹æ®Šè¿›ç¨‹ï¼Œä¸ºæ‰€æœ‰éå®ˆæŠ¤çº¿ç¨‹æä¾›æœåŠ¡ï¼Œæ¯”å¦‚ GC çº¿ç¨‹å°±æ˜¯ç‰¹æ®Šçš„å®ˆæŠ¤çº¿ç¨‹</p><p>ç”¨æ³•æ³¨æ„ï¼šthread.setDaemon(true) å¿…é¡»åœ¨ thread.start() ä¹‹å‰è®¾ç½®ï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ IllegalThreadStateExceptionï¼Œå› ä¸ºä¸èƒ½æŠŠæ­£åœ¨è¿è¡Œçš„å¸¸è§„çº¿ç¨‹è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹</p><h1 id="ThreadLocal"><a href="#ThreadLocal" class="headerlink" title="ThreadLocal"></a>ThreadLocal</h1><p>ThreadLocal ä¸æ˜¯å¤šçº¿ç¨‹åŒæ­¥æœºåˆ¶ä¸­çš„ä¸€ç§ï¼Œè€Œæ˜¯ä¸€ç§è§£å†³æ€è·¯ï¼Œå®ƒè§£å†³çš„æ˜¯å¤šçº¿ç¨‹ä¸‹æˆå‘˜å˜é‡çš„å®‰å…¨é—®é¢˜ï¼Œä¸æ˜¯å…±äº«å˜é‡çš„å®‰å…¨é—®é¢˜</p><p>çº¿ç¨‹åŒæ­¥æœºåˆ¶æ˜¯å¤šä¸ªçº¿ç¨‹å…±äº«ä¸€ä¸ªå˜é‡ï¼Œè€Œ ThreadLocal æ˜¯æ¯ä¸ªçº¿ç¨‹åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„å•ç‹¬å˜é‡å‰¯æœ¬ï¼Œæ‰€ä»¥æ¯ä¸ªçº¿ç¨‹éƒ½å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜è‡ªå·±çš„å˜é‡å‰¯æœ¬ï¼Œè€Œä¸ä¼šå½±å“åˆ°å…¶ä»–çº¿ç¨‹çš„å˜é‡å‰¯æœ¬</p><p>ThreadLocal å†…éƒ¨æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„å†…éƒ¨ç±»ï¼š<code>ThreadLocalMap</code>ï¼Œæ˜¯çœŸæ­£å®ç°çº¿ç¨‹éš”ç¦»æœºåˆ¶çš„å…³é”®ï¼ŒThreadLocalMap å†…éƒ¨ç»“æ„ç±»ä¼¼äº Mapï¼Œç”±é”®å€¼å¯¹ key å’Œ value ç»„æˆä¸€ä¸ª entryï¼Œkey ä¸º ThreadLocal æœ¬èº«ï¼Œvalue æ˜¯å¯¹åº”çš„çº¿ç¨‹å˜é‡å‰¯æœ¬ï¼ˆé¦–å…ˆæ˜¯ Threadï¼ŒThread é‡Œé¢æœ‰ ThreadLocal.ThreadLocalMapï¼ŒMap çš„è¯å­˜å‚¨çš„æ˜¯ Entry é›†åˆï¼Œæ¯ä¸€ä¸ª Entry çš„ key ä¸º ThreadLocalï¼Œvalue ä¸ºå…·ä½“çš„å€¼ï¼‰</p><p>æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„</p><ul><li>ThreadLocal æœ¬èº«ä¸å­˜å‚¨å€¼ï¼Œå®ƒåªæ˜¯æä¾›ä¸€ä¸ªæŸ¥æ‰¾åˆ°å€¼çš„ key</li><li>ThreadLocal åŒ…å«åœ¨ Thread ä¸­ï¼Œä¸æ˜¯ Thread åŒ…å«åœ¨ ThreadLocal ä¸­</li></ul><p>ThreadLocalMap å’Œ HashMap çš„åŠŸèƒ½ç±»ä¼¼ï¼Œä½†æ˜¯å®ç°ä¸Šå´æœ‰å¾ˆå¤§çš„ä¸åŒï¼š</p><ul><li>HashMap çš„æ•°æ®ç»“æ„æ˜¯æ•°ç»„ + é“¾è¡¨</li><li>ThreadLocalMap çš„æ•°æ®ç»“æ„ä»…ä»…æ˜¯æ•°ç»„</li><li>HashMap æ˜¯é€šè¿‡é“¾åœ°å€æ³•æ¥è§£å†³å“ˆå¸Œå†²çªï¼ŒThreadLocalMap æ˜¯é€šè¿‡å¼€æ”¾åœ°å€æ³•æ¥è§£å†³å“ˆå¸Œå†²çªï¼ˆé“¾åœ°å€ï¼šæ•°ç»„åŠ é“¾è¡¨ï¼Œå¼€æ”¾åœ°å€ï¼šå¯»æ‰¾ç©ºçš„ä½ç½®ï¼‰</li><li>HashMap é‡Œé¢çš„ Entry å†…éƒ¨ç±»çš„å¼•ç”¨éƒ½æ˜¯å¼ºå¼•ç”¨ï¼ŒThreadLocalMap é‡Œé¢çš„ Entry å†…éƒ¨ç±»ä¸­çš„ key æ˜¯å¼±å¼•ç”¨ï¼Œvalue æ˜¯å¼ºå¼•ç”¨</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Entry</span> <span class="keyword">extends</span> <span class="title class_">WeakReference</span>&lt;ThreadLocal&lt;?&gt;&gt;</span><br></pre></td></tr></table></figure><p>ä»æºç å¯ä»¥çœ‹å‡º ThreadLocal.ThreadLocalMap.Entry ä¸­ä½¿ç”¨çš„ key ä¸º ThreadLocal çš„å¼±å¼•ç”¨ï¼Œè€Œ value æ˜¯å¼ºå¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ ThreadLocal æ²¡æœ‰è¢«å¤–éƒ¨å¼ºå¼•ç”¨çš„æƒ…å†µä¸‹ï¼Œåœ¨åƒåœ¾å›æ”¶çš„æ—¶å€™ key ä¼šè¢«æ¸…ç†æ‰ï¼Œè€Œ value ä¸ä¼šè¢«æ¸…ç†ï¼Œè¿™æ ·ä¸€æ¥ï¼ŒThreadLocalMap ä¸­å°±ä¼šå‡ºç° key çš„ null çš„ Entryï¼Œå‡å¦‚ä¸åšä»»ä½•æªæ–½çš„è¯ï¼Œvalue æ°¸è¿œæ— æ³•è¢« GCï¼Œè¿™ä¸ªæ—¶å€™å°±å¯èƒ½äº§ç”Ÿå†…å­˜æ³„æ¼</p><p>å¦‚ä½•é¿å…å†…å­˜æ³„æ¼ï¼Ÿ</p><p>å½“ä¸€ä¸ªå˜é‡ä¸ç”¨çš„æ—¶å€™ï¼Œè¦è°ƒç”¨ remove() åˆ é™¤æ‰ï¼ˆå†…éƒ¨è°ƒç”¨äº† expungeStaleEntry()ï¼Œå°† value è®¾ä¸º nullï¼Œè¿™æ ·ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶å°±ä¼šè¢«å½»åº•å›æ”¶æ‰ï¼‰</p><h1 id="CAS"><a href="#CAS" class="headerlink" title="CAS"></a>CAS</h1><p>CAS å…¨ç§° Compare And Swapï¼Œæ¯”è¾ƒå¹¶äº¤æ¢ï¼Œæ˜¯ä¸€æ¡ CPU çš„å¹¶å‘åŸè¯­</p><p>åŸè¯­çš„æ‰§è¡Œå¿…é¡»æ˜¯è¿ç»­çš„ï¼Œåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ä¸å…è®¸è¢«ä¸­æ–­ï¼Œå› æ­¤ä¸ä¼šé€ æˆæ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œå…·æœ‰åŸå­æ€§ã€‚CAS æ˜¯ä¸€ç§é‡è¦çš„åŒæ­¥æ€æƒ³ï¼Œåˆ¤æ–­å†…å­˜ä¸­çš„å€¼æ˜¯å¦å’Œé¢„æœŸçš„å€¼ä¸€æ ·ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å°†å†…å­˜ä¸­çš„å€¼æ›´æ–°ä¸ºæ–°å€¼ï¼Œå¦åˆ™ä¼šä¸æ–­é‡è¯•ï¼Œç›´åˆ°ä¸€è‡´ä¸ºæ­¢</p><p>ABA é—®é¢˜</p><p>æ¯”è¾ƒå¹¶äº¤æ¢çš„å¾ªç¯ï¼Œå­˜åœ¨ä¸€ä¸ªæ—¶é—´å·®ï¼Œè€Œè¿™ä¸ªæ—¶é—´å·®å¯èƒ½å¸¦æ¥æ„æƒ³ä¸åˆ°çš„é—®é¢˜</p><p>æ¯”å¦‚ä¸¤ä¸ªçº¿ç¨‹ A å’Œ B</p><ul><li>ä¸€å¼€å§‹éƒ½ä»ä¸»å†…å­˜ä¸­æ‹·è´äº†åŸå€¼ä¸º 1</li><li>çº¿ç¨‹ A æ‰§æ‹¿åˆ°å€¼ä¸º 1 ç„¶åæŒ‚èµ·</li><li>çº¿ç¨‹ B ä¿®æ”¹å€¼ä¸º 2ï¼Œæ‰§è¡Œå®Œæ¯•</li><li>çº¿ç¨‹ B è§‰å¾—ä¿®æ”¹é”™è¯¯ï¼ŒæŠŠå€¼é‡æ–°è®¾ç½®ä¸º 1ï¼Œ</li><li>çº¿ç¨‹ A è¢«å”¤é†’ï¼Œæ¯”è¾ƒå‘ç°å†…å­˜ä¸­çš„å€¼å’Œé¢„æœŸçš„å€¼ä¸€æ ·ï¼Œä¿®æ”¹æˆåŠŸï¼ˆä½†æ˜¯ä¸çŸ¥é“è¿™ä¸ªå€¼å·²ç»è¢« B ä¿®æ”¹è¿‡äº†ï¼‰</li></ul><p>å°½ç®¡çº¿ç¨‹ A CAS æ“ä½œæˆåŠŸï¼Œä½†ä¸ä»£è¡¨æ²¡æœ‰é—®é¢˜ï¼Œæœ‰çš„éœ€æ±‚ï¼Œåªæ³¨é‡å¤´å’Œå°¾ï¼Œåªè¦é¦–å°¾ä¸€è‡´ï¼Œå°±æ¥å—ï¼Œä½†æ˜¯æœ‰çš„éœ€æ±‚ï¼Œè¿˜çœ‹é‡è¿‡ç¨‹ï¼Œä¸­é—´ä¸èƒ½å‘ç”Ÿä»»ä½•ä¿®æ”¹ï¼Œè¿™å°±å¼•å‡ºäº† AtomicStampedReference åŸå­å¼•ç”¨</p><p>AtomicStampedReference å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªç‰ˆæœ¬å· <code>stamp</code>ï¼Œåœ¨è¿›è¡Œ CAS æ“ä½œçš„æ—¶å€™ï¼Œä¸ä»…è¦æ¯”è¾ƒå½“å‰å€¼ï¼Œè¿˜è¦æ¯”è¾ƒç‰ˆæœ¬å·ï¼Œåªæœ‰ä¸¤è€…éƒ½ç›¸ç­‰ï¼Œæ‰æ‰§è¡Œæ›´æ–°æ“ä½œï¼ˆæœ‰ç‚¹ç±»ä¼¼ä¹è§‚é”ï¼‰</p><p>ä»»ä½•æŠ€æœ¯éƒ½ä¸æ˜¯å®Œç¾çš„ï¼ŒCAS ä¹Ÿæœ‰è‡ªå·±çš„ç¼ºç‚¹ï¼ŒCAS å®é™…ä¸Šæ˜¯ä¸€ç§è‡ªæ—‹é”</p><ul><li>ä¸€ç›´å¾ªç¯ï¼Œå¼€é”€æ¯”è¾ƒå¤§</li><li>åªèƒ½ä¿è¯ä¸€ä¸ªå˜é‡çš„åŸå­æ“ä½œï¼Œå¤šä¸ªå˜é‡ä¾ç„¶è¦åŠ é”</li><li>å¼•å‡ºäº† ABA é—®é¢˜ï¼ˆAtomicStampedReference å¯è§£å†³ï¼‰</li></ul><p>CAS çš„ä½¿ç”¨åœºæ™¯é€‚åˆåœ¨ä¸€äº›å¹¶å‘é‡ä¸é«˜ï¼Œçº¿ç¨‹ç«äº‰è¾ƒå°‘çš„æƒ…å†µï¼Œä½†æ˜¯ä¸€æ—¦çº¿ç¨‹å†²çªä¸¥é‡çš„æƒ…å†µï¼Œå¾ªç¯æ—¶é—´å¤ªé•¿ï¼Œä¼šç»™ CPU å¸¦æ¥å¾ˆå¤§çš„å¼€é”€</p><h1 id="çº¿ç¨‹æ± "><a href="#çº¿ç¨‹æ± " class="headerlink" title="çº¿ç¨‹æ± "></a>çº¿ç¨‹æ± </h1><h2 id="å¦‚ä½•åˆ›å»ºçº¿ç¨‹æ± ï¼Ÿ"><a href="#å¦‚ä½•åˆ›å»ºçº¿ç¨‹æ± ï¼Ÿ" class="headerlink" title="å¦‚ä½•åˆ›å»ºçº¿ç¨‹æ± ï¼Ÿ"></a>å¦‚ä½•åˆ›å»ºçº¿ç¨‹æ± ï¼Ÿ</h2><p>JDK ä¸­æä¾›äº†åˆ›å»ºçº¿ç¨‹æ± çš„ç±»ï¼Œ<code>Executors</code>ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸æ¨è</p><p>Executors ç±»åªæ˜¯ä¸ªé™æ€å·¥å‚ï¼Œæä¾›åˆ›å»ºçº¿ç¨‹æ± çš„å‡ ä¸ªé™æ€æ–¹æ³•ï¼ˆå†…éƒ¨å±è”½äº†çº¿ç¨‹æ± å‚æ•°é…ç½®ç»†èŠ‚ï¼‰ï¼Œè€ŒçœŸæ­£çš„çº¿ç¨‹æ± ç±»æ˜¯ <code>ThreadPoolExecutor</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">ThreadPoolExecutor</span><span class="params">(</span></span><br><span class="line"><span class="params">  <span class="type">int</span> corePoolSizeï¼Œ</span></span><br><span class="line"><span class="params">  <span class="type">int</span> maximumPoolSizeï¼Œ</span></span><br><span class="line"><span class="params">  <span class="type">long</span> keepAliveTimeï¼Œ</span></span><br><span class="line"><span class="params">  TimeUnit unitï¼Œ</span></span><br><span class="line"><span class="params">  BlockingQueue&lt;Runnable&gt; workQueueï¼Œ</span></span><br><span class="line"><span class="params">  ThreadFactory threadFactoryï¼Œ</span></span><br><span class="line"><span class="params">  RejectedExecutionHandler handler</span></span><br><span class="line"><span class="params">)</span></span><br></pre></td></tr></table></figure><p>æ ¸å¿ƒå‚æ•°ï¼š</p><ul><li>corePoolSizeï¼šæ ¸å¿ƒçº¿ç¨‹æ•°ã€‚å¦‚æœç­‰äº 0ï¼Œåˆ™ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œæ²¡æœ‰ä»»åŠ¡è¯·æ±‚è¿›å…¥æ—¶ï¼Œé”€æ¯çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ã€‚å¦‚æœå¤§äº 0ï¼Œå³ä½¿æœ¬åœ°ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ ¸å¿ƒçº¿ç¨‹ä¹Ÿä¸ä¼šè¢«é”€æ¯ã€‚è®¾ç½®å¾—è¿‡å¤§ä¼šæµªè´¹ç³»ç»Ÿèµ„æºï¼Œè®¾ç½®è¿‡å°ä¼šå¯¼è‡´çº¿ç¨‹é¢‘ç¹åˆ›å»º</li><li>maximumPoolSizeï¼šæœ€å¤§çº¿ç¨‹æ•°ã€‚å¿…é¡»å¤§äºç­‰äº 1ï¼Œä¸”å¤§äºç­‰äº corePoolSizeã€‚å¦‚æœä¸ corePoolSize ç›¸ç­‰ï¼Œåˆ™çº¿ç¨‹æ± å¤§å°å›ºå®šã€‚å¦‚æœå¤§äº corePoolSizeï¼Œåˆ™æœ€å¤šåˆ›å»º maximumPoolSize ä¸ªçº¿ç¨‹æ‰§è¡Œä»»åŠ¡</li><li>keepAliveTimeï¼šçº¿ç¨‹ç©ºé—²æ—¶é—´ã€‚çº¿ç¨‹æ± ä¸­çº¿ç¨‹ç©ºé—²æ—¶é—´è¾¾åˆ° keepAliveTime å€¼æ—¶ï¼Œçº¿ç¨‹ä¼šè¢«é”€æ¯ï¼Œç›´åˆ°å‰©ä¸‹ corePoolSize ä¸ªçº¿ç¨‹ä¸ºæ­¢ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°å¤§äº corePoolSize æ—¶ï¼ŒkeepAliveTime æ‰ä¼šèµ·ä½œç”¨ã€‚å¦‚æœ allowCoreThreadTimeOut è¢«è®¾ç½®ä¸º trueï¼Œå³ä½¿çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°ç­‰äº corePoolSizeï¼ŒkeepAliveTime ä¹Ÿä¼šèµ·ä½œç”¨ï¼ˆå›æ”¶è¶…æ—¶çš„æ ¸å¿ƒçº¿ç¨‹ï¼‰</li><li>unitï¼šTimeUnit è¡¨ç¤ºæ—¶é—´å•ä½</li><li>workQueueï¼šç¼“å­˜é˜Ÿåˆ—ã€‚å½“è¯·æ±‚çº¿ç¨‹æ•°å¤§äº corePoolSize æ—¶ï¼Œçº¿ç¨‹è¿›å…¥ BlockingQueue é˜»å¡é˜Ÿåˆ—</li><li>threadFactoryï¼šçº¿ç¨‹å·¥å‚ã€‚ç”¨æ¥ç”Ÿäº§ä¸€ç»„ç›¸åŒä»»åŠ¡çš„çº¿ç¨‹ã€‚ä¸»è¦ç”¨äºè®¾ç½®ç”Ÿæˆçš„çº¿ç¨‹åè¯å‰ç¼€ï¼Œæ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ä»¥åŠçº¿ç¨‹çš„ä¼˜å…ˆçº§ç­‰ã€‚è®¾ç½®æœ‰æ„ä¹‰çš„åç§°å‰ç¼€å¯ä»¥å¾ˆå¿«çŸ¥é“çº¿ç¨‹æ˜¯ç”±å“ªä¸ªçº¿ç¨‹å·¥å‚åˆ›å»ºçš„ï¼Œæ–¹ä¾¿è°ƒè¯•</li><li>handlerï¼šæ‰§è¡Œæ‹’ç»ç­–ç•¥å¯¹è±¡ã€‚å½“ä»»åŠ¡æ•°è¾¾åˆ°ç¼“å­˜ä¸Šé™æ—¶ï¼ˆå³è¶…è¿‡ workQueue å‚æ•°èƒ½å­˜å‚¨çš„ä»»åŠ¡æ•°ï¼‰ï¼Œæ‰§è¡Œæ‹’ç»ç­–ç•¥ï¼Œç›¸å½“äºé™æµä¿æŠ¤</li></ul><p>ä¸Šé¢å¤æ‚æ¦‚å¿µçš„ç®€æ´æè¿°ï¼š</p><ul><li>å¦‚æœçº¿ç¨‹æ± å½“å‰çŠ¶æ€ä¸æ˜¯ runningï¼Œç›´æ¥æ‹’ç»</li><li>å¦‚æœ worker &lt; poolï¼Œåˆ›å»ºæ–°çº¿ç¨‹</li><li>å¦‚æœ worker &gt;&#x3D; poolï¼Œqueue æœªæ»¡ï¼Œå°†ä»»åŠ¡æ·»åŠ åˆ° queue</li><li>å¦‚æœ pool &lt;&#x3D; worker &lt; maxï¼Œå¹¶ä¸” queue å·²æ»¡ï¼Œå¼€å¯æ–°çº¿ç¨‹</li><li>å¦‚æœ worker &gt; maxï¼Œå¹¶ä¸” queue å·²æ»¡ï¼Œæ‹’ç»ç­–ç•¥ï¼ˆé»˜è®¤ç›´æ¥æŠ›å¼‚å¸¸ï¼‰</li></ul><h2 id="çº¿ç¨‹æ± ç§ç±»"><a href="#çº¿ç¨‹æ± ç§ç±»" class="headerlink" title="çº¿ç¨‹æ± ç§ç±»"></a>çº¿ç¨‹æ± ç§ç±»</h2><ul><li>FixedThreadPoolï¼šå›ºå®šé•¿åº¦çš„çº¿ç¨‹æ± ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°ç­‰äºæœ€å¤§çº¿ç¨‹æ•°ï¼Œä¸å­˜åœ¨ç©ºé—²çº¿ç¨‹ï¼ŒkeepAliveTime ä¸º 0ï¼Œå¯ä»¥æ§åˆ¶çº¿ç¨‹çš„æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šæ”¾åˆ°é˜Ÿåˆ—ä¸­</li><li>SingleThreadExecutorï¼šå•çº¿ç¨‹çº¿ç¨‹æ± ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°å’Œæœ€å¤§çº¿ç¨‹æ•°éƒ½æ˜¯ 1ï¼Œå®ƒåªä¼šç”¨å”¯ä¸€çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œç›¸å½“äºä¸²è¡Œæ‰§è¡Œï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šæ”¾åˆ°é˜Ÿåˆ—ä¸­</li><li>CachedThreadPoolï¼šå¯ç¼“å­˜çš„çº¿ç¨‹æ± ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°ä¸º 0ï¼Œæœ€å¤§çº¿ç¨‹æ•°ä¸º Integer.MAX_VALUEï¼Œå¦‚æœæ•°æ®è¿‡å¤šï¼Œå®ƒä¼šä¸æ–­åœ°åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œå­˜åœ¨ OOM é£é™©ï¼ŒkeepAliveTime ä¸º 60ï¼Œå·¥ä½œçº¿ç¨‹å¤„äºç©ºé—²çŠ¶æ€è¶…è¿‡ keepAliveTime ä¼šå›æ”¶çº¿ç¨‹</li><li>WorkStealingPoolï¼šJDK 1.8 å¼•å…¥ï¼Œæ ¸å¿ƒæ˜¯å·¥ä½œçªƒå–ï¼Œæ²¡æ€ä¹ˆè§äººç”¨è¿‡</li><li>ScheduledThreadPoolï¼šç”¨äºå®šæ—¶æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹æ± </li></ul><p>ç¦æ­¢ç›´æ¥ä½¿ç”¨ Executors åˆ›å»ºçº¿ç¨‹æ± çš„åŸå› ï¼ˆé™¤ Executors.newWorkStealingPool æ–¹æ³•ä¹‹å¤–ï¼Œå…¶ä»–æ–¹æ³•éƒ½æœ‰ OOM é£é™©ï¼‰ï¼š</p><ul><li>Executors.newCachedThreadPool å’Œ Executors.newScheduledThreadPool ä¸¤ä¸ªæ–¹æ³•æœ€å¤§çº¿ç¨‹æ•°ä¸º Integer.MAX_VALUEï¼Œå¦‚æœçº¿ç¨‹æ•°å¤ªå¤šï¼Œä¼šæœ‰ OOM çš„é£é™©</li><li>Executors.newSingleThreadPool å’Œ Executors.newFixedThreadPool ä¸¤ä¸ªæ–¹æ³•çš„ workQueue å‚æ•°ä¸º LinkedBlockingQueueï¼Œå®¹é‡ä¸º Integer.MAX_VALUEï¼Œå¦‚æœç¬é—´è¯·æ±‚è¿‡å¤§ï¼Œå¯¼è‡´é˜Ÿåˆ—ä¸­ä»»åŠ¡è¿‡å¤šï¼Œä¼šæœ‰ OOM é£é™©</li></ul><h2 id="çº¿ç¨‹æ± æ‹’ç»ç­–ç•¥"><a href="#çº¿ç¨‹æ± æ‹’ç»ç­–ç•¥" class="headerlink" title="çº¿ç¨‹æ± æ‹’ç»ç­–ç•¥"></a>çº¿ç¨‹æ± æ‹’ç»ç­–ç•¥</h2><p>ThreadPoolExecutor æä¾›äº†å››ä¸ªå…¬å¼€çš„é™æ€å†…éƒ¨ç±»ï¼š</p><ul><li>AbortPolicyï¼šé»˜è®¤ï¼Œä¸¢å¼ƒä»»åŠ¡å¹¶æŠ›å‡º RejectedExecutionException</li><li>DiscardPolicyï¼šä¸¢å¼ƒä»»åŠ¡ï¼Œä½†æ˜¯ä¸æŠ›å‡ºå¼‚å¸¸ï¼ˆä¸æ¨èï¼‰</li><li>DiscardOldestPolicyï¼šä¸¢å¼ƒé˜Ÿåˆ—ä¸­ç­‰å¾…æœ€ä¹…çš„ä»»åŠ¡ï¼Œç„¶åæŠŠå½“å‰çš„æ–°ä»»åŠ¡åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­</li><li>CallerRunsPolicyï¼šè°ƒç”¨ä»»åŠ¡çš„ run() æ–¹æ³•ç»•è¿‡çº¿ç¨‹æ± ç›´æ¥æ‰§è¡Œ</li></ul><h2 id="å¦‚ä½•è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥"><a href="#å¦‚ä½•è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥" class="headerlink" title="å¦‚ä½•è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥"></a>å¦‚ä½•è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥</h2><p>å®ç° RejectedExecutionHandler æ¥å£æˆ–ç»§æ‰¿å·²æœ‰ç­–ç•¥ï¼Œé‡å†™ rejectedExecution() æ–¹æ³•</p><h2 id="ä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± "><a href="#ä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± " class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± "></a>ä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± </h2><p>çº¿ç¨‹æ± ï¼Œæ•°æ®åº“è¿æ¥æ± ï¼ŒHTTP è¿æ¥æ± ç­‰éƒ½å±äºæ± åŒ–æŠ€æœ¯ï¼Œä¸»è¦æ˜¯ä¸ºäº†å‡å°‘æ¯æ¬¡è·å–èµ„æºçš„æ¶ˆè€—ï¼Œæé«˜å¯¹èµ„æºçš„åˆ©ç”¨ç‡ã€‚çº¿ç¨‹æ± æä¾›äº†ä¸€ç§é™åˆ¶å’Œç®¡ç†èµ„æºï¼ˆåŒ…æ‹¬æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼‰ï¼Œæ¯ä¸ªçº¿ç¨‹æ± è¿˜ç»´æŠ¤ä¸€äº›åŸºæœ¬ç»Ÿè®¡ä¿¡æ¯ä¾‹å¦‚å·²å®Œæˆä»»åŠ¡çš„æ•°é‡</p><ul><li>é™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—</li><li>æé«˜ç›¸åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰å¾…çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œ</li><li>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶åœ°åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åŸºæœ¬æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#åŸºæœ¬æ¦‚å¿µ&quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬æ¦‚å¿µ&quot;&gt;&lt;/a&gt;åŸºæœ¬æ¦‚å¿µ&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;åˆå§‹çŠ¶æ€ new&lt;/li&gt;
&lt;li&gt;å¯è¿è¡Œ&amp;#x2F;è¿è¡ŒçŠ¶æ€ runnable&lt;/li&gt;
&lt;li&gt;ä¼‘çœ çŠ¶æ€ b</summary>
      
    
    
    
    <category term="ç¨‹åºè®¾è®¡" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    
    
    <category term="Java" scheme="https://linweiyuan.github.io/tags/Java/"/>
    
    <category term="Thread" scheme="https://linweiyuan.github.io/tags/Thread/"/>
    
  </entry>
  
  <entry>
    <title>JVMç›¸å…³çŸ¥è¯†ç‚¹</title>
    <link href="https://linweiyuan.github.io/2021/10/01/JVM%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9.html"/>
    <id>https://linweiyuan.github.io/2021/10/01/JVM%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9.html</id>
    <published>2021-10-01T13:53:27.000Z</published>
    <updated>2022-10-04T11:01:19.593Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram-Counter-Registerï¼‰"><a href="#ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram-Counter-Registerï¼‰" class="headerlink" title="ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰"></a>ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰</h1><p>ç¨‹åºè®¡æ•°å™¨é‡Œé¢å­˜æ”¾çš„æ˜¯ä¸‹ä¸€æ¡ JVM æŒ‡ä»¤ä»£ç çš„æ‰§è¡Œåœ°å€ï¼Œæ¦‚å¿µä¸Šæœ‰ç‚¹ç±»ä¼¼æ•°æ®åº“ç»“æœé›†éå†æ—¶çš„æ¸¸æ ‡ï¼Œä¸æ–­æŒ‡å‘ä¸‹ä¸€æ¡ï¼Œç‰©ç†ä¸Šæ˜¯é€šè¿‡å¯„å­˜å™¨å®ç°çš„ï¼Œå¯„å­˜åŒºåœ¨ CPU ä¸Šæ˜¯éå¸¸å¿«çš„å•å…ƒ</p><p>åœ¨ JVM çš„è§„èŒƒä¸­ï¼Œæ¯æ¡çº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œæ‰€ä»¥ç¨‹åºè®¡æ•°å™¨æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œå› ä¸ºå½“å‘ç”Ÿçº¿ç¨‹åˆ‡æ¢çš„æ—¶å€™ï¼Œéœ€è¦çŸ¥é“åˆ‡æ¢å›æ¥åä¸‹ä¸€æ­¥åº”è¯¥æ‰§è¡Œä»€ä¹ˆæ“ä½œï¼Œå¦‚æœä¸æ˜¯çº¿ç¨‹ç§æœ‰åˆ™ä¼šé€ æˆæ··ä¹±</p><p>ç¨‹åºè®¡æ•°å™¨æ˜¯ JVM ä¸­å”¯ä¸€ä¸ä¼šå­˜åœ¨ OOM çš„åŒºåŸŸï¼Œè¿™ä¸€ç‚¹æ˜¯ JVM è§„èŒƒä¸Šè¦æ±‚çš„</p><hr><h1 id="è™šæ‹Ÿæœºæ ˆ"><a href="#è™šæ‹Ÿæœºæ ˆ" class="headerlink" title="è™šæ‹Ÿæœºæ ˆ"></a>è™šæ‹Ÿæœºæ ˆ</h1><p>è¯´è™šæ‹Ÿæœºæ ˆä¹‹å‰å…ˆè¯´æ ˆï¼Œæ ˆçš„ç‰¹ç‚¹å°±æ˜¯å…ˆè¿›åå‡ºæˆ–åè¿›å…ˆå‡º</p><p>è™šæ‹Ÿæœºæ ˆæ˜¯çº¿ç¨‹è¿è¡Œæ—¶éœ€è¦çš„å†…å­˜ç©ºé—´ï¼Œçº¿ç¨‹è¿è¡Œçš„ç›®çš„æ˜¯ä¸ºäº†æ‰§è¡Œä»£ç ï¼Œä»£ç ç”±ä¸€ä¸ªä¸ªæ–¹æ³•ç»„æˆï¼Œå½“çº¿ç¨‹è¿è¡Œçš„æ—¶å€™ï¼Œæ¯ä¸ªæ–¹æ³•éœ€è¦çš„å†…å­˜ç©ºé—´å°±æ˜¯æ ˆå¸§ï¼ˆå‚æ•°ï¼Œå±€éƒ¨å˜é‡ï¼Œè¿”å›åœ°å€ï¼‰ï¼Œæ¯ä¸ªæ ˆç”±å¤šä¸ªæ ˆå¸§ç»„æˆï¼Œå¯¹åº”ç€æ¯æ¬¡æ–¹æ³•è°ƒç”¨æ—¶æ‰€å ç”¨çš„å†…å­˜ï¼Œè°ƒç”¨æ–¹æ³•æ—¶å…¥æ ˆï¼Œæ‰§è¡Œå®Œå‡ºæ ˆï¼Œæ¯ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸€ä¸ªæ´»åŠ¨æ ˆå¸§ï¼Œå¯¹åº”ç€å½“å‰æ­£åœ¨æ‰§è¡Œçš„é‚£ä¸ªæ–¹æ³•ï¼ˆæ ˆé¡¶éƒ¨ï¼‰ï¼Œæ ˆæ˜¯æœ‰ä¸€å®šçš„æ·±åº¦çš„ï¼Œå½“å‘ç”Ÿé€’å½’æ­»å¾ªç¯æ—¶ï¼Œä¸€ç›´æœ‰æ–¹æ³•å…¥æ ˆä½†ä¸å‡ºæ ˆï¼Œå¯¼è‡´æ ˆæº¢å‡ºï¼ŒæŠ›å‡º <code>java.lang.StackOverflowError</code></p><p>IDEA debug æ—¶å·¦ä¸‹è§’çš„ Frame å°±æ˜¯æ ˆå¸§ï¼Œæ¯”è¾ƒç›´è§‚ï¼Œä»ä¸Šåˆ°ä¸‹ï¼Œå³è¾¹è¿˜å¯ä»¥çœ‹åˆ°æ ˆå†…çš„å±€éƒ¨å˜é‡å€¼</p><h2 id="åƒåœ¾å›æ”¶æ˜¯å¦æ¶‰åŠæ ˆå†…å­˜"><a href="#åƒåœ¾å›æ”¶æ˜¯å¦æ¶‰åŠæ ˆå†…å­˜" class="headerlink" title="åƒåœ¾å›æ”¶æ˜¯å¦æ¶‰åŠæ ˆå†…å­˜"></a>åƒåœ¾å›æ”¶æ˜¯å¦æ¶‰åŠæ ˆå†…å­˜</h2><p>ä¸ä¼š</p><p>æ ˆå†…å­˜éšç€å‡ºæ ˆå°±é‡Šæ”¾æ‰ï¼Œåƒåœ¾å›æ”¶ä¸»è¦ç”¨æ¥å›æ”¶å †å†…å­˜</p><h2 id="æ ˆå†…å­˜åˆ†é…è¶Šå¤§è¶Šå¥½å—"><a href="#æ ˆå†…å­˜åˆ†é…è¶Šå¤§è¶Šå¥½å—" class="headerlink" title="æ ˆå†…å­˜åˆ†é…è¶Šå¤§è¶Šå¥½å—"></a>æ ˆå†…å­˜åˆ†é…è¶Šå¤§è¶Šå¥½å—</h2><p>ä¸æ˜¯</p><p>-Xss sizeï¼ˆæ¯”å¦‚-Xss1mï¼Œæ²¡æœ‰ç­‰å·ï¼‰</p><p>Windows ä¸‹å–å†³äºè™šæ‹Ÿå†…å­˜çš„è®¾ç½®ï¼Œå…¶ä»–ä¸»æµæ“ä½œç³»ç»Ÿä¸Šé»˜è®¤ä¸º 1024KBï¼ˆ1MBï¼‰</p><p>ç‰©ç†å†…å­˜çš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œæ ˆå†…å­˜åˆ†é…è®¾ç½®å¾—è¶Šå¤§ï¼Œå ç”¨è¶Šå¤šå†…å­˜ï¼Œç”±äºæ ˆæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œæ‰€ä»¥çº¿ç¨‹å ç”¨çš„å†…å­˜å°±ä¼šå˜å¤§ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿå¯ä»¥åˆ›å»ºçš„æ€»çº¿ç¨‹æ•°å°±ä¼šå˜å°</p><p>æ¯”å¦‚æ“ä½œç³»ç»Ÿ 10M å†…å­˜ï¼ˆåªæ˜¯ä¸¾ä¾‹ï¼‰ï¼Œæœ¬æ¥ä¸€ä¸ªçº¿ç¨‹é»˜è®¤å ç”¨ 1M å†…å­˜ï¼Œé‚£ä¹ˆå¯ä»¥åˆ›å»º 10 ä¸ªçº¿ç¨‹ï¼Œä½†è®¾ç½®-Xss2m åï¼Œåªèƒ½åˆ›å»º 5 ä¸ªçº¿ç¨‹äº†</p><p>-Xss è®¾ç½®å¾—å¤§ï¼Œåªä¼šå¢åŠ æ–¹æ³•é€’å½’è°ƒç”¨çš„æ¬¡æ•°ï¼Œä¸€èˆ¬ä¸ä¼šæå‡æ€§èƒ½ï¼Œå°±æ˜¯ä¸å®¹æ˜“çˆ†æ ˆï¼Œä½†æ­»å¾ªç¯é€’å½’è¯¥çˆ†è¿˜å¾—çˆ†</p><h2 id="æ–¹æ³•å†…çš„å±€éƒ¨å˜é‡æ˜¯å¦çº¿ç¨‹å®‰å…¨"><a href="#æ–¹æ³•å†…çš„å±€éƒ¨å˜é‡æ˜¯å¦çº¿ç¨‹å®‰å…¨" class="headerlink" title="æ–¹æ³•å†…çš„å±€éƒ¨å˜é‡æ˜¯å¦çº¿ç¨‹å®‰å…¨"></a>æ–¹æ³•å†…çš„å±€éƒ¨å˜é‡æ˜¯å¦çº¿ç¨‹å®‰å…¨</h2><p>æ˜¯</p><p>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ç§æœ‰çš„æ ˆå¸§ï¼Œé‡Œé¢ä¼šæœ‰å„è‡ªç‹¬ç«‹çš„å˜é‡ï¼Œäº’ä¸å¹²æ‰°ã€‚çº¿ç¨‹å®‰å…¨é—®é¢˜å‡ºç°åœ¨å…±äº«å˜é‡ä¸Šï¼Œå¦‚æœæ–¹æ³•å†…å±€éƒ¨å˜é‡æ²¡æœ‰é€ƒç¦»æ–¹æ³•çš„ä½œç”¨èŒƒå›´ï¼Œé‚£ä¹ˆè¿™ä¸ªå±€éƒ¨å˜é‡å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„</p><h2 id="çº¿ä¸Šè¯Šæ–­æ–¹æ³•"><a href="#çº¿ä¸Šè¯Šæ–­æ–¹æ³•" class="headerlink" title="çº¿ä¸Šè¯Šæ–­æ–¹æ³•"></a>çº¿ä¸Šè¯Šæ–­æ–¹æ³•</h2><p>é€šå¸¸éƒ½æ˜¯åå…«èˆ¬æ­¦è‰ºé…åˆç€æ¥ç”¨ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š</p><ul><li>top å‘½ä»¤ï¼ŒæŸ¥çœ‹ %CPUï¼Œé…åˆ grep java</li><li>ps H -eo pid,tid,%cpu(å°å†™ cpu) | grep è¿›ç¨‹å·</li><li>jstack è¿›ç¨‹ idï¼Œä¼šåˆ—å‡ºæ‰€æœ‰çº¿ç¨‹ï¼Œæœ‰çº¿ç¨‹å· nidï¼ˆ16 è¿›åˆ¶ï¼‰ï¼Œprintf â€˜%xâ€™ 10 è¿›åˆ¶ id</li><li>jstack æŸ¥çœ‹æ˜¯å¦å‡ºç°æ­»é”</li></ul><hr><h1 id="æœ¬åœ°æ–¹æ³•æ ˆ"><a href="#æœ¬åœ°æ–¹æ³•æ ˆ" class="headerlink" title="æœ¬åœ°æ–¹æ³•æ ˆ"></a>æœ¬åœ°æ–¹æ³•æ ˆ</h1><p>native åœ°æ–¹æ³•è¿è¡Œæ—¶æ‰€éœ€è¦çš„ç©ºé—´ï¼Œå…¶ä»–çš„æ¯ä»€ä¹ˆå¥½è¯´çš„äº†ï¼Œä¸æ‡‚</p><hr><h1 id="å †"><a href="#å †" class="headerlink" title="å †"></a>å †</h1><p>é€šè¿‡ new å…³é”®å­—åˆ›å»ºçš„å¯¹è±¡éƒ½ä¼šä½¿ç”¨å †å†…å­˜<br>å †é‡Œé¢çš„å¯¹è±¡æ˜¯çº¿ç¨‹å…±äº«çš„ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½éœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ï¼Œå †æœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå¹¶ä¸”ä¼šå‘ç”Ÿå†…å­˜æº¢å‡º <code>java.lang.OutOfMemoryError: Java heap sapce</code></p><p>JVM å‚æ•°å¸¸ç”¨çš„æœ‰ä¸¤ä¸ªï¼Œç”¨äºè®¾ç½®å†…å­˜å ç”¨å¤§å°<br>-Xmsï¼šå †çš„åˆå§‹å¤§å°<br>-Xmxï¼šå †çš„æœ€å¤§å ç”¨</p><p>ä¸ºä»€ä¹ˆä¸€èˆ¬éƒ½ä¼šå°†è¿™ä¸¤ä¸ªå‚æ•°è®¾ç½®æˆä¸€æ ·ï¼Ÿ<br>å› ä¸ºå½“å †å†…å­˜ä¸è¶³éœ€è¦è¿›è¡Œæ‰©å®¹çš„æ—¶å€™ï¼Œä¼šå‘ç”Ÿå†…å­˜æŠ–åŠ¨ï¼Œå¯¹ç¨‹åºè¿è¡Œçš„ç¨³å®šæ€§ä¼šæœ‰ä¸€å®šçš„å½±å“</p><h2 id="çº¿ä¸Šè¯Šæ–­æ–¹æ³•-1"><a href="#çº¿ä¸Šè¯Šæ–­æ–¹æ³•-1" class="headerlink" title="çº¿ä¸Šè¯Šæ–­æ–¹æ³•"></a>çº¿ä¸Šè¯Šæ–­æ–¹æ³•</h2><p>åŒ…æ‹¬ä½†ä¸é™äºï¼š</p><ul><li>jpsï¼šæŸ¥çœ‹ç³»ç»Ÿä¸­å­˜åœ¨çš„ Java è¿›ç¨‹</li><li>jmapï¼šæŸ¥çœ‹å †å†…å­˜å ç”¨æƒ…å†µï¼Œjmap -head pid</li><li>jconsoleï¼šå›¾å½¢ç•Œé¢çš„ï¼Œå¤šåŠŸèƒ½ç›‘æµ‹å·¥å…·ï¼Œå¯ä»¥è¿ç»­ç›‘æµ‹ï¼ˆå¯æµ‹å‡ºæ˜¯å¦å‘ç”Ÿæ­»é”ï¼‰</li><li>jvisualvmï¼šå † dump</li></ul><hr><h1 id="æ–¹æ³•åŒº"><a href="#æ–¹æ³•åŒº" class="headerlink" title="æ–¹æ³•åŒº"></a>æ–¹æ³•åŒº</h1><p>çº¿ç¨‹å…±äº«ï¼Œå­˜æ”¾ä¸€äº›ç±»çš„åŸºæœ¬ä¿¡æ¯ï¼ˆç±»ï¼Œç±»åŠ è½½å™¨ï¼Œè¿è¡Œæ—¶å¸¸é‡æ± ï¼‰ï¼Œé€»è¾‘ä¸Šæ˜¯å †çš„ä¸€éƒ¨åˆ†ï¼Œä¸åŒå‚å•†æœ‰ä¸åŒçš„å®ç°</p><p>HotSpot åœ¨ 1.7 ä¹‹å‰ç”¨æ°¸ä¹…ä»£ï¼ˆå †ï¼‰ï¼Œ1.8 åç”¨å…ƒç©ºé—´ï¼ˆæ“ä½œç³»ç»Ÿå†…å­˜ï¼‰</p><p>æ–¹æ³•åŒºæ˜¯è§„èŒƒï¼Œæ°¸ä¹…ä»£æˆ–è€…å…ƒç©ºé—´æ˜¯å…¶ä¸­ä¸€ç§å®ç°ï¼Œæ–¹æ³•åŒºä¼šå‘ç”Ÿå†…å­˜æº¢å‡º<br>1.8 ä»¥å‰ä¼šå¯¼è‡´æ°¸ä¹…ä»£å†…å­˜æº¢å‡ºï¼š<code>-XX:MaxPermSize=mï¼ˆOutOfMemoryï¼šPermGen spaceï¼‰</code><br>1.8 ä¹‹åä¼šå¯¼è‡´å…ƒç©ºé—´å†…å­˜æº¢å‡ºï¼š<code>-XX:MaxMetaspaceSize=mï¼ˆOutOfMemoryï¼šMetaspaceï¼‰</code></p><hr><h1 id="å­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œä¸²æ± ï¼ˆStringTableï¼‰"><a href="#å­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œä¸²æ± ï¼ˆStringTableï¼‰" class="headerlink" title="å­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œä¸²æ± ï¼ˆStringTableï¼‰"></a>å­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œä¸²æ± ï¼ˆStringTableï¼‰</h1><p>å¸¸é‡æ± ï¼šæ˜¯ä¸€å¼ è¡¨ï¼Œç»´æŠ¤ç±»åï¼Œæ–¹æ³•åï¼Œå‚æ•°ç±»å‹ï¼Œå­—é¢é‡ç­‰ä¿¡æ¯</p><p>è¿è¡Œæ—¶å¸¸é‡æ± ï¼šå½“ç±»è¢«åŠ è½½æ—¶ï¼Œå®ƒçš„å¸¸é‡æ± ä¿¡æ¯å°±ä¼šæ”¾å…¥è¿è¡Œæ—¶å¸¸é‡æ± ï¼Œå¹¶æŠŠé‡Œé¢çš„ç¬¦å·åœ°å€å˜ä¸ºçœŸå®åœ°å€</p><p>å­—ç¬¦ä¸²å¸¸é‡æ± ï¼šå­—ç¬¦ä¸²æ˜¯æ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨å¾—éå¸¸å¤šçš„ç±»ï¼Œæ± åŒ–æŠ€æœ¯æŸç§ç¨‹åº¦ä¸Šä¼šæœ‰æ€§èƒ½ä¸Šçš„æå‡</p><p>å¦‚ä½•åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯åœ¨å †è¿˜æ˜¯åœ¨ä¸²æ± ä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="string">&quot;a&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="string">&quot;b&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">s3</span> <span class="operator">=</span> s1 + s2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>javap -v x.class æŸ¥çœ‹äºŒè¿›åˆ¶å­—èŠ‚ç ï¼ˆç±»åŸºæœ¬ä¿¡æ¯ï¼Œå¸¸é‡æ± ï¼Œç±»æ–¹æ³•å®šä¹‰ï¼ŒåŒ…å«äº†è™šæ‹ŸæœºæŒ‡ä»¤ï¼‰</p><p>ä¸åŒçš„ JDK ç‰ˆæœ¬å¯ä»¥çœ‹åˆ°åç¼–è¯‘å‡ºæ¥çš„ä¸ä¸€æ ·</p><p>JDK 1.8</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">Classfile /home/linweiyuan/Temp/test/Test.<span class="keyword">class</span></span><br><span class="line">  <span class="title class_">Last</span> modified Sep <span class="number">24</span>, <span class="number">2022</span>; size <span class="number">759</span> bytes</span><br><span class="line">  MD5 checksum 1eeb9a3b24c5c4f6a213e62ca4ee1691</span><br><span class="line">  Compiled from <span class="string">&quot;Test.java&quot;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span></span><br><span class="line">  minor version: <span class="number">0</span></span><br><span class="line">  major version: <span class="number">52</span></span><br><span class="line">  flags: ACC_PUBLIC, ACC_SUPER</span><br><span class="line">Constant pool:</span><br><span class="line">   #<span class="number">1</span> = Methodref          #<span class="number">9.</span>#<span class="number">18</span>         <span class="comment">// java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">   #<span class="number">2</span> = String             #<span class="number">19</span>            <span class="comment">// a</span></span><br><span class="line">   #<span class="number">3</span> = String             #<span class="number">20</span>            <span class="comment">// b</span></span><br><span class="line">   #<span class="number">4</span> = Class              #<span class="number">21</span>            <span class="comment">// java/lang/StringBuilder</span></span><br><span class="line">   #<span class="number">5</span> = Methodref          #<span class="number">4.</span>#<span class="number">18</span>         <span class="comment">// java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">   #<span class="number">6</span> = Methodref          #<span class="number">4.</span>#<span class="number">22</span>         <span class="comment">// java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span></span><br><span class="line">   #<span class="number">7</span> = Methodref          #<span class="number">4.</span>#<span class="number">23</span>         <span class="comment">// java/lang/StringBuilder.toString:()Ljava/lang/String;</span></span><br><span class="line">   #<span class="number">8</span> = Class              #<span class="number">24</span>            <span class="comment">// Test</span></span><br><span class="line">   #<span class="number">9</span> = Class              #<span class="number">25</span>            <span class="comment">// java/lang/Object</span></span><br><span class="line">  #<span class="number">10</span> = Utf8               &lt;init&gt;</span><br><span class="line">  #<span class="number">11</span> = Utf8               ()V</span><br><span class="line">  #<span class="number">12</span> = Utf8               Code</span><br><span class="line">  #<span class="number">13</span> = Utf8               LineNumberTable</span><br><span class="line">  #<span class="number">14</span> = Utf8               main</span><br><span class="line">  #<span class="number">15</span> = Utf8               ([Ljava/lang/String;)V</span><br><span class="line">  #<span class="number">16</span> = Utf8               SourceFile</span><br><span class="line">  #<span class="number">17</span> = Utf8               Test.java</span><br><span class="line">  #<span class="number">18</span> = NameAndType        #<span class="number">10</span>:#<span class="number">11</span>        <span class="comment">// &quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">  #<span class="number">19</span> = Utf8               a</span><br><span class="line">  #<span class="number">20</span> = Utf8               b</span><br><span class="line">  #<span class="number">21</span> = Utf8               java/lang/StringBuilder</span><br><span class="line">  #<span class="number">22</span> = NameAndType        #<span class="number">26</span>:#<span class="number">27</span>        <span class="comment">// append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span></span><br><span class="line">  #<span class="number">23</span> = NameAndType        #<span class="number">28</span>:#<span class="number">29</span>        <span class="comment">// toString:()Ljava/lang/String;</span></span><br><span class="line">  #<span class="number">24</span> = Utf8               Test</span><br><span class="line">  #<span class="number">25</span> = Utf8               java/lang/Object</span><br><span class="line">  #<span class="number">26</span> = Utf8               append</span><br><span class="line">  #<span class="number">27</span> = Utf8               (Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="line">  #<span class="number">28</span> = Utf8               toString</span><br><span class="line">  #<span class="number">29</span> = Utf8               ()Ljava/lang/String;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Test</span><span class="params">()</span>;</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">1</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: aload_0</span><br><span class="line">         <span class="number">1</span>: invokespecial #<span class="number">1</span>                  <span class="comment">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">         <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">1</span>: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(java.lang.String[])</span>;</span><br><span class="line">    descriptor: ([Ljava/lang/String;)V</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">2</span>, locals=<span class="number">4</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: ldc           #<span class="number">2</span>                  <span class="comment">// String a</span></span><br><span class="line">         <span class="number">2</span>: astore_1</span><br><span class="line">         <span class="number">3</span>: ldc           #<span class="number">3</span>                  <span class="comment">// String b</span></span><br><span class="line">         <span class="number">5</span>: astore_2</span><br><span class="line">         <span class="number">6</span>: <span class="keyword">new</span>           #<span class="number">4</span>                  <span class="comment">// class java/lang/StringBuilder</span></span><br><span class="line">         <span class="number">9</span>: dup</span><br><span class="line">        <span class="number">10</span>: invokespecial #<span class="number">5</span>                  <span class="comment">// Method java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">        <span class="number">13</span>: aload_1</span><br><span class="line">        <span class="number">14</span>: invokevirtual #<span class="number">6</span>                  <span class="comment">// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span></span><br><span class="line">        <span class="number">17</span>: aload_2</span><br><span class="line">        <span class="number">18</span>: invokevirtual #<span class="number">6</span>                  <span class="comment">// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span></span><br><span class="line">        <span class="number">21</span>: invokevirtual #<span class="number">7</span>                  <span class="comment">// Method java/lang/StringBuilder.toString:()Ljava/lang/String;</span></span><br><span class="line">        <span class="number">24</span>: astore_3</span><br><span class="line">        <span class="number">25</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">4</span>: <span class="number">0</span></span><br><span class="line">        line <span class="number">5</span>: <span class="number">3</span></span><br><span class="line">        line <span class="number">6</span>: <span class="number">6</span></span><br><span class="line">        line <span class="number">7</span>: <span class="number">25</span></span><br><span class="line">&#125;</span><br><span class="line">SourceFile: <span class="string">&quot;Test.java&quot;</span></span><br></pre></td></tr></table></figure><p>JDK 9+ï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯ JDK 17ï¼Œä½†å…¶å®ä» 9 å¼€å§‹å°±å˜äº†ï¼Œä¹‹å‰æœ‰è¯•è¿‡ï¼Œæœ€è¿‘æ•´ç†ç¬”è®°ï¼Œç”µè„‘ä¸Š JDK 9 å·²ç»æ²¡æœ‰äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">Classfile /home/linweiyuan/Temp/test/Test.<span class="keyword">class</span></span><br><span class="line">  <span class="title class_">Last</span> modified Sep <span class="number">24</span>, <span class="number">2022</span>; size <span class="number">759</span> bytes</span><br><span class="line">  SHA-<span class="number">256</span> checksum 1f929ea79bba2fa30f55910a61ea7627d430b3dff13f7bdb8cd275e901a0343d</span><br><span class="line">  Compiled from <span class="string">&quot;Test.java&quot;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span></span><br><span class="line">  minor version: <span class="number">0</span></span><br><span class="line">  major version: <span class="number">61</span></span><br><span class="line">  flags: (<span class="number">0x0021</span>) ACC_PUBLIC, ACC_SUPER</span><br><span class="line">  this_class: #<span class="number">15</span>                         <span class="comment">// Test</span></span><br><span class="line">  super_class: #<span class="number">2</span>                         <span class="comment">// java/lang/Object</span></span><br><span class="line">  interfaces: <span class="number">0</span>, fields: <span class="number">0</span>, methods: <span class="number">2</span>, attributes: <span class="number">3</span></span><br><span class="line">Constant pool:</span><br><span class="line">   #<span class="number">1</span> = Methodref          #<span class="number">2.</span>#<span class="number">3</span>          <span class="comment">// java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">   #<span class="number">2</span> = Class              #<span class="number">4</span>             <span class="comment">// java/lang/Object</span></span><br><span class="line">   #<span class="number">3</span> = NameAndType        #<span class="number">5</span>:#<span class="number">6</span>          <span class="comment">// &quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">   #<span class="number">4</span> = Utf8               java/lang/Object</span><br><span class="line">   #<span class="number">5</span> = Utf8               &lt;init&gt;</span><br><span class="line">   #<span class="number">6</span> = Utf8               ()V</span><br><span class="line">   #<span class="number">7</span> = String             #<span class="number">8</span>             <span class="comment">// a</span></span><br><span class="line">   #<span class="number">8</span> = Utf8               a</span><br><span class="line">   #<span class="number">9</span> = String             #<span class="number">10</span>            <span class="comment">// b</span></span><br><span class="line">  #<span class="number">10</span> = Utf8               b</span><br><span class="line">  #<span class="number">11</span> = InvokeDynamic      #<span class="number">0</span>:#<span class="number">12</span>         <span class="comment">// #0:makeConcatWithConstants:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;</span></span><br><span class="line">  #<span class="number">12</span> = NameAndType        #<span class="number">13</span>:#<span class="number">14</span>        <span class="comment">// makeConcatWithConstants:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;</span></span><br><span class="line">  #<span class="number">13</span> = Utf8               makeConcatWithConstants</span><br><span class="line">  #<span class="number">14</span> = Utf8               (Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;</span><br><span class="line">  #<span class="number">15</span> = Class              #<span class="number">16</span>            <span class="comment">// Test</span></span><br><span class="line">  #<span class="number">16</span> = Utf8               Test</span><br><span class="line">  #<span class="number">17</span> = Utf8               Code</span><br><span class="line">  #<span class="number">18</span> = Utf8               LineNumberTable</span><br><span class="line">  #<span class="number">19</span> = Utf8               main</span><br><span class="line">  #<span class="number">20</span> = Utf8               ([Ljava/lang/String;)V</span><br><span class="line">  #<span class="number">21</span> = Utf8               SourceFile</span><br><span class="line">  #<span class="number">22</span> = Utf8               Test.java</span><br><span class="line">  #<span class="number">23</span> = Utf8               BootstrapMethods</span><br><span class="line">  #<span class="number">24</span> = MethodHandle       <span class="number">6</span>:#<span class="number">25</span>          <span class="comment">// REF_invokeStatic java/lang/invoke/StringConcatFactory.makeConcatWithConstants:(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;</span></span><br><span class="line">  #<span class="number">25</span> = Methodref          #<span class="number">26.</span>#<span class="number">27</span>        <span class="comment">// java/lang/invoke/StringConcatFactory.makeConcatWithConstants:(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;</span></span><br><span class="line">  #<span class="number">26</span> = Class              #<span class="number">28</span>            <span class="comment">// java/lang/invoke/StringConcatFactory</span></span><br><span class="line">  #<span class="number">27</span> = NameAndType        #<span class="number">13</span>:#<span class="number">29</span>        <span class="comment">// makeConcatWithConstants:(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;</span></span><br><span class="line">  #<span class="number">28</span> = Utf8               java/lang/invoke/StringConcatFactory</span><br><span class="line">  #<span class="number">29</span> = Utf8               (Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;</span><br><span class="line">  #<span class="number">30</span> = String             #<span class="number">31</span>            <span class="comment">// \u0001\u0001</span></span><br><span class="line">  #<span class="number">31</span> = Utf8               \u0001\u0001</span><br><span class="line">  #<span class="number">32</span> = Utf8               InnerClasses</span><br><span class="line">  #<span class="number">33</span> = Class              #<span class="number">34</span>            <span class="comment">// java/lang/invoke/MethodHandles$Lookup</span></span><br><span class="line">  #<span class="number">34</span> = Utf8               java/lang/invoke/MethodHandles$Lookup</span><br><span class="line">  #<span class="number">35</span> = Class              #<span class="number">36</span>            <span class="comment">// java/lang/invoke/MethodHandles</span></span><br><span class="line">  #<span class="number">36</span> = Utf8               java/lang/invoke/MethodHandles</span><br><span class="line">  #<span class="number">37</span> = Utf8               Lookup</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Test</span><span class="params">()</span>;</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: (<span class="number">0x0001</span>) ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">1</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: aload_0</span><br><span class="line">         <span class="number">1</span>: invokespecial #<span class="number">1</span>                  <span class="comment">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">         <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">1</span>: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(java.lang.String[])</span>;</span><br><span class="line">    descriptor: ([Ljava/lang/String;)V</span><br><span class="line">    flags: (<span class="number">0x0009</span>) ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">2</span>, locals=<span class="number">4</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: ldc           #<span class="number">7</span>                  <span class="comment">// String a</span></span><br><span class="line">         <span class="number">2</span>: astore_1</span><br><span class="line">         <span class="number">3</span>: ldc           #<span class="number">9</span>                  <span class="comment">// String b</span></span><br><span class="line">         <span class="number">5</span>: astore_2</span><br><span class="line">         <span class="number">6</span>: aload_1</span><br><span class="line">         <span class="number">7</span>: aload_2</span><br><span class="line">         <span class="number">8</span>: invokedynamic #<span class="number">11</span>,  <span class="number">0</span>             <span class="comment">// InvokeDynamic #0:makeConcatWithConstants:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;</span></span><br><span class="line">        <span class="number">13</span>: astore_3</span><br><span class="line">        <span class="number">14</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">4</span>: <span class="number">0</span></span><br><span class="line">        line <span class="number">5</span>: <span class="number">3</span></span><br><span class="line">        line <span class="number">6</span>: <span class="number">6</span></span><br><span class="line">        line <span class="number">7</span>: <span class="number">14</span></span><br><span class="line">&#125;</span><br><span class="line">SourceFile: <span class="string">&quot;Test.java&quot;</span></span><br><span class="line">BootstrapMethods:</span><br><span class="line">  <span class="number">0</span>: #<span class="number">24</span> REF_invokeStatic java/lang/invoke/StringConcatFactory.makeConcatWithConstants:(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;</span><br><span class="line">    Method arguments:</span><br><span class="line">      #<span class="number">30</span> \u0001\u0001</span><br><span class="line">InnerClasses:</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> #<span class="number">37</span>= #<span class="number">33</span> of #<span class="number">35</span>;    <span class="comment">// Lookup=class java/lang/invoke/MethodHandles$Lookup of class java/lang/invoke/MethodHandles</span></span><br></pre></td></tr></table></figure><p>å¾—å‡ºç»“è®º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JDK 1.8</span></span><br><span class="line"><span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="string">&quot;a&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="string">&quot;b&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">s3</span> <span class="operator">=</span> s1 + s2; <span class="comment">// new StringBuilder().append(&quot;a&quot;).append(&quot;b&quot;).toString();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// JDK 1.9 -&gt; StringConcatFactory.makeConcatWithConstants()</span></span><br><span class="line"><span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="string">&quot;a&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="string">&quot;b&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">s3</span> <span class="operator">=</span> <span class="string">&quot;ab&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">s4</span> <span class="operator">=</span> s1 + s2; <span class="comment">// StringConcatFactory.makeConcatWithConstants()</span></span><br><span class="line"><span class="type">String</span> <span class="variable">s5</span> <span class="operator">=</span> <span class="string">&quot;a&quot;</span> + <span class="string">&quot;b&quot;</span>; <span class="comment">// ç¼–è¯‘æœŸä¼˜åŒ–</span></span><br><span class="line"></span><br><span class="line">System.out.println(s3 == s4); <span class="comment">// falseï¼Œå› ä¸º s3 å­˜åœ¨ä¸²æ± ä¸­ï¼Œs4 æ˜¯ new å‡ºæ¥çš„å¯¹è±¡åœ¨å †ä¸­</span></span><br><span class="line">System.out.println(s3 == s5); <span class="comment">// trueï¼Œå› ä¸º ab å·²ç»å­˜åœ¨ä¸²æ± ä¸­äº†ï¼ˆs3ï¼‰ï¼Œå¯¹äºç¡®å®šçš„å­—ç¬¦ä¸²ï¼ˆä¸æ˜¯å˜é‡ï¼‰ï¼ŒJava ä¼šè¿›è¡Œç¼–è¯‘æœŸä¼˜åŒ–</span></span><br></pre></td></tr></table></figure><h2 id="StringTable-ç‰¹æ€§"><a href="#StringTable-ç‰¹æ€§" class="headerlink" title="StringTable ç‰¹æ€§"></a>StringTable ç‰¹æ€§</h2><ul><li>å¸¸é‡æ± ä¸­çš„å­—ç¬¦ä¸²åªæ˜¯ç¬¦å·ï¼Œç¬¬ä¸€æ¬¡ç”¨åˆ°æ—¶æ‰å˜ä¸ºå¯¹è±¡</li><li>åˆ©ç”¨ä¸²æ± çš„æœºåˆ¶ï¼Œå¯ä»¥é¿å…é‡å¤åˆ›å»ºå­—ç¬¦ä¸²å¯¹è±¡</li><li>å­—ç¬¦ä¸²å¸¸é‡æ‹¼æ¥çš„åŸç†æ˜¯ç¼–è¯‘æœŸä¼˜åŒ–</li><li>ç”¨ intern() å¯ä»¥ä¸»åŠ¨æŠŠä¸²æ± ä¸­è¿˜æ²¡æœ‰çš„å­—ç¬¦ä¸²å¯¹è±¡æ”¾å…¥ä¸²æ± ï¼ˆå°è¯•æ”¾å…¥ä¸²æ± ï¼Œæœ‰åˆ™ä¸ä¼šæ”¾å…¥ï¼Œæ²¡æœ‰åˆ™æ”¾å…¥ï¼Œæ— è®ºæ”¾å…¥æ˜¯å¦æˆåŠŸï¼Œè¿”å›çš„éƒ½æ˜¯ä¸²æ± ä¸­çš„å¯¹è±¡ï¼‰</li></ul><p>è¿™é‡Œæœ‰ä¸€ä¸ªè¦æ³¨æ„çš„åœ°æ–¹ï¼ŒJDK 1.8 intern() å°†è‡ªå·±æ”¾å…¥ä¸²æ± ï¼ˆä¸€ä¸ªå¯¹è±¡ï¼‰ï¼ŒJDK 1.6 æŠŠè‡ªå·±å¤åˆ¶ä¸€ä»½æ”¾è¿›ä¸²æ± ï¼ˆä¸¤ä¸ªå¯¹è±¡ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;a&quot;</span>) + <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;b&quot;</span>); <span class="comment">// æ­¤æ—¶ s åœ¨å †ä¸­</span></span><br><span class="line"><span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> s.intern(); <span class="comment">// s æ”¾å…¥äº†ä¸²æ± ï¼Œå¹¶ä¸”è¿”å›äº†ä¸²æ± ä¸­çš„å¯¹è±¡ ab</span></span><br><span class="line"></span><br><span class="line">System.out.println(s2 == <span class="string">&quot;ab&quot;</span>); <span class="comment">// trueï¼Œå› ä¸º s2 å°±æ˜¯ä¸²æ± ä¸­è¿”å›çš„å¯¹è±¡ï¼Œå’Œä¸²æ± ä¸­çš„å¯¹è±¡ ab ç›¸æ¯”ï¼Œç›¸ç­‰</span></span><br><span class="line">System.out.println(s == <span class="string">&quot;ab&quot;</span>); <span class="comment">// true, å› ä¸ºä¸²æ± ä¸­è¿˜æ²¡æœ‰ï¼Œintern() æ”¾å…¥äº†åï¼Œs æ­¤æ—¶åœ¨ä¸²æ± ä¸­</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">x</span> <span class="operator">=</span> <span class="string">&quot;ab&quot;</span>; <span class="comment">// ä¸²æ± ä¸­å·²ç»æœ‰äº† ab</span></span><br><span class="line"><span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;a&quot;</span>) + <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;b&quot;</span>); <span class="comment">// æ­¤æ—¶ s åœ¨å †ä¸­</span></span><br><span class="line"><span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> s.intern(); <span class="comment">// s æ”¾å…¥ä¸²æ± å¤±è´¥ï¼Œå› ä¸ºå·²ç»æœ‰äº†ï¼Œè¿”å›äº†ä¸²æ± ä¸­çš„å¯¹è±¡ ab ç»™ s2ï¼Œä½†æ˜¯ s è¿˜åœ¨å †ä¸­</span></span><br><span class="line"></span><br><span class="line">System.out.println(s2 == <span class="string">&quot;ab&quot;</span>); <span class="comment">// trueï¼Œå› ä¸º s2 å°±æ˜¯ä¸²æ± ä¸­è¿”å›çš„å¯¹è±¡ï¼Œå’Œä¸²æ± ä¸­çš„å¯¹è±¡ ab ç›¸æ¯”ï¼Œç›¸ç­‰</span></span><br><span class="line">System.out.println(s == <span class="string">&quot;ab&quot;</span>); <span class="comment">// false, å› ä¸ºä¸²æ± æ”¾å…¥å¤±è´¥ï¼Œsè¿˜åœ¨å †ä¸­</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;a&quot;</span>) + <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;b&quot;</span>); <span class="comment">// æ­¤æ—¶ s åœ¨å †ä¸­</span></span><br><span class="line">System.out.println(s == <span class="string">&quot;ab&quot;</span>); <span class="comment">// false, ab æ­¤æ—¶åœ¨ä¸²æ± ä¸­ï¼Œs åœ¨å †ä¸­</span></span><br><span class="line"><span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> s.intern(); <span class="comment">// s æ”¾å…¥ä¸²æ± å¤±è´¥ï¼Œå› ä¸ºå·²ç»æœ‰äº†ï¼Œè¿”å›äº†ä¸²æ± ä¸­çš„å¯¹è±¡ ab ç»™ s2ï¼Œä½†æ˜¯ s è¿˜åœ¨å †ä¸­</span></span><br><span class="line"></span><br><span class="line">System.out.println(s2 == <span class="string">&quot;ab&quot;</span>); <span class="comment">// trueï¼Œå› ä¸º s2 å°±æ˜¯ä¸²æ± ä¸­è¿”å›çš„å¯¹è±¡ï¼Œå’Œä¸²æ± ä¸­çš„å¯¹è±¡ ab ç›¸æ¯”ï¼Œç›¸ç­‰</span></span><br><span class="line">System.out.println(s == <span class="string">&quot;ab&quot;</span>); <span class="comment">// false, å› ä¸ºä¸²æ± æ”¾å…¥å¤±è´¥ï¼Œs è¿˜åœ¨å †ä¸­</span></span><br></pre></td></tr></table></figure><h2 id="StringTable-ä½ç½®"><a href="#StringTable-ä½ç½®" class="headerlink" title="StringTable ä½ç½®"></a>StringTable ä½ç½®</h2><ul><li>1.6ï¼šå¸¸é‡æ± çš„ä¸€éƒ¨åˆ†ï¼Œä½äºæ°¸ä¹…ä»£ä¸­ï¼ˆæ°¸ä¹…ä»£ Full GC æ‰ä¼šè§¦å‘ï¼Œå­—ç¬¦ä¸²ç”¨çš„åœºæ™¯å¾ˆå¤šï¼Œä½†æ˜¯å¥½å¤šéƒ½æ˜¯å¯ä»¥å›æ”¶çš„ï¼Œå†…å­˜å ç”¨å¤ªå¤šä¼šé€ æˆæ°¸ä¹…ä»£å†…å­˜ä¸è¶³ï¼‰ï¼ˆPermGen spaceï¼‰</li><li>1.8ï¼šå †ä¸­çš„ä¸€éƒ¨åˆ†ï¼ˆå † Minor GC å°±ä¼šè§¦å‘ï¼‰ï¼ˆHeap spaceï¼‰</li><li>-XX:-UseFCOverheadLimitï¼ˆ+å¯ç”¨ï¼Œ-ç¦ç”¨ï¼Œé»˜è®¤å¯ç”¨ï¼‰ï¼šå¦‚æœ 98%çš„æ—¶é—´èŠ±åœ¨äº†åƒåœ¾å›æ”¶ä¸Šï¼Œä½†æ˜¯åªæœ‰ 2% çš„å †å†…å­˜å›æ”¶äº†ï¼Œæ­¤æ—¶ JVM ç›´æ¥æŠ›å‡º <code>OutOfMemoryErrorï¼šGC overhead limit exceeded</code></li></ul><h2 id="StringTable-æ€§èƒ½è°ƒä¼˜"><a href="#StringTable-æ€§èƒ½è°ƒä¼˜" class="headerlink" title="StringTable æ€§èƒ½è°ƒä¼˜"></a>StringTable æ€§èƒ½è°ƒä¼˜</h2><p>StringTable æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œå“ˆå¸Œè¡¨æ€§èƒ½ä¸æ¡¶çš„ä¸ªæ•°æœ‰å…³</p><ul><li>æ¡¶ä¸ªæ•°å¤ªå¤§ï¼Œå…ƒç´ åˆ†æ•£ï¼Œå“ˆå¸Œç¢°æ’æœºç‡å‡å°‘ï¼Œæ£€ç´¢é€Ÿåº¦è¾ƒå¿«</li><li>æ¡¶ä¸ªæ•°å¤ªå°ï¼Œå“ˆå¸Œç¢°æ’æœºç‡å¢åŠ ï¼Œé“¾è¡¨å°±ä¼šå˜é•¿ï¼ŒæŸ¥æ‰¾é€Ÿåº¦å°±ä¼šé™ä½</li></ul><p>å¯ä»¥é€šè¿‡ JVM å‚æ•°è°ƒæ•´æ¡¶çš„ä¸ªæ•°ï¼Œ-XX:StringTableSize&#x3D;12345ï¼ˆæœ€å°å€¼ 1009ï¼‰</p><hr><h1 id="åƒåœ¾å›æ”¶"><a href="#åƒåœ¾å›æ”¶" class="headerlink" title="åƒåœ¾å›æ”¶"></a>åƒåœ¾å›æ”¶</h1><p>æœ€å¿«çš„ GC æ˜¯ä¸å‘ç”Ÿ GC</p><h2 id="å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦èƒ½å›æ”¶"><a href="#å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦èƒ½å›æ”¶" class="headerlink" title="å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦èƒ½å›æ”¶"></a>å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦èƒ½å›æ”¶</h2><ul><li>å¼•ç”¨è®¡æ•°æ³•ï¼ˆæœ‰å¾ªç¯å¼•ç”¨é—®é¢˜ï¼ŒA å¼•ç”¨ Bï¼ŒB å¼•ç”¨ Aï¼Œéƒ½ä¸ä¼šè¢«å›æ”¶ï¼ŒJVM ä¸æ˜¯è¿™ç§ï¼‰</li><li>å¯è¾¾æ€§åˆ†æç®—æ³•ï¼ˆJVM é‡‡ç”¨è¿™ç§ï¼ŒGC Rootsï¼‰<ul><li>å“ªç§å¯ä½œä¸º Rootsï¼Ÿ(å¯ä»¥ç”¨ Eclipse Memory Analyzer æŸ¥çœ‹ï¼Œjps -&gt; jmap -dump:format&#x3D;b,live,file&#x3D;m.bin pid)<ul><li>System Classï¼ˆæ ¸å¿ƒçš„ç±»ï¼ŒObject, HashMap, String ç­‰ï¼‰</li><li>Native Stackï¼ˆæ“ä½œç³»ç»Ÿæ–¹æ³•æ‰§è¡Œæ—¶å¼•ç”¨çš„ Java å¯¹è±¡ï¼‰</li><li>Threadï¼ˆæ´»åŠ¨çº¿ç¨‹ï¼‰</li><li>Busy Monitorï¼ˆè¢«åŠ é”çš„å¯¹è±¡ï¼Œå›æ”¶äº†ï¼Œå°±æ— æ³•è§£é”ï¼‰</li></ul></li></ul></li><li>å››ç§å¼•ç”¨<ul><li>å¼ºå¼•ç”¨ï¼ˆnewï¼Œèµ‹å€¼ï¼Œæ²¿ç€ GC Roots èƒ½æ‰¾åˆ°ï¼Œå°±ä¸ä¼šè¢«å›æ”¶ï¼‰</li><li>è½¯å¼•ç”¨ï¼ˆæ²¡æœ‰å¼ºå¼•ç”¨æ—¶ï¼Œå‘ç”Ÿåƒåœ¾å›æ”¶ï¼Œå¦‚æœå†…å­˜ä¸è¶³ï¼Œå†æ‰§è¡Œä¸€æ¬¡ï¼Œè¢«å›æ”¶ï¼Œå¯é…åˆå¼•ç”¨é˜Ÿåˆ—ä½¿ç”¨é‡Šæ”¾è‡ªèº«ï¼‰<ul><li>SoftReference</li><li>ReferenceQueue, new SoftReference(obj, queue)</li><li>å½“ obj è¢«å›æ”¶æ—¶ï¼Œè¿›å…¥é˜Ÿåˆ—</li><li>queue.poll() è·å–è‡ªèº«ï¼Œéå† remove()</li></ul></li><li>å¼±å¼•ç”¨ï¼ˆæ²¡æœ‰å¼ºå¼•ç”¨æ—¶ï¼Œåªè¦å‘ç”Ÿäº†åƒåœ¾å›æ”¶ï¼Œè¢«å›æ”¶ï¼Œå¯é…åˆå¼•ç”¨é˜Ÿåˆ—ä½¿ç”¨é‡Šæ”¾è‡ªèº«ï¼‰<ul><li>WeakReference</li></ul></li><li>è™šå¼•ç”¨ï¼ˆå¿…é¡»é…åˆå¼•ç”¨é˜Ÿåˆ—ä½¿ç”¨ï¼Œç”¨äº NIO ä¸­ï¼Œç”± Reference Handler å¤„ç†ï¼‰<ul><li>PhantomReference</li></ul></li><li>ç»ˆç»“å™¨å¼•ç”¨ï¼ˆå¿…é¡»é…åˆå¼•ç”¨é˜Ÿåˆ—ä½¿ç”¨ï¼Œfinalize() åè¿›å…¥é˜Ÿåˆ—ï¼Œç”± Finalizer å¤„ç†ï¼‰</li></ul></li></ul><h2 id="åƒåœ¾å›æ”¶ç®—æ³•"><a href="#åƒåœ¾å›æ”¶ç®—æ³•" class="headerlink" title="åƒåœ¾å›æ”¶ç®—æ³•"></a>åƒåœ¾å›æ”¶ç®—æ³•</h2><ul><li>æ ‡è®°æ¸…é™¤ï¼šé€Ÿåº¦è¾ƒå¿«ï¼Œå®¹æ˜“äº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼ˆç©ºé—´ä¸è¿ç»­ï¼Œæ•°ç»„æ”¾ä¸ä¸‹ï¼‰</li><li>æ ‡è®°æ•´ç†ï¼šé€Ÿåº¦è¾ƒæ…¢ï¼Œæ²¡æœ‰å†…å­˜ç¢ç‰‡ï¼Œæ ‡è®° -&gt; æ¸…é™¤ -&gt; æ•´ç†ï¼ˆä¼šç§»åŠ¨å¯¹è±¡ï¼Œå› æ­¤å¯¹è±¡çš„å¼•ç”¨åœ°å€ä¼šå˜ï¼Œéœ€è¦åšé¢å¤–çš„å·¥ä½œæ¥æ›´æ–°ï¼‰</li><li>å¤åˆ¶ï¼šæ²¡æœ‰å†…å­˜ç¢ç‰‡ï¼Œéœ€è¦å ç”¨åŒå€å†…å­˜ç©ºé—´ï¼Œå°†å†…å­˜åˆ†æˆå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼ˆfrom, toï¼‰å‘ç”Ÿåƒåœ¾å›æ”¶æ—¶ï¼Œäº¤æ¢ä½ç½®</li></ul><h2 id="åˆ†ä»£åƒåœ¾å›æ”¶"><a href="#åˆ†ä»£åƒåœ¾å›æ”¶" class="headerlink" title="åˆ†ä»£åƒåœ¾å›æ”¶"></a>åˆ†ä»£åƒåœ¾å›æ”¶</h2><p>æ–°ç”Ÿä»£ï¼ˆæœç”Ÿå¤•æ­»ï¼‰ï¼š</p><ul><li>eden</li><li>from</li><li>to</li></ul><p>åƒåœ¾å›æ”¶è¿‡ç¨‹ï¼ˆGC éƒ½ä¼š Stop The Worldï¼Œæ—¶é—´ä¸Šæ–°ç”Ÿä»£çŸ­ä¸€ç‚¹ï¼Œè€å¹´ä»£é•¿ä¸€ç‚¹ï¼Œæš‚åœå…¶ä»–ç”¨æˆ·çº¿ç¨‹ï¼Œè®©åƒåœ¾å›æ”¶çº¿ç¨‹å…ˆæ‰§è¡Œå®Œï¼‰</p><ul><li>æ–°å¯¹è±¡é»˜è®¤å­˜æ”¾åœ¨ eden</li><li>å½“ç©ºé—´ä¸è¶³æ—¶ï¼Œè§¦å‘ Minor GC</li><li>æ ‡è®°-æ¸…é™¤-å¤åˆ¶ï¼ŒæŠŠå­˜æ´»çš„å¤åˆ¶åˆ° toï¼ˆæ³¨æ„ä¸æ˜¯åˆ° fromï¼‰ï¼Œå¯¿å‘½åŠ  1</li><li>äº¤æ¢ from to ä½ç½®ï¼ˆè°æ˜¯ç©ºçš„è°å°±æ˜¯ toï¼‰</li><li>ç»§ç»­æ”¾å¯¹è±¡</li><li>â€¦</li><li>eden å­˜æ´»çš„å¤åˆ¶åˆ° toï¼Œå¯¿å‘½åŠ  1</li><li>åŸæ¥åœ¨ from çš„ç§»åˆ°å­˜æ´»åç§»åˆ° to,å¯¿å‘½åŠ  1</li><li>äº¤æ¢ from to ä½ç½®</li><li>â€¦</li><li>å¯¿å‘½è¶…è¿‡é˜ˆå€¼ï¼ˆ15ï¼Œä¿å­˜åœ¨å¯¹è±¡å¤´ï¼Œ4bitï¼Œæœ€é«˜ 1111 -&gt; 15ï¼‰ï¼Œæ™‹å‡åˆ°è€å¹´ä»£</li><li>å¦‚æœè€å¹´ä»£ä¹Ÿæ”¾ä¸ä¸‹ï¼Œå…ˆå°è¯• Minor GC, å†…å­˜è¿˜ä¸å¤Ÿï¼Œè§¦å‘ Full GCï¼Œå†ä¸å¤Ÿï¼ŒæŠ›å‡º OOM</li><li>å¤§å¯¹è±¡åœ¨æ–°ç”Ÿä»£ç©ºé—´ä¸å¤Ÿï¼Œä½†è€å¹´ä»£ç©ºé—´å¤Ÿçš„æƒ…å†µä¸‹ï¼Œç›´æ¥æ™‹å‡</li></ul><p>ç›¸å…³ JVM å‚æ•°</p><table><thead><tr><th>å‚æ•°</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>-Xms</td><td>åˆå§‹å †å¤§å°</td></tr><tr><td>-Xmx &#x2F; -XX:MaxHeapSize&#x3D;size</td><td>å †æœ€å¤§å¤§å°</td></tr><tr><td>-Xmn &#x2F; -XX:NewSize&#x3D;size, -XX:MaxNewSize&#x3D;size</td><td>æ–°ç”Ÿä»£å¤§å°</td></tr><tr><td>-XX:InitialSurvivorRatio&#x3D;ratio, -XX:+UseAdaptiveSizePolicy</td><td>å¹¸å­˜åŒºæ¯”ä¾‹ï¼ˆåŠ¨æ€ï¼‰</td></tr><tr><td>-XX:SurvivorRatio&#x3D;ratio</td><td>å¹¸å­˜åŒºæ¯”ä¾‹</td></tr><tr><td>-XX:MaxTenuringThreshold&#x3D;threshold</td><td>æ™‹å‡é˜ˆå€¼</td></tr><tr><td>-XX:+PrintTenuringDistribution</td><td>æ™‹å‡è¯¦æƒ…</td></tr><tr><td>-XX:+PrintGCDetails -verbose:gc</td><td>GC è¯¦æƒ…</td></tr><tr><td>-XX:+ScavengeBeforeFullGC</td><td>Full GC å‰ Minor GC</td></tr></tbody></table><p>çº¿ç¨‹å†…çš„ OOM ä¸ä¼šå¯¼è‡´æ•´ä¸ª JVM æŒ‚æ‰</p><h2 id="åƒåœ¾å›æ”¶å™¨"><a href="#åƒåœ¾å›æ”¶å™¨" class="headerlink" title="åƒåœ¾å›æ”¶å™¨"></a>åƒåœ¾å›æ”¶å™¨</h2><ul><li>ä¸²è¡Œ<ul><li>å•çº¿ç¨‹</li><li>é€‚åˆå †å†…å­˜è¾ƒå°ï¼Œä¸ªäººç”µè„‘ï¼ŒCPU ä¸ªæ•°å°‘ï¼ˆå› ä¸ºæ˜¯å•çº¿ç¨‹ï¼‰</li><li>-XX:+UseSerialGC&#x3D;Serial+SerialOld</li></ul></li><li>ååé‡ä¼˜å…ˆï¼ˆ1.8 é»˜è®¤ï¼‰<ul><li>å¤šçº¿ç¨‹</li><li>é€‚åˆå †å†…å­˜è¾ƒå¤§ï¼Œå¤šæ ¸ CPU</li><li>è®©å•ä½æ—¶é—´å†…ï¼ŒSTW çš„æ—¶é—´æœ€çŸ­</li><li>-XX:+UseParallelGC</li><li>-XX:+UseParallelOldGC</li><li>-XX:+UseAdaptiveSizePolicy</li><li>-XX:GCTimeRatio&#x3D;99 (1 &#x2F; 1 + ratio, é»˜è®¤ 99ï¼Œ0.01ï¼Œ100 åˆ†é’Ÿå†…åªèƒ½ä¸€åˆ†é’Ÿç”¨äºåƒåœ¾å›æ”¶ï¼Œå› ä¸ºä¸Šä¸€è¡Œé…ç½®äº†åŠ¨æ€è°ƒæ•´ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¼šè‡ªåŠ¨å¢åŠ å †çš„å¤§å°ï¼Œå¤§å°å¢åŠ äº†ï¼Œå°±èƒ½æ”¾æ›´å¤šçš„ä¸œè¥¿ï¼Œåƒåœ¾å›æ”¶çš„æ¬¡æ•°å°±ä¼šé™ä½ï¼Œååé‡å°±ä¼šæé«˜ï¼Œä¸€èˆ¬è®¾ç½® 19)</li><li>-XX:MaxGCPauseMillis&#x3D;200ï¼ˆæ¯«ç§’ï¼Œå’Œä¸Šé¢çš„é…ç½®å†²çªï¼Œåªèƒ½å–æŠ˜ä¸­ï¼Œå› ä¸ºå †å¢å¤§äº†ï¼Œè™½ç„¶ GC æ¬¡æ•°å‡å°‘ï¼Œä½†å•æ¬¡çš„æ—¶é—´ä¼šå¢åŠ ï¼‰</li><li>-XX:ParallelGCThreads&#x3D;n</li></ul></li><li>å“åº”æ—¶é—´ä¼˜å…ˆ<ul><li>å¤šçº¿ç¨‹</li><li>é€‚åˆå †å†…å­˜è¾ƒå¤§ï¼Œå¤šæ ¸ CPU</li><li>å°½å¯èƒ½è®©å•æ¬¡ STW çš„æ—¶é—´æœ€çŸ­</li><li>-XX:+UseConcMarkSweepGC</li><li>-XX:+UseParNewGC SerialOld</li><li>-XX:ParallelGCThreads&#x3D;n</li><li>-XX:ConcGCThreads&#x3D;n</li><li>-XX:CMSInitiatingOccupancyFraction&#x3D;percent</li><li>-XX:+CMSScavengeBeforeRemark</li></ul></li></ul><p>å¦‚ä½•åŒºåˆ†ååé‡ä¼˜å…ˆå’Œå“åº”æ—¶é—´ä¼˜å…ˆï¼Ÿ</p><p>ååé‡ä¼˜å…ˆï¼šæ¯”å¦‚ï¼Œæ¯æ¬¡èŠ±è´¹ 0.2 ç§’ï¼Œä¸€å°æ—¶ä¸¤æ¬¡ï¼Œå…± 0.4 ç§’ï¼Œåƒåœ¾å›æ”¶æ—¶é—´å æ¯”è¶Šä½ï¼Œååé‡è¶Šé«˜</p><p>å“åº”æ—¶é—´ä¼˜å…ˆï¼šæ¯”å¦‚ï¼Œæ¯æ¬¡åªéœ€ 0.1 ç§’ï¼Œä½†å¯èƒ½ä¸€å°æ—¶å‘ç”Ÿäº† 5 æ¬¡ï¼Œå…± 0.5 ç§’</p><ul><li>G1ï¼ˆGarbage Firstï¼ŒJDK 9 é»˜è®¤ï¼ŒåºŸå¼ƒ CMSï¼‰<ul><li>åŒæ—¶æ³¨é‡ååé‡å’Œä½å»¶è¿Ÿï¼Œé»˜è®¤çš„æš‚åœç›®æ ‡æ˜¯ 200ms</li><li>è¶…å¤§å †å†…å­˜ï¼Œå°†å †åˆ’åˆ†æˆå¤šä¸ªå¤§å°ç›¸ç­‰çš„ Region</li><li>æ•´ä½“ä¸Šæ˜¯æ ‡è®°-æ•´ç†ï¼Œä¸¤ä¸ªåŒºåŸŸä¹‹é—´æ˜¯å¤åˆ¶</li><li>-XX:+UseG1GZ</li><li>-XX:G1HeapRegionSize&#x3D;size</li><li>-XX:MaxGCPauseMillis&#x3D;ms</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram-Counter-Registerï¼‰&quot;&gt;&lt;a href=&quot;#ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram-Counter-Registerï¼‰&quot; class=&quot;headerlink&quot; title=&quot;ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Register</summary>
      
    
    
    
    <category term="JVM" scheme="https://linweiyuan.github.io/categories/JVM/"/>
    
    
    <category term="Java" scheme="https://linweiyuan.github.io/tags/Java/"/>
    
    <category term="JVM" scheme="https://linweiyuan.github.io/tags/JVM/"/>
    
  </entry>
  
  <entry>
    <title>Springç›¸å…³çŸ¥è¯†ç‚¹</title>
    <link href="https://linweiyuan.github.io/2021/07/04/Spring%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9.html"/>
    <id>https://linweiyuan.github.io/2021/07/04/Spring%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9.html</id>
    <published>2021-07-04T13:25:16.000Z</published>
    <updated>2022-10-04T11:01:19.597Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç»„æˆ"><a href="#ç»„æˆ" class="headerlink" title="ç»„æˆ"></a>ç»„æˆ</h1><ul><li>aop</li><li>beans</li><li>context</li><li>core</li><li>jdbc</li><li>test</li><li>web</li></ul><h1 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h1><p>åˆ†ä¸ºå››ä¸ªé˜¶æ®µ</p><ul><li>å®ä¾‹åŒ–</li><li>å±æ€§èµ‹å€¼</li><li>åˆå§‹åŒ–</li><li>é”€æ¯</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">doCreateBean() &#123;</span><br><span class="line">  <span class="comment">// InstantiationAwareBeanPostProcessor.postProcessBeforeInstantiation</span></span><br><span class="line">  createBeanInstance() <span class="comment">// å®ä¾‹åŒ–</span></span><br><span class="line">  <span class="comment">// InstantiationAwareBeanPostProcessor.postProcessAfterInstantiation</span></span><br><span class="line">  populateBean() <span class="comment">// å±æ€§èµ‹å€¼</span></span><br><span class="line">  <span class="comment">// BeanPostProcessor.postProcessBeforeInitialization</span></span><br><span class="line">  initializeBean() <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">  <span class="comment">// BeanPostProcessor.postProcessAfterInitialization</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Aware éƒ½æ˜¯åœ¨åˆå§‹åŒ–é˜¶æ®µä¹‹å‰è°ƒç”¨çš„</p><h1 id="è®¾è®¡æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼" class="headerlink" title="è®¾è®¡æ¨¡å¼"></a>è®¾è®¡æ¨¡å¼</h1><ul><li>å•ä¾‹ï¼šBean é»˜è®¤ä¸ºå•ä¾‹æ¨¡å¼</li><li>å·¥å‚ï¼šBeanFactory å°±æ˜¯ç®€å•å·¥å‚æ¨¡å¼çš„ä½“ç°ï¼Œç”¨æ¥åˆ›å»ºå¯¹è±¡çš„å®ä¾‹</li><li>ä»£ç†ï¼šSpring çš„ AOP åŠŸèƒ½ç”¨åˆ°äº† JDK çš„åŠ¨æ€ä»£ç†å’Œ CGLIB çš„å­—èŠ‚ç ç”ŸæˆæŠ€æœ¯</li><li>æ¨¡æ¿æ–¹æ³•ï¼šç”¨æ¥è§£å†³ä»£ç é‡å¤çš„é—®é¢˜ï¼Œæ¯”å¦‚ RestTemplateï¼ŒJpaTemplate</li><li>è§‚å¯Ÿè€…ï¼šå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½ä¼šå¾—åˆ°é€šçŸ¥è¢«å¼ºåˆ¶æ›´æ–°ï¼Œæ¯”å¦‚ ApplicationListener</li></ul><h1 id="äº‹åŠ¡ä¼ æ’­è¡Œä¸º"><a href="#äº‹åŠ¡ä¼ æ’­è¡Œä¸º" class="headerlink" title="äº‹åŠ¡ä¼ æ’­è¡Œä¸º"></a>äº‹åŠ¡ä¼ æ’­è¡Œä¸º</h1><p>æŒ‡çš„æ˜¯å½“å¤šä¸ªäº‹åŠ¡åŒæ—¶å­˜åœ¨çš„æ—¶å€™ï¼ŒSpring å¦‚ä½•å¤„ç†è¿™äº›äº‹åŠ¡çš„è¡Œä¸º</p><p>propagationï¼š</p><ul><li>requiredï¼šå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œæœ€å¸¸ç”¨</li><li>requires_newï¼šæ— è®ºå½“å‰å­˜ä¸å­˜åœ¨äº‹åŠ¡ï¼Œéƒ½åˆ›å»ºæ–°äº‹åŠ¡</li><li>supportsï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œå°±ä»¥éäº‹åŠ¡æ‰§è¡Œ</li><li>not_supportedï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·</li><li>neverï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</li><li>nestedï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡ä¸­æ‰§è¡Œï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æŒ‰ required å±æ€§æ‰§è¡Œ</li><li>mandatoryï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥ï¼Œä¸å­˜åœ¨åˆ™æŠ›å‡ºå¼‚å¸¸</li></ul><h1 id="éš”ç¦»çº§åˆ«"><a href="#éš”ç¦»çº§åˆ«" class="headerlink" title="éš”ç¦»çº§åˆ«"></a>éš”ç¦»çº§åˆ«</h1><ul><li>isolation_default</li><li>isolation_read_uncommitted</li><li>isolation_read_committed</li><li>isolation_repeatable_read</li><li>isolation_serializable</li></ul><h1 id="Bean-çš„ä½œç”¨åŸŸ"><a href="#Bean-çš„ä½œç”¨åŸŸ" class="headerlink" title="Bean çš„ä½œç”¨åŸŸ"></a>Bean çš„ä½œç”¨åŸŸ</h1><ul><li>singletonï¼šbean åœ¨æ¯ä¸ª Spring IoC å®¹å™¨ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹</li><li>prototypeï¼šä¸€ä¸ª bean çš„å®šä¹‰å¯ä»¥æœ‰å¤šä¸ªå®ä¾‹</li><li>requestï¼šæ¯æ¬¡ http è¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ª beanï¼Œè¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆ</li><li>sessionï¼šåœ¨ä¸€ä¸ª http session ä¸­ï¼Œä¸€ä¸ª bean å®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ï¼Œè¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆ</li><li>global-sessionï¼šåœ¨ä¸€ä¸ªå…¨å±€çš„ http session ä¸­ï¼Œä¸€ä¸ª bean å®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ï¼Œè¯¥ä½œç”¨åŸŸä»…åœ¨åŸº web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆ</li></ul><p>é»˜è®¤æ˜¯ singletonï¼Œä½¿ç”¨ prototype ä½œç”¨åŸŸéœ€è¦æ…é‡çš„è€ƒè™‘ï¼Œå› ä¸ºé¢‘ç¹åˆ›å»ºå’Œé”€æ¯ bean ä¼šå¸¦æ¥å¾ˆå¤§çš„æ€§èƒ½å¼€é”€</p><h1 id="å•ä¾‹-bean-æ˜¯çº¿ç¨‹å®‰å…¨çš„å—"><a href="#å•ä¾‹-bean-æ˜¯çº¿ç¨‹å®‰å…¨çš„å—" class="headerlink" title="å•ä¾‹ bean æ˜¯çº¿ç¨‹å®‰å…¨çš„å—"></a>å•ä¾‹ bean æ˜¯çº¿ç¨‹å®‰å…¨çš„å—</h1><p>ä¸æ˜¯ï¼ŒSpring æ¡†æ¶ä¸­çš„å•ä¾‹ bean ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„</p><p>Spring ä¸­çš„ bean é»˜è®¤æ˜¯å•ä¾‹æ¨¡å¼ï¼ŒSpring æ¡†æ¶å¹¶æ²¡æœ‰å¯¹å•ä¾‹ bean è¿›è¡Œå¤šçº¿ç¨‹çš„å°è£…å¤„ç†</p><p>å®é™…ä¸Šå¤§éƒ¨åˆ†æ—¶å€™ Spring bean æ˜¯æ— çŠ¶æ€çš„ï¼ˆæ¯”å¦‚ daoï¼‰ï¼Œæ‰€ä»¥æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ bean ä¹Ÿæ˜¯å®‰å…¨çš„ï¼Œä½†å¦‚æœ bean æœ‰çŠ¶æ€çš„è¯ï¼ˆæ¯”å¦‚ view mode å¯¹è±¡ï¼‰ï¼Œé‚£å°±è¦å¼€å‘è€…è‡ªå·±å»ä¿è¯çº¿ç¨‹å®‰å…¨äº†ï¼Œæœ€ç®€å•çš„å°±æ˜¯æ”¹å˜ bean çš„ä½œç”¨åŸŸï¼ŒæŠŠ singleton æ”¹æˆ prototype è¿™æ ·è¯·æ±‚ bean ç›¸å½“äº new beanï¼Œå°±å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨</p><ul><li>æœ‰çŠ¶æ€å°±æ˜¯æœ‰æ•°æ®å­˜å‚¨åŠŸèƒ½</li><li>æ— çŠ¶æ€å°±æ˜¯ä¸ä¼šä¿å­˜æ•°æ®</li></ul><p>é‚£ Spring å¦‚ä½•å¤„ç†çº¿ç¨‹å¹¶å‘é—®é¢˜çš„ï¼Ÿ</p><p>åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåªæœ‰æ— çŠ¶æ€çš„ bean æ‰å¯ä»¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å…±äº«ï¼Œåœ¨ Spring ä¸­ï¼Œç»å¤§éƒ¨åˆ† bean éƒ½å¯ä»¥å£°æ˜ä¸º singleton ä½œç”¨åŸŸï¼Œå› ä¸º Spring å¯¹ä¸€äº› bean ä¸­éçº¿ç¨‹å®‰å…¨çŠ¶æ€é‡‡ç”¨ ThreadLocal è¿›è¡Œå¤„ç†ï¼Œè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜</p><p>ThreadLocal å’Œçº¿ç¨‹åŒæ­¥æœºåˆ¶éƒ½æ˜¯ä¸ºäº†è§£å†³å¤šçº¿ç¨‹ä¸­ç›¸åŒå˜é‡çš„è®¿é—®å†²çªé—®é¢˜ï¼ŒåŒæ­¥æœºåˆ¶é‡‡ç”¨äº†æ—¶é—´æ¢ç©ºé—´çš„æ–¹æ³•ï¼Œä»…æä¾›ä¸€ä»½å˜é‡ï¼Œä¸åŒçš„çº¿ç¨‹åœ¨è®¿é—®å‰éœ€è¦å…ˆè·å¾—é”ï¼Œæ²¡è·å¾—é”çš„çº¿ç¨‹åˆ™éœ€è¦æ’é˜Ÿ</p><p>è€Œ ThreadLocal é‡‡ç”¨äº†ç©ºé—´æ¢æ—¶é—´çš„æ–¹å¼ï¼ŒThreadLocal ä¼šä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹æä¾›ä¸€ä¸ªç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ï¼Œä»è€Œéš”ç¦»äº†å¤šä¸ªçº¿ç¨‹å¯¹æ•°æ®çš„è®¿é—®å†²çªï¼Œå› ä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰è‡ªå·±çš„å˜é‡å‰¯æœ¬ï¼Œä»è€Œä¹Ÿå°±æ²¡æœ‰å¿…è¦å¯¹è¯¥å˜é‡è¿›è¡ŒåŒæ­¥äº†ï¼ŒThreadLocal æä¾›äº†çº¿ç¨‹å®‰å…¨çš„å…±äº«å¯¹è±¡ï¼Œåœ¨ç¼–å†™å¤šçº¿ç¨‹ä»£ç æ—¶ï¼Œå¯ä»¥æŠŠä¸å®‰å…¨çš„å˜é‡å°è£…è¿› ThreadLocal</p><h1 id="å¸¸ç”¨æ³¨è§£"><a href="#å¸¸ç”¨æ³¨è§£" class="headerlink" title="å¸¸ç”¨æ³¨è§£"></a>å¸¸ç”¨æ³¨è§£</h1><ul><li>@Componentï¼šå°† Java ç±»æ ‡è®°ä¸º beanï¼Œæ˜¯ä»»ä½• Spring ç®¡ç†ç»„ä»¶çš„é€šç”¨å‹ï¼ŒSpring çš„ç»„ä»¶æ‰«ææœºåˆ¶æ‰«æå¹¶ç”¨ IoC å®¹å™¨è¿›è¡Œç®¡ç†</li><li>@Controllerï¼šå°†ç±»æ ‡è®°ä¸º Spring Web MVC æ§åˆ¶å™¨ï¼Œä¼šè‡ªåŠ¨å¯¼å…¥åˆ° IoC å®¹å™¨ä¸­</li><li>@Serviceï¼šåŸºæœ¬å’Œ @Component ä¸€æ ·ï¼Œåªæ˜¯ç”¨åœ¨ service å±‚çš„è¯ï¼Œä¼šæ›´å¥½åœ°è§åçŸ¥æ„</li><li>@Repositoryï¼šé™¤äº†å…·æœ‰ @Component çš„ä½œç”¨å¤–ï¼Œè¿˜å…·æœ‰é¢å¤–çš„ä½œç”¨ï¼Œå¯ä»¥å°†æœªç»æ£€æŸ¥çš„å¼‚å¸¸è½¬æ¢ä¸º Spring DataAccessException</li></ul><h1 id="Autowired-å’Œ-Resource-çš„åŒºåˆ«"><a href="#Autowired-å’Œ-Resource-çš„åŒºåˆ«" class="headerlink" title="@Autowired å’Œ @Resource çš„åŒºåˆ«"></a>@Autowired å’Œ @Resource çš„åŒºåˆ«</h1><ul><li>å®˜æ–¹æ ‡å‡†<ul><li>@Resourceï¼šJSR250ï¼ŒæŒ‰åç§°æˆ–ç±»å‹æ³¨å…¥ï¼Œä¸æ”¯æŒ @Primary</li><li>@Injectï¼šJSR330ï¼Œé»˜è®¤æŒ‰ç±»å‹æ³¨å…¥ï¼Œé…åˆ @Qualifier å¯å®ç°æŒ‰åç§°æ³¨å…¥ï¼Œé…åˆ@Primary å¯é€‰æ‹©ä¼˜å…ˆæ³¨å…¥</li><li>@Autowiredï¼šSpring è‡ªå·±çš„å®ç°ï¼Œé»˜è®¤æŒ‰ç±»å‹æ³¨å…¥ï¼Œé…åˆ @Qualifier å¯å®ç°æŒ‰åç§°æ³¨å…¥ï¼Œé…åˆ @Primary å¯é€‰æ‹©ä¼˜å…ˆæ³¨å…¥</li></ul></li></ul><h1 id="äº‹åŠ¡éš”ç¦»çº§åˆ«"><a href="#äº‹åŠ¡éš”ç¦»çº§åˆ«" class="headerlink" title="äº‹åŠ¡éš”ç¦»çº§åˆ«"></a>äº‹åŠ¡éš”ç¦»çº§åˆ«</h1><p>é™¤äº† MySQL å››ç§äº‹åŠ¡éš”ç¦»çº§åˆ«å¤–ï¼Œå¤šäº†ä¸ªé»˜è®¤ï¼Œå°±æ˜¯æ•°æ®åº“æ˜¯ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆ</p><ul><li>isolation_default</li><li>isolation_read_uncommitted</li><li>isolation_read_committed</li><li>isolation_repeatable_read</li><li>isolation_serializable</li></ul><h1 id="IoC-å®¹å™¨"><a href="#IoC-å®¹å™¨" class="headerlink" title="IoC å®¹å™¨"></a>IoC å®¹å™¨</h1><p>IoC å°±æ˜¯æ§åˆ¶åè½¬ï¼Œå®ƒæŠŠä¼ ç»Ÿçš„æœ‰ç¨‹åºä»£ç ç›´æ¥ new çš„å¯¹è±¡çš„è°ƒç”¨æƒäº¤ç»™ Spring å®¹å™¨ï¼Œé€šè¿‡å®¹å™¨æ¥å®ç°å¯¹è±¡ç»„ä»¶çš„è£…é…å’Œç®¡ç†ï¼Œæ‰€è°“çš„æ§åˆ¶åè½¬å°±æ˜¯å¯¹ç»„ä»¶å¯¹è±¡æ§åˆ¶æƒçš„è½¬ç§»ï¼Œä»ç¨‹åºä»£ç æœ¬èº«è½¬ç§»åˆ°äº†å¤–éƒ¨å®¹å™¨</p><p>Spring IoC è´Ÿè´£åˆ›å»ºå¯¹è±¡ï¼Œç®¡ç†å¯¹è±¡ï¼Œè£…é…å¯¹è±¡ï¼Œé…ç½®å¯¹è±¡ï¼Œå¹¶ä¸”ç®¡ç†è¿™äº›å¯¹è±¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸ</p><p>IoC æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</p><ul><li>ç®¡ç†å¯¹è±¡çš„åˆ›å»ºå’Œä¾èµ–å…³ç³»çš„ç»´æŠ¤ï¼Œå¯¹è±¡çš„åˆ›å»ºå¹¶ä¸æ˜¯ä¸€ä»¶ç®€å•çš„äº‹ï¼Œåœ¨å¯¹è±¡ç®¡ç†æ¯”è¾ƒå¤æ‚æ—¶ï¼Œå¦‚æœä¾èµ–å…³ç³»éœ€è¦ç¨‹åºä»£ç æ¥ç»´æŠ¤ï¼Œæ¯”è¾ƒç—›è‹¦</li><li>è§£è€¦ï¼Œç”±å®¹å™¨å»ç»´æŠ¤å…·ä½“çš„å¯¹è±¡</li><li>æ‰˜ç®¡äº†ç±»çš„äº§ç”Ÿè¿‡ç¨‹ï¼Œæ¯”å¦‚æˆ‘ä»¬éœ€è¦åœ¨ç±»çš„äº§ç”Ÿè¿‡ç¨‹ä¸­åšä¸€äº›å¤„ç†ï¼Œæœ€ç›´æ¥çš„ä¾‹å­å°±æ˜¯ä»£ç†ï¼Œå¦‚æœæœ‰å®¹å™¨ç¨‹åºå¯ä»¥æŠŠè¿™éƒ¨åˆ†å¤„ç†äº¤ç»™å®¹å™¨ï¼Œåº”ç”¨ç¨‹åºåˆ™æ— éœ€å»å…³å¿ƒç±»æ˜¯å¦‚ä½•å®Œæˆä»£ç†çš„</li></ul><h1 id="å¾ªç¯ä¾èµ–"><a href="#å¾ªç¯ä¾èµ–" class="headerlink" title="å¾ªç¯ä¾èµ–"></a>å¾ªç¯ä¾èµ–</h1><p>A æœ‰ Bï¼ŒB æœ‰ A<br>Bean çš„åˆ›å»ºè¿‡ç¨‹ï¼š</p><ul><li>è·å– bean å®šä¹‰</li><li>é€šè¿‡åå°„åˆ›å»ºåŸå§‹å¯¹è±¡</li><li>å¡«å……å±æ€§ï¼ˆè¿™ä¸€æ­¥å°±æ˜¯ä¾èµ–æ³¨å…¥ï¼‰</li><li>å®Œæˆå¯¹è±¡çš„åˆ›å»ºæ”¾åˆ°ä¸€çº§ç¼“å­˜</li></ul><p>A åˆ›å»ºçš„æ—¶å€™ï¼Œé€šè¿‡ bean çš„å®šä¹‰åˆ›å»ºäº†ä¸€ä¸ªåŸå§‹å¯¹è±¡ï¼Œç„¶åå°† lambda è¡¨è¾¾å¼æ”¾åˆ°ä¸‰çº§ç¼“å­˜ä¸­ï¼Œæ¥ç€è¿›è¡Œå±æ€§çš„å¡«å……ï¼Œå¡«å……çš„æ—¶å€™å‘ç° B è¿˜æ²¡æœ‰ï¼Œäºæ˜¯æŒ‰ç…§åŒæ ·çš„æ–¹å¼æ¥åˆ›å»º Bï¼Œç­‰åˆ° B è¿›è¡Œå±æ€§æ³¨å…¥çš„æ—¶å€™ï¼Œåˆ†åˆ«ä»ä¸€çº§ï¼ŒäºŒçº§ï¼Œä¸‰çº§ç¼“å­˜é‡Œé¢æ‰¾ Aï¼Œæœ€ååœ¨ä¸‰çº§ç¼“å­˜é‡Œé¢æ‰¾åˆ°ï¼Œäºæ˜¯å°† A æ”¾åˆ°äºŒçº§ç¼“å­˜ä¸­ï¼Œå¹¶ä»ä¸‰çº§ç¼“å­˜ä¸­åˆ é™¤ Aï¼Œæ­¤æ—¶çš„ A æ˜¯ä¸€ä¸ªå¯¹è±¡å¹¶æœªå®Œæˆåˆå§‹åŒ–å¥½çš„å¯¹è±¡ï¼Œä½†æ˜¯å·²ç»åˆ›å»ºå‡ºæ¥äº†ï¼Œé‚£ä¹ˆ B å±æ€§æ³¨å…¥æˆåŠŸï¼Œå°±æ”¾åˆ°ä¸€çº§ç¼“å­˜ä¸­ï¼Œæ¥ç€å›åˆ° A çš„å±æ€§æ³¨å…¥ï¼Œæ³¨å…¥å®Œæˆ B åï¼ŒA ä¹Ÿå®Œæˆäº†åˆ›å»ºï¼Œå°±æ”¾åˆ°ä¸€çº§ç¼“å­˜ä¸­ï¼Œå¹¶ä»äºŒçº§ç¼“å­˜ä¸­åˆ æ‰ A</p><p>ä¸ºä»€ä¹ˆéœ€è¦ä¸‰çº§ç¼“å­˜æ¥è§£å†³å¾ªç¯ä¾èµ–ï¼Ÿ</p><p>å¦‚æœæ˜¯æ™®é€šçš„å¯¹è±¡ï¼Œç”¨ä¸€çº§ç¼“å­˜å°±å¯ä»¥ï¼Œä½†æ˜¯ Spring çš„å¯¹è±¡å¾ˆå¤šéƒ½æ˜¯åŠ¨æ€ä»£ç†å¢å¼ºçš„ï¼Œä¸‰çº§ç¼“å­˜é‡Œå­˜çš„æ˜¯ä¸€ä¸ª lambda è¡¨è¾¾å¼ï¼Œæ ¹æ®å¯¹è±¡æ˜¯å¦æœ‰åŠ¨æ€ä»£ç†çš„éœ€æ±‚ï¼Œè¿›è¡ŒåŒ…è£…è¿”å›ï¼Œè¿™æ—¶çš„å¯¹è±¡æ˜¯æœªå®Œæˆåˆå§‹åŒ–çš„ï¼Œå¦‚æœä¸æ”¾åˆ°äºŒçº§ç¼“å­˜ç›´æ¥æ”¾åˆ°ä¸€çº§ç¼“å­˜ï¼Œä¸€çº§ç¼“å­˜é‡Œä¼šå‡ºç°æ—¢æœ‰åˆå§‹åŒ–å®Œæˆçš„ beanï¼Œåˆæœ‰æœªåˆå§‹åŒ–å®Œæˆçš„ï¼Œç®¡ç†èµ·æ¥å°±å¯èƒ½ä¼šå‡ºç°ä¸å¯é¢„çŸ¥çš„é”™è¯¯ï¼Œä¹Ÿä¸ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚åœ¨ç¼“å­˜ bean çš„è¿‡ç¨‹ä¸­ï¼Œä¸‰ä¸ªçº§åˆ«çš„ç¼“å­˜éƒ½æ˜¯äº’æ–¥çš„ï¼Œæœ€ç»ˆéƒ½ä¼šåªä¿ç•™ä¸€ä»½å®Œæˆåˆå§‹åŒ–çš„ beanï¼Œæ”¾åˆ°ä¸€çº§ç¼“å­˜é‡Œ</p><h1 id="SpringMVC-å·¥ä½œæµç¨‹"><a href="#SpringMVC-å·¥ä½œæµç¨‹" class="headerlink" title="SpringMVC å·¥ä½œæµç¨‹"></a>SpringMVC å·¥ä½œæµç¨‹</h1><ul><li>ç”¨æˆ·å‘é€è¯·æ±‚åˆ°å‰ç«¯æ§åˆ¶å™¨ DispatcherServlet</li><li>DispatcherServlet æ”¶åˆ°è¯·æ±‚åï¼Œè°ƒç”¨ HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨è¯·æ±‚è·å– Handler</li><li>HandlerMapping æ ¹æ®è¯·æ±‚ url æ‰¾åˆ°å…·ä½“çš„å¤„ç†å™¨ï¼Œç”Ÿæˆå¤„ç†å™¨å¯¹è±¡åŠå¤„ç†å™¨æ‹¦æˆªå™¨ï¼Œè¿”å›ç»™ DispatcherServlet</li><li>DispatcherServlet è°ƒç”¨ HandlerAdapter å¤„ç†å™¨é€‚é…å™¨</li><li>HandlerAdapter ç»è¿‡é€‚é…è°ƒç”¨å…·ä½“å¤„ç†å™¨ Handlerï¼Œä¹Ÿå«åç«¯æ§åˆ¶å™¨</li><li>Handler æ‰§è¡Œå®Œæˆï¼Œè¿”å› ModelAndView</li><li>HandlerAdapter å°† Handler æ‰§è¡Œç»“æ„ ModelAndView è¿”å›ç»™ DispatcherServlet</li><li>DispatcherServlet å°† ModelAndView ä¼ ç»™ ViewResolver è§†å›¾è§£æå™¨è¿›è¡Œè§£æ</li><li>ViewResolver è§£æåè¿”å›å…·ä½“ View</li><li>DispatcherServlet å¯¹ View è¿›è¡Œæ¸²æŸ“è§†å›¾ï¼Œå³å°†æ¨¡å‹æ•°æ®å¡«å……è‡³è§†å›¾ä¸­</li><li>DispatcherServlet å“åº”ç”¨æˆ·</li></ul><h1 id="è§£å†³è·¨åŸŸ"><a href="#è§£å†³è·¨åŸŸ" class="headerlink" title="è§£å†³è·¨åŸŸ"></a>è§£å†³è·¨åŸŸ</h1><p>è·¨åŸŸå¯ä»¥åœ¨å‰ç«¯é€šè¿‡ JSONP æ¥è§£å†³ï¼Œä½†æ˜¯ JSNOP åªå¯ä»¥å‘é€ GET è¯·æ±‚ï¼Œåœ¨ RESTful é£æ ¼çš„åº”ç”¨ä¸­ï¼Œå°±æ˜¾å¾—éå¸¸é¸¡è‚‹ï¼Œå› æ­¤æ¨èåœ¨åç«¯é€šè¿‡ CORS Cross-Origin Resource Sharing æ¥è§£å†³è·¨åŸŸé—®é¢˜ï¼ŒSpring Boot ä¸­å¯ä»¥é€šè¿‡å®ç° WebMvcConfigurer æ¥å£ï¼Œç„¶åé‡å†™ addCordMappings æ–¹æ³•æ¥è§£å†³è·¨åŸŸé—®é¢˜</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç»„æˆ&quot;&gt;&lt;a href=&quot;#ç»„æˆ&quot; class=&quot;headerlink&quot; title=&quot;ç»„æˆ&quot;&gt;&lt;/a&gt;ç»„æˆ&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;aop&lt;/li&gt;
&lt;li&gt;beans&lt;/li&gt;
&lt;li&gt;context&lt;/li&gt;
&lt;li&gt;core&lt;/li&gt;
&lt;li&gt;jdbc&lt;</summary>
      
    
    
    
    <category term="ç¨‹åºè®¾è®¡" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    
    
    <category term="Spring Boot" scheme="https://linweiyuan.github.io/tags/Spring-Boot/"/>
    
    <category term="Spring" scheme="https://linweiyuan.github.io/tags/Spring/"/>
    
  </entry>
  
  <entry>
    <title>MySQLäº‹åŠ¡</title>
    <link href="https://linweiyuan.github.io/2021/06/28/MySQL%E4%BA%8B%E5%8A%A1.html"/>
    <id>https://linweiyuan.github.io/2021/06/28/MySQL%E4%BA%8B%E5%8A%A1.html</id>
    <published>2021-06-28T15:08:02.000Z</published>
    <updated>2022-10-04T11:01:19.597Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ACID"><a href="#ACID" class="headerlink" title="ACID"></a>ACID</h1><p>äº‹åŠ¡ï¼Œé¦–å…ˆè¦äº†è§£ ACID</p><h2 id="A-åŸå­æ€§"><a href="#A-åŸå­æ€§" class="headerlink" title="A åŸå­æ€§"></a>A åŸå­æ€§</h2><p>åŸå­æ€§ä½“ç°åœ¨å›æ»šä¸Šé¢ï¼Œå¦‚æœ SQL æ‰§è¡Œå‡ºé”™ï¼Œè¦æŠŠä¹‹å‰çš„çŠ¶æ€æ¢å¤ï¼Œé‚£æ€ä¹ˆçŸ¥é“æ¢å¤ä»€ä¹ˆå‘¢ï¼ŒæŠŠä¹‹å‰çš„çŠ¶æ€ä¿å­˜åœ¨ undo log é‡Œï¼Œå‡ºé”™åˆ™ä¼šæ‰§è¡Œç›¸åçš„æ“ä½œ</p><h2 id="C-ä¸€è‡´æ€§"><a href="#C-ä¸€è‡´æ€§" class="headerlink" title="C ä¸€è‡´æ€§"></a>C ä¸€è‡´æ€§</h2><p>äº‹åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§çº¦æŸå¹¶æ²¡æœ‰è¢«ç ´åï¼Œä¸»è¦æ˜¯é€šè¿‡åŸå­æ€§ + éš”ç¦»æ€§ + æŒä¹…æ€§æ¥ä¿è¯</p><h2 id="I-éš”ç¦»æ€§"><a href="#I-éš”ç¦»æ€§" class="headerlink" title="I éš”ç¦»æ€§"></a>I éš”ç¦»æ€§</h2><p>å†™å†™æ“ä½œæ˜¯é€šè¿‡é”è§£å†³ï¼Œå†™è¯»æ“ä½œæ˜¯åŸºäº MVCC</p><h2 id="D-æŒä¹…æ€§"><a href="#D-æŒä¹…æ€§" class="headerlink" title="D æŒä¹…æ€§"></a>D æŒä¹…æ€§</h2><p>æŒ‡çš„æ˜¯äº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œå¯¹æ•°æ®åº“çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„</p><hr><p>MySQL ä¸ºäº†æé«˜æ•ˆç‡ï¼Œä¼šæœ‰ä¸€ä¸ª bufferï¼Œæ¯æ¬¡å†™åˆ° buffer ä¸­ï¼Œå†å®šæœŸå°† buffer ä¸­çš„æ•°æ®åˆ·æ–°åˆ°ç¡¬ç›˜ä¸Šï¼Œè¿™å°±ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœ buffer è¿˜æ²¡æ¥å¾—åŠåˆ·ç›˜ï¼ŒMySQL å®•æœºäº†ï¼Œæ•°æ®å°±ä¼šä¸¢å¤±ï¼Œå› æ­¤ï¼Œå¼•å…¥äº† redo logï¼Œå½“æ•°æ®åº“çš„æ•°æ®è¿›è¡Œå¢åˆ æ”¹çš„æ—¶å€™ï¼Œå…ˆå°† æœ¬æ¬¡æ“ä½œè®°å½•åˆ° redo log ä¸­ï¼Œå†å†™ bufferï¼Œè¿™æ ·å¦‚æœå®•æœºäº†ï¼Œè¿˜æœ‰ redo log æ¥æ¢å¤æ•°æ®ï¼Œè¿™æ ·å°±ä¿è¯äº†æŒä¹…æ€§</p><p>ä¸ºä»€ä¹ˆ redo log å†™æ•°æ®è¦æ¯” buffer å†™æ•°æ®åº“å¿«ï¼Ÿ</p><p>å› ä¸º buffer å†™ç›˜æ˜¯éšæœº IOï¼Œredo log æ˜¯è¿½åŠ çš„æ¨¡å¼ï¼Œæ˜¯é¡ºåº IOï¼Œæ•ˆç‡å°±é«˜ï¼Œå¹¶ä¸” buffer æŒä¹…åŒ–æ•°æ®æ˜¯ä»¥æ•°æ®é¡µ page ä¸ºå•ä½çš„ï¼Œé»˜è®¤æ˜¯ 16Kï¼Œå°±æ˜¯è¯´ä¸€ä¸ªæ•°æ®é¡µä¸Šçš„å°å°ä¿®æ”¹éƒ½è¦æŠŠæ•´ä¸ªæ•°æ®é¡µå†™å…¥ï¼Œredo log åªéœ€è¦å†™å…¥çœŸæ­£éœ€è¦çš„éƒ¨åˆ†ï¼Œæ— æ•ˆçš„ IO å°±å¤§å¤§å‡å°‘äº†ï¼Œæ•ˆç‡å°±æé«˜äº†</p><p>è¯»æœªæäº¤ï¼šè„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œå¹»è¯»éƒ½æœ‰å¯èƒ½å‡ºç°</p><p>è¯»å·²æäº¤ï¼šé¿å…è„è¯»ï¼Œå¯èƒ½å‡ºç°ä¸å¯é‡å¤è¯»å’Œå¹»è¯»</p><p>é‡å¤è¯»ï¼šé¿å…è„è¯»å’Œä¸å¯é‡å¤è¯»ï¼Œå¯èƒ½å‡ºç°å¹»è¯»</p><p>ä¸²è¡ŒåŒ–ï¼šå…¨éƒ¨é¿å…ï¼Œæ€§èƒ½å·®</p><p>è„è¯»: ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹äº†æ•°æ®è¿˜æ²¡æäº¤ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°äº†æ—§æ•°æ®</p><p>ä¸å¯é‡å¤è¯»: ä¸€ä¸ªäº‹åŠ¡å¤šæ¬¡è¯»åŒä¸€æ•°æ®ï¼Œé—´éš”é—´ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡æŠŠæ•°æ®æ”¹äº†ï¼Œå¯¼è‡´ä¸¤æ¬¡è¯»å–ç»“æœä¸ä¸€æ ·</p><p>å¹»è¯»: ä¸€ä¸ªäº‹åŠ¡å¯¹å…¨è¡¨æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡å¾€è¡¨ä¸­æ–°å¢æ•°æ®ï¼Œä¿®æ”¹å®Œæˆåè«åå…¶å¦™å‡ºç°äº†æ²¡æœ‰ä¿®æ”¹åˆ°çš„æ•°æ®</p><p>MySQL çš„ InnoDB é»˜è®¤æ˜¯ RRï¼Œä¸ºä»€ä¹ˆå¯ä»¥è§£å†³å¹»è¯»ï¼Ÿ</p><p>å› ä¸ºé»˜è®¤å¼€å¯äº†é—´éš™é”ï¼Œè¿™æ ·å°±é˜²æ­¢äº†ä¸¤æ¬¡ select ä¹‹é—´ï¼Œæœ‰å¦å¤–çš„äº‹åŠ¡è¿›è¡Œå¢åˆ æ“ä½œ</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ACID&quot;&gt;&lt;a href=&quot;#ACID&quot; class=&quot;headerlink&quot; title=&quot;ACID&quot;&gt;&lt;/a&gt;ACID&lt;/h1&gt;&lt;p&gt;äº‹åŠ¡ï¼Œé¦–å…ˆè¦äº†è§£ ACID&lt;/p&gt;
&lt;h2 id=&quot;A-åŸå­æ€§&quot;&gt;&lt;a href=&quot;#A-åŸå­æ€§&quot; class=&quot;heade</summary>
      
    
    
    
    <category term="æ•°æ®åº“" scheme="https://linweiyuan.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="MySQL" scheme="https://linweiyuan.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQLé”</title>
    <link href="https://linweiyuan.github.io/2021/06/25/MySQL%E9%94%81.html"/>
    <id>https://linweiyuan.github.io/2021/06/25/MySQL%E9%94%81.html</id>
    <published>2021-06-25T15:03:53.000Z</published>
    <updated>2022-10-04T11:01:19.597Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è¡Œé”"><a href="#è¡Œé”" class="headerlink" title="è¡Œé”"></a>è¡Œé”</h1><p>update çš„æ—¶å€™è¡Œçº§é”ï¼Œå¦‚æœæœª commitï¼Œå¦ä¸€ä¸ªäº‹åŠ¡ä¼šå°è¯•æ‹¿é”ï¼Œè¶…æ—¶åˆ™æŠ¥é”™</p><h1 id="è¡¨é”"><a href="#è¡¨é”" class="headerlink" title="è¡¨é”"></a>è¡¨é”</h1><p>ç´¢å¼•å¤±æ•ˆï¼Œè¡Œé”ä¼šå‡çº§ä¸ºè¡¨é”ï¼Œæ¯”å¦‚ update çš„æ—¶å€™æœ‰ orï¼Œè¿™æ ·å°±ç®—åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ update id &#x3D; 1 or id &#x3D; 2ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡è¦ update id &#x3D; 3ï¼Œä¹Ÿä¼šé˜»å¡ï¼Œä¸€æ—¦å‘ç”Ÿè¡¨é”ï¼Œå¹¶å‘åº¦æ˜¯æ¯”è¾ƒä½çš„ï¼Œæ‰€ä»¥è¦é¿å…ç´¢å¼•å¤±æ•ˆ</p><h1 id="é—´éš™é”"><a href="#é—´éš™é”" class="headerlink" title="é—´éš™é”"></a>é—´éš™é”</h1><p>ä¸€èˆ¬å‘ç”Ÿåœ¨èŒƒå›´æŸ¥è¯¢é‡Œé¢ï¼ŒæŠŠæ•´ä¸ªèŒƒå›´åŠ é”ï¼Œå¦‚æœè¦åœ¨è¿™ä¸ªèŒƒå›´å†…æ’å…¥æ–°æ•°æ®ï¼Œä¹Ÿä¼šé˜»å¡ï¼Œæ€§èƒ½å½±å“ä¹Ÿæ˜¯æ¯”è¾ƒå¤§çš„</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> status <span class="keyword">like</span> <span class="string">&#x27;innodb_row_lock%&#x27;</span>;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä¸€äº›é”ç›¸å…³æ•°æ®</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è¡Œé”&quot;&gt;&lt;a href=&quot;#è¡Œé”&quot; class=&quot;headerlink&quot; title=&quot;è¡Œé”&quot;&gt;&lt;/a&gt;è¡Œé”&lt;/h1&gt;&lt;p&gt;update çš„æ—¶å€™è¡Œçº§é”ï¼Œå¦‚æœæœª commitï¼Œå¦ä¸€ä¸ªäº‹åŠ¡ä¼šå°è¯•æ‹¿é”ï¼Œè¶…æ—¶åˆ™æŠ¥é”™&lt;/p&gt;
&lt;h1 id=&quot;è¡¨é”&quot;&gt;&lt;a href=&quot;#è¡¨é”</summary>
      
    
    
    
    <category term="æ•°æ®åº“" scheme="https://linweiyuan.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="MySQL" scheme="https://linweiyuan.github.io/tags/MySQL/"/>
    
  </entry>
  
</feed>
